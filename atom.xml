<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>暗之洋光</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://liuyang0681.github.io/"/>
  <updated>2019-11-15T10:12:07.426Z</updated>
  <id>http://liuyang0681.github.io/</id>
  
  <author>
    <name>浏阳（Yang)</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>快速绘制发表级图片ggplot2智能版ggpubr包学习总结</title>
    <link href="http://liuyang0681.github.io/2019/11/15/%E5%BF%AB%E9%80%9F%E7%BB%98%E5%88%B6%E5%8F%91%E8%A1%A8%E7%BA%A7%E5%9B%BE%E7%89%87ggplot2%E6%99%BA%E8%83%BD%E7%89%88ggpubr%E5%8C%85%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
    <id>http://liuyang0681.github.io/2019/11/15/快速绘制发表级图片ggplot2智能版ggpubr包学习总结/</id>
    <published>2019-11-15T10:10:58.000Z</published>
    <updated>2019-11-15T10:12:07.426Z</updated>
    
    <content type="html"><![CDATA[<h4 id="软件简介"><a href="#软件简介" class="headerlink" title="软件简介"></a>软件简介</h4><p>Hadley Wickham编写的<a href="https://ggplot2.tidyverse.org/" target="_blank" rel="noopener">ggplot2</a>是出色且灵活的作图软件包，可用于R中的优雅数据可视化。ggplot2默认生成的绘图需要进行一些格式化，才能作出发表级别的图片质量。另外，要自定义使用ggplot，但其语法是不透明的，这对没有熟练R编程技能的用户增加了难度。“ ggpubr”软件包提供了一些易于使用的功能，用于创建和自定义基于“ ggplot2”的图片绘制。<br>ggpubr包的主要特点：</p><ul><li>ggplot2软件包周围的包装，对于R编程的初学者来说，语法不太透明。</li><li>使用非高级R编程技能帮助研究人员轻松创建可随时发布的图。</li><li>可以将p值和显着性水平自动添加到箱形图，条形图，折线图等中。</li><li>使在同一页面上排列和注释多个图变得容易。</li><li>使更改颜色和标签等图形参数变得容易。<h4 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h4>软件安装很方便，安装完成直接加载调用<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"ggpubr"</span>)</span><br><span class="line">#或者</span><br><span class="line"><span class="function"><span class="title">if</span><span class="params">(!require(devtools)</span></span>) install.packages(<span class="string">"devtools"</span>)</span><br><span class="line">devtools::install_github(<span class="string">"kassambara/ggpubr"</span>)</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggpubr)</span></span></span><br></pre></td></tr></table></figure></li></ul><h5 id="密度分布图"><a href="#密度分布图" class="headerlink" title="密度分布图"></a>密度分布图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set.seed(1234)</span><br><span class="line">df &lt;- data.frame(sex=factor(rep(c(&quot;F&quot;,&quot;M&quot;),each=200)),weight=c(rnorm(200,55),rnorm(200,58)))</span><br><span class="line">ggdensity(df,x=&quot;weight&quot;,add = &quot;mean&quot;,rug = TRUE,color = &quot;sex&quot;,fill = &quot;sex&quot;,palette= c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c78f2d46f879bc68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggdensity"></p><h5 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h5><figure class="highlight plain"><figcaption><span>&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gghistogram(df,x=&quot;weight&quot;,add = &quot;mean&quot;,rug = TRUE,color = &quot;sex&quot;,fill = &quot;sex&quot;,palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-58ff61b258949d2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="histogram"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># Create some data format</span><br><span class="line">set.seed(1234)</span><br><span class="line">wdata = data.frame(sex = factor(rep(c(&quot;F&quot;, &quot;M&quot;), each=200)),weight = c(rnorm(200, 55), rnorm(200, 58)))</span><br><span class="line">p1 &lt;- ggqqplot(wdata, x = &quot;weight&quot;)</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-782ed1112077e165.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggqqplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Change colors and shape by groups (&quot;sex&quot;)</span><br><span class="line"># Use custom palette</span><br><span class="line">p2 &lt;- ggqqplot(wdata, x = &quot;weight&quot;,</span><br><span class="line">         color = &quot;sex&quot;, palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-2af92e7bbc207dfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggqqplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Create some data format</span><br><span class="line">set.seed(1234)</span><br><span class="line">wdata = data.frame(</span><br><span class="line">  sex = factor(rep(c(&quot;F&quot;, &quot;M&quot;), each=200)),</span><br><span class="line">  weight = c(rnorm(200, 55), rnorm(200, 58)))</span><br><span class="line"></span><br><span class="line">p1 &lt;- ggecdf(wdata, x = &quot;weight&quot;)</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6c3360c92b559ff6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggecdf"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Change colors and linetype by groups (&quot;sex&quot;)</span><br><span class="line"># Use custom palette</span><br><span class="line">p2 &lt;- ggecdf(wdata, x = &quot;weight&quot;,</span><br><span class="line">       color = &quot;sex&quot;, linetype = &quot;sex&quot;,</span><br><span class="line">       palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-e8656242bfea3daf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggecdf"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p3 &lt;- ggecdf(wdata, x = &quot;weight&quot;, facet.by = &quot;sex&quot;,</span><br><span class="line">             color = &quot;sex&quot;, linetype = &quot;sex&quot;,</span><br><span class="line">             palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span><br><span class="line">p3</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6ef688a4b6781c1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggecdf"></p><h5 id="箱线图小提琴图"><a href="#箱线图小提琴图" class="headerlink" title="箱线图小提琴图"></a>箱线图小提琴图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls())</span><br><span class="line">data(&quot;ToothGrowth&quot;)</span><br><span class="line">df1&lt;- ToothGrowth</span><br><span class="line">head(df1)</span><br><span class="line">p&lt;- ggboxplot(df1,x=&quot;dose&quot;,y=&quot;len&quot;,color = &quot;dose&quot;,palette=c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),add = &quot;jitter&quot;,shape=&quot;dose&quot;)</span><br><span class="line">p</span><br><span class="line">my_comparisons &lt;- list(c(&quot;0.5&quot;, &quot;1&quot;), c(&quot;1&quot;, &quot;2&quot;), c(&quot;0.5&quot;, &quot;2&quot;))</span><br><span class="line">p + stat_compare_means(comparisons = my_comparisons)+ stat_compare_means(label.y = 50)</span><br><span class="line">ggviolin(df1,x=&quot;dose&quot;,y=&quot;len&quot;,fill = &quot;dose&quot;,palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), add=&quot;boxplot&quot;, add.params=list(fill=&quot;white&quot;)) + stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;) + stat_compare_means(label.y = 50)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-95aa9b0c0a04c8ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggboxplot"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-7b7af3558461e43e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggboxplot"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-ea9662d4268da2af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggviolin"></p><h5 id="柱状图-1"><a href="#柱状图-1" class="headerlink" title="柱状图"></a>柱状图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data(&quot;mtcars&quot;)</span><br><span class="line">df2&lt;- mtcars</span><br><span class="line">df2$cyl &lt;- factor(df2$cyl)</span><br><span class="line">df2$name &lt;- rownames(df2)</span><br><span class="line">head(df2[,c(&quot;name&quot;,&quot;wt&quot;,&quot;mpg&quot;)])</span><br><span class="line">ggbarplot(df2,x=&quot;name&quot;,y=&quot;mpg&quot;,fill = &quot;cyl&quot;,color = &quot;white&quot;,palette=&quot;npg&quot;,sort.val = &quot;desc&quot;,sort.by.groups = FALSE,x.text.angle= 60)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-e791970a8d4db20e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data(&quot;mtcars&quot;)</span><br><span class="line">df2&lt;- mtcars</span><br><span class="line">df2$cyl &lt;- factor(df2$cyl)</span><br><span class="line">df2$name &lt;- rownames(df2)</span><br><span class="line">head(df2[,c(&quot;name&quot;,&quot;wt&quot;,&quot;mpg&quot;)])</span><br><span class="line">ggbarplot(df2,x=&quot;name&quot;,y=&quot;mpg&quot;,fill = &quot;cyl&quot;,color = &quot;white&quot;,palette=&quot;aaas&quot;,sort.val = &quot;asc&quot;,sort.by.groups = TRUE,x.text.angle= 60)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1e9d4f4fcb257fc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df2$mpg_z &lt;- (df2$mpg - mean(df2$mpg))/sd(df2$mpg)</span><br><span class="line"></span><br><span class="line">df2$mpg_grp &lt;- factor(ifelse(df2$mpg_z&lt;0,&quot;low&quot;,&quot;high&quot;),levels = c(&quot;low&quot;,&quot;high&quot;))</span><br><span class="line">head(df2[,c(&quot;name&quot;,&quot;wt&quot;,&quot;mpg&quot;,&quot;mpg_grp&quot;,&quot;cyl&quot;)])</span><br><span class="line">ggbarplot(df2,x=&quot;name&quot;,y=&quot;mpg_z&quot;,fill = &quot;mpg_grp&quot;,color = &quot;white&quot;,palette=&quot;jco&quot;,sort.val = &quot;asc&quot;,sort.by.groups = FALSE,x.text.angle=60,ylab=&quot;MPG z-score&quot;,xlab = FALSE,legend.title=&quot;MPG Group&quot;, rotate=TRUE)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-2dcd868fd28ffffc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggdotchart(df2,x=&quot;name&quot;,y=&quot;mpg&quot;,color=&quot;cyl&quot;,palette=c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),sorting = &quot;ascending&quot;,label=round(df2$mpg),sort.by.groups=TRUE, add = &quot;segments&quot;,ggtheme = theme_pubr())</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-52da937f2eb13bf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggdotchart"></p><h5 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data(&quot;mtcars&quot;)</span><br><span class="line">df &lt;- mtcars</span><br><span class="line">df$cyl &lt;- as.factor(df$cyl)</span><br><span class="line">head(df)</span><br><span class="line">p1 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">                color = &quot;red&quot;)</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a24a3b2366e0f7d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p2 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">          color = &quot;black&quot;, shape = 21, size = 3, # Points color, shape and size</span><br><span class="line">          add = &quot;reg.line&quot;,  # Add regressin line</span><br><span class="line">          add.params = list(color = &quot;blue&quot;, fill = &quot;lightgray&quot;), # Customize reg. line</span><br><span class="line">          conf.int = TRUE, # Add confidence interval</span><br><span class="line">          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor</span><br><span class="line">          cor.coeff.args = list(method = &quot;pearson&quot;, label.x = 3, label.sep = &quot;\n&quot;)</span><br><span class="line">)</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1c36709404563850.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># loess method: local regression fitting</span><br><span class="line">p3 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">          add = &quot;loess&quot;, conf.int = TRUE,</span><br><span class="line">          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor</span><br><span class="line">          cor.coeff.args = list(method = &quot;spearman&quot;, label.x = 3, label.sep = &quot;\n&quot;)</span><br><span class="line">)</span><br><span class="line">p3</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-5a65b9c0f9781c26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Control point size by continuous variable values (&quot;qsec&quot;)</span><br><span class="line">p4 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">          color = &quot;#00AFBB&quot;, size = &quot;qsec&quot;)</span><br><span class="line">p4</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-3bef095541a4639e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Change colors</span><br><span class="line"># Use custom color palette</span><br><span class="line"># Add marginal rug</span><br><span class="line">p5 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;, color = &quot;cyl&quot;, size = &quot;qsec&quot;,</span><br><span class="line">          palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;) )</span><br><span class="line">p5</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6416bbc005b70055.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p6 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;, color = &quot;cyl&quot;, rug=TRUE,</span><br><span class="line">                palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;) )</span><br><span class="line">p6</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-4dc429968aded238.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Add group ellipses and mean points</span><br><span class="line"># Add stars</span><br><span class="line">p7 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">          color = &quot;cyl&quot;, shape = &quot;cyl&quot;,</span><br><span class="line">          palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),</span><br><span class="line">          ellipse = TRUE)</span><br><span class="line">p7</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a5fa2cb936bd50f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p8 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">                color = &quot;cyl&quot;, shape = &quot;cyl&quot;,</span><br><span class="line">                palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),</span><br><span class="line">                ellipse = TRUE, ellipse.type = &quot;convex&quot;,</span><br><span class="line">                mean.point = TRUE,</span><br><span class="line">                )</span><br><span class="line">p8</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-846e3b34a1ea012e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p9 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">                color = &quot;cyl&quot;, shape = &quot;cyl&quot;,</span><br><span class="line">                palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),</span><br><span class="line">                ellipse = TRUE, ellipse.type = &apos;confidence&apos;,</span><br><span class="line">                mean.point = TRUE,</span><br><span class="line">                star.plot = TRUE)</span><br><span class="line">p9</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-751576439a6f4d8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Textual annotation</span><br><span class="line">df$name &lt;- rownames(df)</span><br><span class="line">p10 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">          color = &quot;cyl&quot;, palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),</span><br><span class="line">          label = &quot;name&quot;)</span><br><span class="line">p10</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-5ff1f602c239fb59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p11 &lt;- ggscatter(df, x = &quot;wt&quot;, y = &quot;mpg&quot;,</span><br><span class="line">                color = &quot;cyl&quot;, palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),</span><br><span class="line">                label = &quot;name&quot;, repel = TRUE)</span><br><span class="line">p11</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-375a9cf12852be34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggscatter"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Data</span><br><span class="line">df &lt;- data.frame(dose=c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),</span><br><span class="line">                 len=c(4.2, 10, 29.5))</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">p1 &lt;- ggbarplot(df,x=&quot;dose&quot;,y=&quot;len&quot;,label=TRUE,label.pos=&quot;out&quot;)</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-85834ef568015b8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Change width 更改柱子的宽度</span><br><span class="line">p2 &lt;- ggbarplot(df, x = &quot;dose&quot;, y = &quot;len&quot;, width = 0.2)</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-37cc61dd45a6fd2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Change the plot orientation: horizontal 变换坐标轴的方向</span><br><span class="line">p3 &lt;- ggbarplot(df, &quot;dose&quot;, &quot;len&quot;, orientation = &quot;horiz&quot;)</span><br><span class="line">p3</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-05d56895e3b77074.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Change the default order of items 设定指定的排列顺序</span><br><span class="line">p4 &lt;- ggbarplot(df, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">          order = c(&quot;D2&quot;, &quot;D1&quot;, &quot;D0.5&quot;))</span><br><span class="line">p4</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-5b0ca5b5b692a7d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Change colors 更改填充色和边框色</span><br><span class="line"># Change fill and outline color</span><br><span class="line"># add labels inside bars</span><br><span class="line">p5 &lt;- ggbarplot(df, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">          fill = &quot;steelblue&quot;, color = &quot;black&quot;,</span><br><span class="line">          label = TRUE, lab.pos = &quot;in&quot;, lab.col = &quot;white&quot;)</span><br><span class="line">p5</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-4fff94e64ab6464d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Change colors by groups: dose</span><br><span class="line"># Use custom color palette</span><br><span class="line">p6 &lt;- ggbarplot(df, &quot;dose&quot;, &quot;len&quot;, color = &quot;dose&quot;,</span><br><span class="line">          palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;))</span><br><span class="line">p6</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c186f918f3f5e24c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Change fill and outline colors by groups</span><br><span class="line">p7 &lt;- ggbarplot(df, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">          fill = &quot;dose&quot;, color = &quot;dose&quot;,</span><br><span class="line">          palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;))</span><br><span class="line">p7</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-e09f4a63b8647171.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Plot with multiple groups 分组绘图</span><br><span class="line"># Create some data</span><br><span class="line">df2 &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),</span><br><span class="line">                  dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),</span><br><span class="line">                  len=c(6.8, 15, 33, 4.2, 10, 29.5))</span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line"># Plot &quot;len&quot; by &quot;dose&quot; and change color by a second group: &quot;supp&quot;</span><br><span class="line"># Add labels inside bars</span><br><span class="line">p8 &lt;- ggbarplot(df2, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">          fill = &quot;supp&quot;, color = &quot;supp&quot;,</span><br><span class="line">          label = TRUE, lab.col = &quot;white&quot;, lab.pos = &quot;in&quot;)</span><br><span class="line">p8</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-60b4737c1b7257c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Change position: Interleaved (dodged) bar plot 更改排列方式</span><br><span class="line">p9 &lt;- ggbarplot(df2, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">          fill = &quot;supp&quot;, color = &quot;supp&quot;, palette = &quot;Paired&quot;,</span><br><span class="line">          label = TRUE,</span><br><span class="line">          position = position_dodge())</span><br><span class="line">p9</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-2d6e83419d16c8e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p10 &lt;- ggbarplot(df2, &quot;dose&quot;, &quot;len&quot;,</span><br><span class="line">                fill = &quot;supp&quot;, color = &quot;supp&quot;, palette = &quot;Paired&quot;,</span><br><span class="line">                label = TRUE,</span><br><span class="line">                position = position_fill())</span><br><span class="line">p10</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-eb4e932c99dc2d0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Add points and errors</span><br><span class="line"># Data: ToothGrowth data set we&apos;ll be used.</span><br><span class="line">df3 &lt;- ToothGrowth</span><br><span class="line">head(df3, 10)</span><br><span class="line"># It can be seen that for each group we have</span><br><span class="line"># different values</span><br><span class="line">p11 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,width =0.3)</span><br><span class="line">p11</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-462e8b3e6f910dd4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Visualize the mean of each group</span><br><span class="line">p12 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = &quot;mean&quot;)</span><br><span class="line">p12</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-9383f33fc2e4bde3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggbarplot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Add error bars: mean_se 添加不同类型的误差棒</span><br><span class="line"># (other values include: mean_sd, mean_ci, median_iqr, ....)</span><br><span class="line"># Add labels</span><br><span class="line">p13 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = &quot;mean_se&quot;, label = TRUE, lab.vjust = -1.6)</span><br><span class="line">p13</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-dd6226aec3f2cd17.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="误差棒"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Use only &quot;upper_errorbar&quot;</span><br><span class="line">p14 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = &quot;mean_se&quot;, error.plot = &quot;upper_errorbar&quot;)</span><br><span class="line">p14</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-50aad2f4eb9c3a65.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="头部误差棒"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Change error.plot to &quot;pointrange&quot;</span><br><span class="line">p15 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = &quot;mean_se&quot;, error.plot = &quot;pointrange&quot;)</span><br><span class="line">p15</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-5c81ed5171a27762.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="误差点"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Add jitter points and errors (mean_se)</span><br><span class="line">p16 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = c(&quot;mean_se&quot;, &quot;jitter&quot;))</span><br><span class="line">p16</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-fa3e5588420e997a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="误差散点"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Add dot and errors (mean_se)</span><br><span class="line">p17 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;,</span><br><span class="line">          add = c(&quot;mean_se&quot;, &quot;dotplot&quot;))</span><br><span class="line">p17</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-7ea09a7f168f05a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="误差点"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Multiple groups with error bars and jitter point</span><br><span class="line">p18 &lt;- ggbarplot(df3, x = &quot;dose&quot;, y = &quot;len&quot;, color = &quot;supp&quot;,</span><br><span class="line">          add = &quot;mean_se&quot;, palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;),</span><br><span class="line">          position = position_dodge())</span><br><span class="line">p18</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c5970d4f5e4adff8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="误差点"></p><h5 id="MA图"><a href="#MA图" class="headerlink" title="MA图"></a>MA图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 加载数据集</span><br><span class="line">data(diff_express)</span><br><span class="line">head(diff_express)</span><br><span class="line">p1 &lt;- ggmaplot(diff_express, fdr = 0.05, fc = 2, size = 0.4,</span><br><span class="line">               palette = c(&quot;red&quot;,&quot;green&quot;,&quot;gray&quot;))</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-66357ec5656ee9e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MA图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p2 &lt;- ggmaplot(diff_express, main = expression(&quot;Group 1&quot; %-&gt;% &quot;Group 2&quot;),</span><br><span class="line">         fdr = 0.05, fc = 2, size = 0.4,</span><br><span class="line">         palette = c(&quot;#B31B21&quot;, &quot;#1465AC&quot;, &quot;darkgray&quot;),</span><br><span class="line">         genenames = as.vector(diff_express$name),</span><br><span class="line">         xlab = &quot;M&quot;,ylab = &quot;A&quot;,</span><br><span class="line">         legend = &quot;top&quot;, top = 20,</span><br><span class="line">         font.label = c(&quot;bold&quot;, 11),</span><br><span class="line">         font.legend = &quot;bold&quot;,</span><br><span class="line">         font.main = &quot;bold&quot;,</span><br><span class="line">         ggtheme = ggplot2::theme_minimal())</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-d511bf324b4411f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MA图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Add rectangle around labels</span><br><span class="line">p3 &lt;- ggmaplot(diff_express, main = expression(&quot;Group 1&quot; %-&gt;% &quot;Group 2&quot;),</span><br><span class="line">         fdr = 0.05, fc = 2, size = 0.4,</span><br><span class="line">         palette = c(&quot;#B31B21&quot;, &quot;#1465AC&quot;, &quot;darkgray&quot;),</span><br><span class="line">         genenames = as.vector(diff_express$name),</span><br><span class="line">         legend = &quot;top&quot;, top = 20,</span><br><span class="line">         font.label = c(&quot;bold&quot;, 11), label.rectangle = TRUE,</span><br><span class="line">         font.legend = &quot;bold&quot;, select.top.method = &quot;padj&quot;,</span><br><span class="line">         font.main = &quot;bold&quot;,</span><br><span class="line">         ggtheme = ggplot2::theme_minimal())</span><br><span class="line">p3</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-3608db868bb696a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MA图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p4 &lt;- ggmaplot(diff_express, main = expression(&quot;Group 1&quot; %-&gt;% &quot;Group 2&quot;),</span><br><span class="line">               fdr = 0.05, fc = 2, size = 0.5,</span><br><span class="line">               palette = c(&quot;#B31B21&quot;, &quot;#1465AC&quot;, &quot;darkgray&quot;),</span><br><span class="line">               genenames = as.vector(diff_express$name),</span><br><span class="line">               legend = &quot;top&quot;, top = 20, select.top.method = &quot;fc&quot;,</span><br><span class="line">               font.label = c(&quot;bold&quot;, 11), label.rectangle = TRUE,</span><br><span class="line">               font.legend = &quot;bold&quot;,</span><br><span class="line">               font.main = &quot;bold&quot;,</span><br><span class="line">               ggtheme = ggplot2::theme_minimal())</span><br><span class="line">p4</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-f3d093d40b29b9c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MA图"></p><h5 id="饼状图"><a href="#饼状图" class="headerlink" title="饼状图"></a>饼状图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Data: Create some data</span><br><span class="line">df &lt;- data.frame(</span><br><span class="line">  group = c(&quot;Male&quot;, &quot;Female&quot;, &quot;Child&quot;),</span><br><span class="line">  value = c(25, 25, 50))</span><br><span class="line">head(df)</span><br><span class="line"></span><br><span class="line">p1 &lt;- ggpie(df, &quot;value&quot;, label = &quot;group&quot;)</span><br><span class="line">p1</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-f5ef79b4c04daa65.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="饼状图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Change color</span><br><span class="line"># Change fill color by group</span><br><span class="line"># set line color to white</span><br><span class="line"># Use custom color palette</span><br><span class="line">p2 &lt;- ggpie(df, &quot;value&quot;, label = &quot;group&quot;,</span><br><span class="line">      fill = &quot;group&quot;, color = &quot;white&quot;,</span><br><span class="line">      palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;) )</span><br><span class="line">p2</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a348e43ba326eba4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="饼状图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Change label</span><br><span class="line"># Show group names and value as labels</span><br><span class="line">labs &lt;- paste0(df$group, &quot; (&quot;, df$value, &quot;%)&quot;)</span><br><span class="line">labs</span><br><span class="line"></span><br><span class="line">p3 &lt;- ggpie(df, &quot;value&quot;, label = labs,</span><br><span class="line">      fill = &quot;group&quot;, color = &quot;white&quot;,</span><br><span class="line">      palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;))</span><br><span class="line">p3</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a807a31bae0d199d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="饼状图"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Change the position and font color of labels</span><br><span class="line">p4 &lt;- ggpie(df, &quot;value&quot;, label = labs,</span><br><span class="line">      lab.pos = &quot;in&quot;, lab.font = &quot;white&quot;,</span><br><span class="line">      fill = &quot;group&quot;, color = &quot;white&quot;,</span><br><span class="line">      palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;))</span><br><span class="line">p4</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1961cdd03a7d6bd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="饼状图"></p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><ul><li><a href="https://www.jianshu.com/p/f53a05da7745" target="_blank" rel="noopener">https://www.jianshu.com/p/f53a05da7745</a></li><li><a href="https://rpkgs.datanovia.com/ggpubr/" target="_blank" rel="noopener">https://rpkgs.datanovia.com/ggpubr/</a></li></ul><p>&emsp;&emsp;关注微信公众号，第一时间获取更新</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c23c58a787207a24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;软件简介&quot;&gt;&lt;a href=&quot;#软件简介&quot; class=&quot;headerlink&quot; title=&quot;软件简介&quot;&gt;&lt;/a&gt;软件简介&lt;/h4&gt;&lt;p&gt;Hadley Wickham编写的&lt;a href=&quot;https://ggplot2.tidyverse.org/&quot; targ
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>2019-11-11-NATURE IMMUNOLOGY-通过整合单细胞转录组和流式细胞术确定类风湿关节炎关节滑膜组织的炎性细胞状态</title>
    <link href="http://liuyang0681.github.io/2019/11/11/2019-11-11-NATURE-IMMUNOLOGY-%E9%80%9A%E8%BF%87%E6%95%B4%E5%90%88%E5%8D%95%E7%BB%86%E8%83%9E%E8%BD%AC%E5%BD%95%E7%BB%84%E5%92%8C%E6%B5%81%E5%BC%8F%E7%BB%86%E8%83%9E%E6%9C%AF%E7%A1%AE%E5%AE%9A%E7%B1%BB%E9%A3%8E%E6%B9%BF%E5%85%B3%E8%8A%82%E7%82%8E%E5%85%B3%E8%8A%82%E6%BB%91%E8%86%9C%E7%BB%84%E7%BB%87%E7%9A%84%E7%82%8E%E6%80%A7%E7%BB%86%E8%83%9E%E7%8A%B6%E6%80%81/"/>
    <id>http://liuyang0681.github.io/2019/11/11/2019-11-11-NATURE-IMMUNOLOGY-通过整合单细胞转录组和流式细胞术确定类风湿关节炎关节滑膜组织的炎性细胞状态/</id>
    <published>2019-11-11T06:33:18.000Z</published>
    <updated>2019-11-11T06:34:50.768Z</updated>
    
    <content type="html"><![CDATA[<h4 id="文章信息"><a href="#文章信息" class="headerlink" title="文章信息"></a>文章信息</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-ef34c1dd5207fc80.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文章信息"><br><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">标题：Defining inflammatory cell states <span class="keyword">in</span> rheumatoid arthritis joint synovial tissues <span class="keyword">by</span> integrating <span class="built_in">single</span>-cell transcriptomics <span class="keyword">and</span> mass cytometry</span><br><span class="line">期刊：NATURE IMMUNOLOGY</span><br><span class="line">影响因子：<span class="number">23.53</span></span><br><span class="line">日期：<span class="number">06</span> May <span class="number">2019</span></span><br></pre></td></tr></table></figure></p><h4 id="通讯作者介绍"><a href="#通讯作者介绍" class="headerlink" title="通讯作者介绍"></a>通讯作者介绍</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-947698fce8280000.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="通讯作者"><br>担任数据科学中心（BWH，HMS）的主任，并被任命为Broad Institute的准会员。此外，他还活跃于临床，并在布莱根妇女医院关节炎中心看病人。在斯坦福大学获得医学博士学位之后，Raychaudhuri继续从事内科临床培训，然后在布莱根妇女医院接受了风湿病专科培训。他同时与Mark Daly博士一起在Broad研究所完成了人类遗传学的博士后培训。自2010年加入哈佛医学院以来，他为了解类风湿关节炎和其他免疫介导的疾病的遗传基础做出了贡献。他还一直在设计统计和计算方法的最前沿，以将遗传关联信号定位到因果变体，并在功能信息的背景下解释人类遗传数据。他目前在结核病，I型糖尿病和类风湿性关节炎的人类遗传学和功能基因组学方面拥有活跃的研究计划，尤其专注于使用基因组策略来了解CD4 + T细胞生物学。</p><h4 id="研究背景"><a href="#研究背景" class="headerlink" title="研究背景"></a>研究背景</h4><p>类风湿性关节炎（RA）是一种自身免疫性疾病，在关节组织的滑膜中具有慢性炎症。这种炎症导致关节破坏，影响正常关节功能。但目前对关节滑膜组织中细胞类群状态还是不够明确的，利用单细胞测序技术可以在炎症组织中寻找关键细胞亚群及其活化状态这将为定义RA新治疗靶标提供必要的数据理论支持。之前的研究已经发现CD4 + T细胞，B细胞，单核细胞和成纤维细胞已确定与RA发病机理相关。</p><h4 id="样本及测序简介"><a href="#样本及测序简介" class="headerlink" title="样本及测序简介"></a>样本及测序简介</h4><p>样本来源:滑膜组织,作者招募了36名RA患者，15名OA患者，并从超声引导下的活检中或关节置换获得滑膜组织.<br><img src="https://upload-images.jianshu.io/upload_images/6732709-0ceb873feb98d9a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验设计"><br>实验手段包括质谱流式、Bulk RNA-seq、scRNA-seq<br>Bulk RNA-seq<br>1.对流式分选的细胞（T cells, B cells, monocytes, and synovial fibroblasts）进行转录组测序；工具：Illumina MiSeq ; 比对：Ensembl version 83 transcripts;<br>2.QC:（1）定义共同基因为在<code>95%</code>的样品有至少一条reads支持；（2）共同基因占比少于<code>99%</code>的样本定义为低质量样本在后续分析中将被剔除；<br>3.共获得<code>167</code>个高质量样本,包括<code>45</code> fibroblast samples, <code>46</code> monocyte samples, <code>47</code> T cell samples, and <code>29</code> B cell samples;<br>scRNA-seq<br>1.方法：CEL-Seq2; 工具：HiSeq 2500;Reads 通过STAR2.5.2b比对到<code>hg19</code>；<br>2.QC:作者发现由少量reads表示的分子更可能是来自其他细胞的污染物分子，所以开发了一种简单的算法来设置每分子最小读数的阈值。We used <code>2</code> marker genes expected to be exclusively expressed in each of the four cell types: <code>PDGFRA and ISLR</code> for fibroblasts, <code>CD2 and CD3D</code> for T cells, <code>CD79A and RALGPS2</code> for B cells, and <code>CD14 and C1QA</code> for monocytes. 然后计算这些基因在该表达的细胞类型中的高于阈值的表达定义为真阳性，在不该表达的细胞类型中的高于阈值的表达定义为假阳性。遍历表达阈值分别为<code>1-20</code>之间的数值，选取能够最大化真阳性/假阳性比值的值为最终阈值。然后作者进行以下条件的筛选：（1）细胞检测到的genes数&gt;<code>1000</code>;(2)线粒体相关基因的表达占比少于<code>25%</code>；<br>结合质谱流式，scRNA数据<br>1.作者收集6个富含白细胞、9个白细胞缺乏的RA和11个OA样品用于质谱流式分析；<br>2.双门控通道选定活细胞：B细胞（CD45 + CD3-CD14-CD19 +），成纤维细胞（CD45-PDPN +），单核细胞（CD45 + CD3-CD14 +）和T细胞（CD45 + CD3 + CD14-）；<br>3.作者基于CCA分析整合转录组数据和单细胞数据，开发一种基于图的无偏聚类pipeline对单个细胞进行分析；<br><img src="https://upload-images.jianshu.io/upload_images/6732709-47e32ff810ef7997.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据分析"></p><h4 id="下游数据分析策略"><a href="#下游数据分析策略" class="headerlink" title="下游数据分析策略"></a>下游数据分析策略</h4><p>（1）细胞分群及数据整合；作者利用流式对细胞进行分群后，以bulk RNA-seq作为reference point，利用CCA找到大量RNA-seq样品和scRNA-seq细胞的线性组合，以创建最大相关的基因表达谱。作者使用来自scRNA-seq的最佳标记基因与CCA结果关联，以建立每个scRNA-seq簇与每个质量细胞计数簇之间的关系；<br><img src="https://upload-images.jianshu.io/upload_images/6732709-2c8b05b5873ddabf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="细胞类型初确认"><br>（2）流式定义一部分RA滑膜组织中富含白细胞；组织免疫细胞浸润的变化反映了源关节中的局部疾病活动。作者计算了其它样本与OA的马氏距离（感谢微信公众号生信宝典对马氏距离的解释：马氏距离 (Mahalanobis distance)是由印度统计学家马哈拉诺比斯 (P. C. Mahalanobis)提出的，表示数据的协方差距离。它是一种有效的计算两个未知样本集的相似度的方法。与欧氏距离不同的是，它考虑到各种特性之间的联系，并且是尺度无关的(scale-invariant)，即独立于测量尺度。），引入最大OA距离作为滑膜中富含白细胞的阈值（&gt; 4.5）；为了验证炎症分类的有效性，作者评估了组织学的炎症状态，并且通过Krenn inflammation score (一种炎症评价指标) 对切片上的炎症状态进行评估；<br><img src="https://upload-images.jianshu.io/upload_images/6732709-23d49b75b87f4e3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="单细胞分型"></p><p>（3）单细胞分析揭示不同细胞亚型；在5,265个细胞中发现1,142 B cells, 1,844 fibroblasts, 750 monocytes and 1529 T cells (作者在这里说明传统基于PCA的分类batch effect较为明显，所以作者采用CCA-based clustering), 作者共分出来18 cell clusters; 成纤维细胞中，鉴定了四个亚群：CD34 +亚细胞成纤维细胞，HLA-DRAhi成纤维细胞，DKK3 +成纤维细胞和CD55 +lining成纤维细胞; 在单核细胞中, 作者鉴定了IL1B +促炎单核细胞，NUPR1 +单核细胞，C1QA +单核细胞和干扰素（IFN）活化的单核细胞；在T细胞中，鉴定了三个CD4 +簇：CCR7 + T细胞，FOXP3 +调节性T细胞（Treg细胞）和PDCD1 + TPH和TFH细胞;三个CD8 +簇：GZMK + T细胞，GNLY + GZMB +细胞毒性淋巴细胞（CTL）和GZMK + GZMB + T细胞。在B细胞内，鉴定了四个细胞簇，包括幼稚IGHD + CD27-和IGHG3 + CD27 +记忆B细胞，具有高表达ITGAX（也称为CD11c）的自身免疫相关B细胞（ABC）簇和具有高免疫球蛋白基因表达和XBP1的浆母细胞簇；（作者的细胞分型是比较符合免疫分型的，大家也可以采用以上marker对免疫细胞进行亚分型，不建议完全参照某一篇文章定义所有细胞分型）<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5ca3a7ee50262273.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="细胞因子"><br>（4）由细胞因子激活和MHC II表达定义不同的滑膜成纤维细胞；在Bulk seq中，与OA相比，leukocyte-rich RA中HLA-DRAhi细胞 HLA，IL6的表达情况更为明显，且在GO富集中，与MHC classII提呈和干扰素信号通路有关；然后作者通过scRNA seq 验证了该观点。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-9050708c21c9ca40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="单核细胞异质性"></p><p>（5）激活状态定义了滑膜单核细胞的异质性；在来自患有白细胞丰富的RA和OA的个体的大量RNA-seq单核细胞样品中，作者发现与IL1B +单核细胞相关的基因，包括NR4A2，HBEGF，PLAUR和IFN激活的基因IFITM3显着在富含白细胞的RA样品中上调。相反，与富含白细胞的RA相比，与NUPR1 +单核细胞（SC-M2）相关的标记基因下调。作者取每个单核细胞scRNA-seq子集的top标记基因（AUC&gt; 0.7），并在bulk seq中测试gene在RA与OA RNA-seq数据中的差异表达。<br>作者发现富含白细胞的RA滑膜与OA相比具有更大的IL1B +单核细胞和IFN激活的单细胞丰度，但更低NUPR1 +单核细胞的丰度。这些数据表明细胞因子激活驱动活动性RA滑膜中独特单核细胞群的扩增。利用基因组富集分析（GSEA），作者测试了MSigDB（分子特征数据库）免疫基因组，发现IL1B +单核细胞（SC-M1）脂多糖反应相关基因的表达水平相对较高；（一句话，单核细胞异质性较强）<br><img src="https://upload-images.jianshu.io/upload_images/6732709-42f8e6dfdf4312b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="滑膜CD4和CD8T细胞的异质性"></p><p>（6）滑膜CD4和CD8T细胞的异质性；作者在scRNA-seq数据中发现了三个CD4 +和三个CD8 + T细胞亚群（其实作者分出的亚群CD4比较好分，CD8多为exhausted T cell耗竭性基因的表达）鉴定了三个CD4+簇：CCR7 + T细胞，FOXP3 +调节性T细胞（Treg细胞）和PDCD1 + TPH和TFH细胞; 三个CD8 +簇：GZMK + T细胞，GNLY + GZMB +细胞毒性淋巴细胞（CTL）和GZMK + GZMB + T细胞。与OA相比，CXCL13在富含白细胞的OA的TPH细胞中上调表达; 作者通过质谱流式，鉴定出9个T cell clusters, 并通过结合bulk seq发现CXCL13, TIGIT and CTLA4在CD4+PD-1ICOS+cluster中富集；<br><img src="https://upload-images.jianshu.io/upload_images/6732709-553ba653adb65d1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="B细胞在类风湿性关节炎滑膜中呈异型亚群"></p><p>（7）通过单细胞RNA-seq发现在RA滑膜中自身免疫相关B细胞增加；细胞分型为幼稚B细胞（SC-B1），记忆B细胞（SC-B2），ITGAX + ABC细胞（SC-B3）和浆母细胞（SC-B4）；SC-B3细胞表达高水平的ITGAX和TBX21（T-bet），它们是自身免疫相关B细胞的标志物，AICDA的高表达与最近报道的来自系统性红斑狼疮（SLE）样品的外周血的CD11c + B细胞的转录组学分析一致。干扰素刺激的基因（GBP1和ISG15）也在ABCs（SC-B3）中表达并在富含白细胞的RA中上调。质谱流式分型划分10个细胞clusters,进一步分型发现CD11c +细胞内的三个亚组：IgM-IgD-HLA-DR ++ CD20 + CD11c +，CD38 + HLA-DR ++ CD20-CD11c +和IgM + IgD + CD11c +。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-8967dea5ae7b09d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="炎症路径和效应模块"><br>（8）通过单细胞分析揭示炎症途径和效应模块; 为了确定与富含白细胞的RA相关的途径，作者使用GO分析鉴定了I型干扰素反应和炎症反应（单核细胞和成纤维细胞），Fc受体信号传导（单核细胞），NF-κB信号传导 （成纤维细胞）和干扰素γ（T细胞）。富含白细胞的RA样本在成纤维细胞和单核细胞中具有显着更高的基因表达：炎症反应基因（PTGS2，PTGER3和ICAM1），干扰素应答基因（IFIT2，RSAD2，STAT1和XAF1），以及趋化因子或细胞因子基因（CCL2和CXCL9），与干扰素激活的协同趋化反应一致。 T细胞具有干扰素调节因子（IRF）的上调，包括IRF7和IRF9，并且单核细胞具有IRF7，IRF8和IRF9的上调。Toll样受体信号通路富含白细胞丰富的RA组织中的B细胞和单核细胞。<br>在单细胞水平，TLR10仅由活化的B细胞表达，表明TLR10在B细胞谱系中具有功能性作用。相反，TLR8在所有RA单核细胞亚群中升高。造血细胞特异性转录因子IRF8在显着部分的单核细胞和B细胞中表达，其协同调节RA滑膜中单核细胞和活化B细胞的分化。 SLAMF7由促炎单核细胞（SC-M1），IFN激活的单核细胞（SC-M4），CD8 + T细胞和浆母细胞（SC-B4）高度表达。</p><h4 id="临床意义及借鉴点"><a href="#临床意义及借鉴点" class="headerlink" title="临床意义及借鉴点"></a>临床意义及借鉴点</h4><p>（1）该篇文章强调可以将sublining fibroblast作为治疗RA的潜在靶点；（a major source of proinflammatory cytokines）<br>（2）第一次在富含白细胞的RA中发现自身免疫相关性B细胞；<br>（3）多维度的数据进行整合分析，开发基于CCA算法的流程，对每个细胞分群更为详细。<br>（4）对其他免疫系统疾病可以采取类似的实验设计方案，本篇文章具有重要借鉴意义。<br>（5）代码工具：<a href="https://github.com/immunogenomics/amp_phase1_ra" target="_blank" rel="noopener">https://github.com/immunogenomics/amp_phase1_ ra</a></p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p>1.<a href="https://cloud.tencent.com/developer/article/1442713" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1442713</a><br>2.<a href="https://www.ncbi.nlm.nih.gov/pubmed/31061532" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/pubmed/31061532</a></p><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-260feca2b4b63c8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;文章信息&quot;&gt;&lt;a href=&quot;#文章信息&quot; class=&quot;headerlink&quot; title=&quot;文章信息&quot;&gt;&lt;/a&gt;文章信息&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/67327
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
    
  </entry>
  
  <entry>
    <title>2019-11-07-cell-正常和白血病中骨髓基质的细胞分类学</title>
    <link href="http://liuyang0681.github.io/2019/11/11/2019-11-07-cell-%E6%AD%A3%E5%B8%B8%E5%92%8C%E7%99%BD%E8%A1%80%E7%97%85%E4%B8%AD%E9%AA%A8%E9%AB%93%E5%9F%BA%E8%B4%A8%E7%9A%84%E7%BB%86%E8%83%9E%E5%88%86%E7%B1%BB%E5%AD%A6/"/>
    <id>http://liuyang0681.github.io/2019/11/11/2019-11-07-cell-正常和白血病中骨髓基质的细胞分类学/</id>
    <published>2019-11-11T06:28:38.000Z</published>
    <updated>2019-11-11T06:31:24.413Z</updated>
    
    <content type="html"><![CDATA[<h4 id="文章信息"><a href="#文章信息" class="headerlink" title="文章信息"></a>文章信息</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题：A Cellular Taxonomy of the <span class="keyword">Bone </span><span class="keyword">Marrow </span><span class="keyword">Stroma </span>in Homeostasis <span class="keyword">and </span>Leukemia</span><br><span class="line">期刊：Cell</span><br><span class="line">日期：June <span class="number">13</span>，<span class="number">2018</span></span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-995d3c07136b48e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文章详情"></p><h4 id="通讯作者介绍"><a href="#通讯作者介绍" class="headerlink" title="通讯作者介绍"></a>通讯作者介绍</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-02c7a20b7fc0f281.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="David Scadden, MD"></p><p>实验室重点研究血液以其微环境或利基造血干细胞的特殊调控，结合了遗传学，影像学和药理学，定义了骨髓基质的关键组成部分以及干细胞如何运输和植入骨髓。<br>基于由正常的干细胞在正常组织治理机制的了解，该实验室已强调在疾病骨髓基质的作用。已经证明了微环境可以在失调的组织稳态和恶性肿瘤的发生中发挥主要作用。这项工作是研究基于生态位的癌症治疗方法的基础。</p><h4 id="样本及测序简介"><a href="#样本及测序简介" class="headerlink" title="样本及测序简介"></a>样本及测序简介</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-74c49ae6c0b8a6d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="样本信息"><br>文章利用小鼠骨髓基质niche细胞,取用了6只老鼠，基于液滴微流控系统完成单细胞RNA-seq的构建，共获得20896个单细胞，每个细胞平均捕获1710个基因，分出了17个群类，然后完成后续分析。</p><h4 id="数据分析策略"><a href="#数据分析策略" class="headerlink" title="数据分析策略"></a>数据分析策略</h4><p>1）数据描述层面做了分群，一些特异细胞类型的标记基因表达特征图<br><img src="https://upload-images.jianshu.io/upload_images/6732709-8c3fe6c66d6d21d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="标记基因"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-f9af9f1abcd1335a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据探索描述"><br>图一中还具体描述了类群间标记基因表达热图，每个类群细胞数目，类群间相关性，抽象图论网络，类群扩散图等信息，后边两个图在常规的单细胞分析中并不是很常见，可以作为单细胞数据描述层面分析上的亮点。<br>2）针对特定的细胞类群，做分亚群处理。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-c01622192233a5ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分亚群"><br>3）针对OLC亚群研究具体的生物学意义。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a348d90bdaca6a05.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="OLC"><br>4）研究软骨细胞和成纤维细胞的分化路径<br><img src="https://upload-images.jianshu.io/upload_images/6732709-583c287562a3d268.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="两种具体细胞的分化路径"><br>5）研究BMEC亚群<br><img src="https://upload-images.jianshu.io/upload_images/6732709-d36215a693db217d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>6）在造血基因表达过程中，周生细胞的三种亚型分析（新的发现）</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-08aacda7665623f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="三种亚型"><br>7）白血病中骨髓基质重塑<br><img src="https://upload-images.jianshu.io/upload_images/6732709-364e87d9d0c21b88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重塑模型"></p><h4 id="临床意义及借鉴点"><a href="#临床意义及借鉴点" class="headerlink" title="临床意义及借鉴点"></a>临床意义及借鉴点</h4><p>研究白血病和正常情况下骨髓基质的细胞图谱，对研究人类细胞白血病发生过程骨髓基质的动态变化成分认知具有重要意义。</p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p>Baryawno N, Przybylski D, Kowalczyk MS, et al. A Cellular Taxonomy of the Bone Marrow Stroma in Homeostasis and Leukemia. Cell. 2019;177(7):1915-1932.e16<br>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-260feca2b4b63c8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;文章信息&quot;&gt;&lt;a href=&quot;#文章信息&quot; class=&quot;headerlink&quot; title=&quot;文章信息&quot;&gt;&lt;/a&gt;文章信息&lt;/h4&gt;&lt;figure class=&quot;highlight armasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
    
  </entry>
  
  <entry>
    <title>液滴微流控获取单细胞及Drop-seq_tools分析流程</title>
    <link href="http://liuyang0681.github.io/2019/07/24/%E6%B6%B2%E6%BB%B4%E5%BE%AE%E6%B5%81%E6%8E%A7%E8%8E%B7%E5%8F%96%E5%8D%95%E7%BB%86%E8%83%9E%E5%8F%8ADrop-seq-tools%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/"/>
    <id>http://liuyang0681.github.io/2019/07/24/液滴微流控获取单细胞及Drop-seq-tools分析流程/</id>
    <published>2019-07-24T04:19:09.000Z</published>
    <updated>2019-07-24T04:23:23.757Z</updated>
    
    <content type="html"><![CDATA[<h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>&emsp;&emsp;单细胞领域目前算是进入白热化的阶段，自09年第一篇单细胞文章发表已经度过了10个年头，在通量和成本做到较好的平衡是Department of Genetics, Harvard Medical School，mccarroll实验室15年开发的基于液滴微流控系统生成单细胞Drop-seq技术。目前商业化最成功的10Xgenomics公司开发的单细胞产品也是在此技术的基础上优化而成。HCA人类细胞图谱计划得益与目前这些技术，快速实现了人类多个组织器官的单细胞图谱绘制。本文简要介绍Drop-seq实验的原理及数据分析工具Drop-seq_tools流程要点。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-7238fce9e7858baa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Drop-seq平台"></p><h6 id="Drop-seq实验"><a href="#Drop-seq实验" class="headerlink" title="Drop-seq实验"></a>Drop-seq实验</h6><p>&emsp;&emsp;Drop-seq主要核心部件为增压装置及液滴微流控合成装置，原理利用压力将磁珠，细胞，矿物油三种材料，压到微通道里，实现三个物质混成一个大液滴完成单细胞分离标记，完成后续建库。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-cf89e27d36a3f9b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-5a9bd427b1510109.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="Drop-seq-tools分析流程"><a href="#Drop-seq-tools分析流程" class="headerlink" title="Drop-seq_tools分析流程"></a>Drop-seq_tools分析流程</h5><p>&emsp;&emsp;不同的实验方案生成的单细胞数据，分析上整体差别不大，无外乎就是原始数据过滤质控，然后比对到基因组上，根据UMI及细胞barcode实现基因<br><img src="https://upload-images.jianshu.io/upload_images/6732709-b4f617c0a36e2d6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>&emsp;&emsp;Drop-seq_tools配合Picardtools，samtools STAR等工具实现对fq bam sam 等文件处理。流程首先将构建参考基因组文件夹，对物种的参考基因组fa及gtf文件做处理。<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">● fasta : The reference sequence <span class="keyword">of</span> <span class="keyword">the</span> organism. Needed <span class="keyword">for</span> most aligners.</span><br><span class="line">● dict : A dictionary <span class="built_in">file</span> <span class="keyword">as</span> generated <span class="keyword">by</span> Picard’s CreateSequenceDictionary . Needed <span class="keyword">for</span> Picard Tools.</span><br><span class="line">● gtf: The principle <span class="built_in">file</span> <span class="built_in">to</span> determine <span class="keyword">the</span> location <span class="keyword">of</span> genomic features like genes, transcripts, <span class="keyword">and</span> exons. Many other metadata <span class="built_in">files</span> we use derive <span class="built_in">from</span> this original <span class="built_in">file</span>. We download our GTF <span class="built_in">files</span> <span class="built_in">from</span> ensembl, which has <span class="keyword">a</span> handy description <span class="keyword">of</span> <span class="keyword">the</span> <span class="built_in">file</span> <span class="built_in">format</span> here . Ensembl has <span class="keyword">a</span> huge <span class="built_in">number</span> <span class="keyword">of</span> prepared GTF <span class="built_in">files</span> <span class="keyword">for</span> <span class="keyword">a</span> variety <span class="keyword">of</span> organisms here .</span><br><span class="line">● refFlat: This <span class="built_in">file</span> <span class="keyword">contains</span> <span class="keyword">a</span> subset <span class="keyword">of</span> <span class="keyword">the</span> <span class="keyword">the</span> same information <span class="keyword">in</span> <span class="keyword">the</span> GTF <span class="built_in">file</span> <span class="keyword">in</span> <span class="keyword">a</span> different <span class="built_in">format</span>. Picard tools like <span class="keyword">the</span> refFlat <span class="built_in">format</span>, so we <span class="built_in">require</span> this <span class="keyword">as</span> well. To make life easy, we provide <span class="keyword">a</span> program ConvertToRefFlat that can <span class="built_in">convert</span> <span class="built_in">files</span> <span class="built_in">from</span> GTF <span class="built_in">format</span> <span class="built_in">to</span> refFlat <span class="keyword">for</span> you.</span><br><span class="line">● genes.intervals: The genes <span class="built_in">from</span> <span class="keyword">the</span> GTF <span class="built_in">file</span> <span class="keyword">in</span> interval list <span class="built_in">format</span> . This <span class="built_in">file</span> is optional, <span class="keyword">and</span> useful <span class="keyword">if</span> you want <span class="built_in">to</span> go back <span class="built_in">to</span> your BAM later <span class="built_in">to</span> see what gene(s) <span class="keyword">a</span> <span class="built_in">read</span> aligns <span class="built_in">to</span>.</span><br><span class="line">● exons.intervals: The exons <span class="built_in">from</span> <span class="keyword">the</span> GTF <span class="built_in">file</span> <span class="keyword">in</span> interval list <span class="built_in">format</span> . This <span class="built_in">file</span> is optional, <span class="keyword">and</span> useful <span class="keyword">if</span> you want <span class="built_in">to</span> go back <span class="built_in">to</span> your BAM <span class="keyword">and</span> view what exon(s) <span class="keyword">a</span> <span class="built_in">read</span> aligns <span class="built_in">to</span>.</span><br><span class="line">● rRNA.intervals: The locations <span class="keyword">of</span> ribosomal RNA <span class="keyword">in</span> interval list <span class="built_in">format</span> . This <span class="built_in">file</span> is optional, but we find <span class="keyword">it</span> useful <span class="built_in">to</span> later assess how much <span class="keyword">of</span> <span class="keyword">a</span> dropseq library aligns <span class="built_in">to</span> rRNA.</span><br><span class="line">● reduced.gtf: This <span class="built_in">file</span> <span class="keyword">contains</span> <span class="keyword">a</span> subset <span class="keyword">of</span> <span class="keyword">the</span> information <span class="keyword">in</span> <span class="keyword">the</span> GTF <span class="built_in">file</span>, but <span class="keyword">in</span> <span class="keyword">a</span> far more human readable <span class="built_in">format</span>. This <span class="built_in">file</span> is optional, but can be generated easily <span class="keyword">by</span> <span class="keyword">the</span> supplied ReduceGTF program that will take <span class="keyword">a</span> GTF <span class="built_in">file</span> <span class="keyword">as</span> input.</span><br></pre></td></tr></table></figure></p><p>然后用Picard FastqToSam将下机文件转换成sam/bam<br>随后就可以利用drop-seq 的工具对bam文件做进一步的处理包括：<br>Example Cell Barcode:<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TagBamWithReadSequenceExtended</span><br><span class="line">INPUT=my_unaligned_data.bam</span><br><span class="line">OUTPUT=unaligned_tagged_Cell.bam</span><br><span class="line">SUMMARY=unaligned_tagged_Cellular.bam_summary.txt</span><br><span class="line">BASE_RANGE=112</span><br><span class="line">BASE_QUALITY=10</span><br><span class="line">BARCODED_READ=1</span><br><span class="line">DISCARD_READ=False</span><br><span class="line">TAG_NAME=XC</span><br><span class="line">NUM_BASES_BELOW_QUALITY=1</span><br></pre></td></tr></table></figure></p><p>Example Molecular Barcode:<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TagBamWithReadSequenceExtended</span><br><span class="line">INPUT=unaligned_tagged_Cell.bam</span><br><span class="line">OUTPUT=unaligned_tagged_CellMolecular.bam</span><br><span class="line">SUMMARY=unaligned_tagged_Molecular.bam_summary.txt</span><br><span class="line">BASE_RANGE=1320</span><br><span class="line">BASE_QUALITY=10</span><br><span class="line">BARCODED_READ=1</span><br><span class="line">DISCARD_READ=True</span><br><span class="line">TAG_NAME=XM</span><br><span class="line">NUM_BASES_BELOW_QUALITY=1</span><br></pre></td></tr></table></figure></p><p>FilterBAM<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">TAG_REJECT</span>=XQ</span><br><span class="line"><span class="attr">INPUT</span>=unaligned_tagged_CellMolecular.bam</span><br><span class="line"><span class="attr">OUTPUT</span>=unaligned_tagged_filtered.bam</span><br></pre></td></tr></table></figure></p><p>TrimStartingSequence</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TrimStartingSequence</span><br><span class="line">INPUT=unaligned_tagged_filtered.bam</span><br><span class="line">OUTPUT=unaligned_tagged_trimmed_smart.bam</span><br><span class="line">OUTPUT_SUMMARY=adapter_trimming_report.txt</span><br><span class="line">SEQUENCE=AAGCAGTGGTATCAACGCAGAGTGAATGGG</span><br><span class="line">MISMATCHES=0</span><br><span class="line">NUM_BASES=5</span><br></pre></td></tr></table></figure><p>PolyATrimmer<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PolyATrimmer</span><br><span class="line">INPUT=unaligned_tagged_trimmed_smart.bam</span><br><span class="line">OUTPUT=unaligned_mc_tagged_polyA_filtered.bam</span><br><span class="line">OUTPUT_SUMMARY=polyA_trimming_report.txt</span><br><span class="line">MISMATCHES=0</span><br><span class="line">NUM_BASES=6</span><br></pre></td></tr></table></figure></p><p>SamToFastq<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java Xmx4g jar /path/<span class="keyword">to</span>/picard/picard.jar SamToFastq</span><br><span class="line"><span class="attribute">INPUT</span>=unaligned_mc_tagged_polyA_filtered.bam</span><br><span class="line"><span class="attribute">FASTQ</span>=unaligned_mc_tagged_polyA_filtered.fastq</span><br></pre></td></tr></table></figure></p><p>以上完成对比对前的数据做完处理，后续做比对处理。<br>STAR<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/path/to/STAR/STAR</span></span><br><span class="line"><span class="params">--genomeDir</span> <span class="string">/path/to/STAR_REFERENCE</span></span><br><span class="line"><span class="params">--readFilesIn</span> unaligned_mc_tagged_polyA_filtered.fastq</span><br><span class="line"><span class="params">--outFileNamePrefix</span> star</span><br></pre></td></tr></table></figure></p><p>SortSam<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java Xmx4g jar /path/to/picard/picard<span class="selector-class">.jar</span> SortSam</span><br><span class="line">I=starAligned<span class="selector-class">.out</span><span class="selector-class">.sam</span></span><br><span class="line">O=aligned<span class="selector-class">.sorted</span><span class="selector-class">.bam</span></span><br><span class="line">SO=queryname</span><br></pre></td></tr></table></figure></p><p>MergeBamAlignment<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java Xmx4g jar /path/<span class="keyword">to</span>/picard/picard.jar MergeBamAlignment</span><br><span class="line"><span class="attribute">REFERENCE_SEQUENCE</span>=my_fasta.fasta</span><br><span class="line"><span class="attribute">UNMAPPED_BAM</span>=unaligned_mc_tagged_polyA_filtered.bam</span><br><span class="line"><span class="attribute">ALIGNED_BAM</span>=aligned.sorted.bam</span><br><span class="line"><span class="attribute">OUTPUT</span>=merged.bam</span><br><span class="line"><span class="attribute">INCLUDE_SECONDARY_ALIGNMENTS</span>=<span class="literal">false</span></span><br><span class="line"><span class="attribute">PAIRED_RUN</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure></p><p>TagReadWithGeneExon<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TagReadWithGeneExon</span><br><span class="line">I=merged.bam</span><br><span class="line">O=star_gene_exon_tagged.bam</span><br><span class="line">ANNOTATIONS_FILE=$&#123;refFlat&#125;</span><br><span class="line">TAG=GE</span><br></pre></td></tr></table></figure></p><p>DetectBeadSynthesisErrors Detecting and repairing barcode synthesis errors<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DetectBeadSynthesisErrors</span><br><span class="line">I=my.bam</span><br><span class="line">O=my_clean.bam</span><br><span class="line">OUTPUT_STATS=my.synthesis_stats.txt</span><br><span class="line">SUMMARY=my.synthesis_stats.summary.txt</span><br><span class="line">NUM_BARCODES= &lt;roughly 2x the number of cells&gt;</span><br><span class="line">PRIMER_SEQUENCE=AAGCAGTGGTATCAACGCAGAGTAC</span><br></pre></td></tr></table></figure></p><p>Digital Gene Expression<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DigitalExpression</span><br><span class="line">I=out_gene_exon_tagged.bam</span><br><span class="line">O=out_gene_exon_tagged<span class="selector-class">.dge</span><span class="selector-class">.txt</span><span class="selector-class">.gz</span></span><br><span class="line">SUMMARY=out_gene_exon_tagged<span class="selector-class">.dge</span><span class="selector-class">.summary</span><span class="selector-class">.txt</span></span><br><span class="line">NUM_CORE_BARCODES=<span class="number">100</span></span><br></pre></td></tr></table></figure></p><p>Cell Selection<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BAMTagHistogram</span><br><span class="line">I=out_gene_exon_tagged.bam</span><br><span class="line">O=out_cell_readcounts.txt.gz</span><br><span class="line">TAG=XC</span><br></pre></td></tr></table></figure></p><p>后续的数据可以接入Seurat做后续的过滤分群处理。</p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p><a href="https://github.com/broadinstitute/Drop-seq" target="_blank" rel="noopener">https://github.com/broadinstitute/Drop-seq</a><br><a href="http://mccarrolllab.org/dropseq/" target="_blank" rel="noopener">http://mccarrolllab.org/dropseq/</a></p><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ffd9e5b5502a93b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;单细胞领域目前算是进入白热化的阶段，自09年第一篇单细胞文章发表已经度过了10个年头，在通量和成本做到较好的平衡是D
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>生物统计与R语言（1）</title>
    <link href="http://liuyang0681.github.io/2019/06/10/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1%E4%B8%8ER%E8%AF%AD%E8%A8%80%EF%BC%881%EF%BC%89/"/>
    <id>http://liuyang0681.github.io/2019/06/10/生物统计与R语言（1）/</id>
    <published>2019-06-10T15:29:14.000Z</published>
    <updated>2019-06-10T15:30:33.051Z</updated>
    
    <content type="html"><![CDATA[<h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>&emsp;&emsp;生物统计学是生物数学中最早形成的一大分支，它是在用统计学的原理和方法研究生物学的客观现象及问题的过程中形成的，生物学中的问题又促使生物统计学中大部分基本方法进一步发展。生物统计学是应用统计学的分支，它将统计方法应用到医学及生物学领域，对于生物医学领域科研人员及在读学生，理解好统计学的基本方法及原理，才能真正准确的运用统计学的方法分析解释科研数据，得出更令人信服的结论，本系列专题将配合统计开源工具R语言系统介绍统计学在生物医学领域的原理及用法。</p><h5 id="统计的含义"><a href="#统计的含义" class="headerlink" title="统计的含义"></a>统计的含义</h5><ul><li>统计到底是个啥？<br>统计是将数据转化为可以帮助人们做决定的信息的工具。</li><li>统计包括的内容<br>研究设计<br>数据收集<br>数据管理<br>统计分析<ul><li>描述型统计</li><li>估计和推论</li><li>预测</li></ul></li><li>解释<h5 id="重要概念"><a href="#重要概念" class="headerlink" title="重要概念"></a>重要概念</h5></li><li>总体（population）：想要从重的出结论的群体。一般需要指定群体、地点和时间。栗子：2019年在山东省参加高考的学生。</li><li>样本（sample）：群体的子集。样本能够用来反应总体的信息。栗子：3万个随机选取的2019年在山东省参加高考的学生。</li><li>参数（parameter）：表示的是一个群体的数值特征。栗子：2019年在山东参加高考的学生的平均年龄。</li><li>统计量（statistics）：统计量是一个样本的数值特征。栗子：3万个随机选取的2019年在山东参加高考的的学生平均年龄。</li><li>推论（inference）：基于样本，得出关于群体的结论。栗子：2019年在山东省参加高考的学生平均年龄为18岁。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-2a73fad358c6909a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><h5 id="基础统计推论方法"><a href="#基础统计推论方法" class="headerlink" title="基础统计推论方法"></a>基础统计推论方法</h5></li><li>点估计：<br>样本中（3万个）山东省高考考生平均年龄为18岁。<br>推断群体（整个山东省）高考考生的平均年龄为18岁。</li><li>区间估计：<br>山东高考考生的平均年龄的可信范围是多少？<br>山东考生的平均年龄的95%的之心区间为16-20岁。</li><li>假设检验<br>样本是否提供充分的证据证明山东考生的平均年龄低于18岁。<br>零假设：山东考生的平均年龄大于18岁。<br>备则假设：山东考生平均年龄低于18岁。<br>P&lt; 0.05 拒绝零假设，有充分的证据证明山东考生平均年龄低于18岁。<br>P&gt; 0.05 无法拒绝零假设，没有充分的证据证明山东考生平均年龄低于18岁。</li></ul><h5 id="两大定律"><a href="#两大定律" class="headerlink" title="两大定律"></a>两大定律</h5><p>大数定律：重要实验测试足够多，样本均值就会趋近于总体的期望值。<br>中心极限定理：许多小的随机因素的叠加总会使总体的分布趋近于正态分布；不管总体分布是什么，只要样本量足够大，就可以把样本的均值视为服从正态分布。</p><h5 id="描述性统计"><a href="#描述性统计" class="headerlink" title="描述性统计"></a>描述性统计</h5><ul><li>数据类型（数据分析第一步）<br>1.离散型变量：<br>名词性（nominal）离散变量：二项分布变量（男 ：女）<br>顺序性（ordinal）离散变量：牙结石的分级<br>2.连续型变量：<br>正态分布（身高体重年龄）</li><li>描述性统计 （数据分析第二步）<br>1.离散型<br>频数（frequency），比例（proportion），百分比（percent）<br>列表（table）<br>饼图（pie charts），条形图（bar charts）<br>2.连续型<br>数据的大小：平均数（mean），中位数（median），众数（mode）,百分位数（percentile）<br>数据的差异：样本方差（variance），标准差（standard deviation）<br>数据分布形状：对称性（symmetry），偏斜程度（skewness），平缓程度（kurtosis）等。<br>直方图（histogram），箱型图（boxplot）<br>原因：了解分布情况，描述数据，统计模型的前提条件通常包括数据分布情况。<br>3.两个变量之间的关系<br>两个连续变量：身高和体重的关系；散点图<br>一个离散一个连续的变量：性别与身高的关系；分组做箱型图<br>两个离散变量：性别和吸烟之间的关系；表格（table）<br>4.检查数据质量<br>检查确实数据<br>检查异常值</li></ul><h5 id="实操栗子"><a href="#实操栗子" class="headerlink" title="实操栗子"></a>实操栗子</h5><ul><li><p>数据生成</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">samsize = <span class="number">1000</span></span><br><span class="line">age = rnorm(n=samsize, mean = <span class="number">50</span>, sd = <span class="number">10</span>)</span><br><span class="line">smoke = as.factor(c(rep(<span class="number">0</span>,<span class="number">500</span>),rep(<span class="number">1</span>,<span class="number">500</span>)))</span><br><span class="line">height = log2(rnorm(n=samsize, mean = <span class="number">3.2</span>, sd = <span class="number">0.1</span>))</span><br><span class="line">weight = <span class="number">35</span> * height + rnorm(n=samsize, mean = <span class="number">10</span>, sd = <span class="number">2</span>)</span><br><span class="line">weight[<span class="number">82</span>]=weight[<span class="number">82</span>]+<span class="number">20</span> #outlier</span><br><span class="line">#plot(height, weight)</span><br><span class="line">final_data=data.frame(age,(smoke),height,weight)</span><br><span class="line">head(final_data)</span><br><span class="line">       age X.smoke.   height   weight</span><br><span class="line"><span class="number">1</span> <span class="number">41.29590</span>        <span class="number">0</span> <span class="number">1.640680</span> <span class="number">65.68003</span></span><br><span class="line"><span class="number">2</span> <span class="number">31.77156</span>        <span class="number">0</span> <span class="number">1.767688</span> <span class="number">70.66953</span></span><br><span class="line"><span class="number">3</span> <span class="number">68.14326</span>        <span class="number">0</span> <span class="number">1.654074</span> <span class="number">68.69767</span></span><br><span class="line"><span class="number">4</span> <span class="number">57.88502</span>        <span class="number">0</span> <span class="number">1.648028</span> <span class="number">64.08887</span></span><br><span class="line"><span class="number">5</span> <span class="number">44.27702</span>        <span class="number">0</span> <span class="number">1.625258</span> <span class="number">67.79374</span></span><br><span class="line"><span class="number">6</span> <span class="number">54.55705</span>        <span class="number">0</span> <span class="number">1.676883</span> <span class="number">69.97073</span></span><br></pre></td></tr></table></figure></li><li><p>查看样本的个数和变量的个数</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">dim</span><span class="params">(final_data)</span></span></span><br><span class="line">[<span class="number">1</span>] <span class="number">1000</span>    <span class="number">4</span></span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(final_data<span class="variable">$height</span>)</span></span></span><br></pre></td></tr></table></figure></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/6732709-4ee6c57db6a34745.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><ul><li><p>确定数据类型</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">is</span>(final_data$age)</span><br><span class="line">[<span class="meta">1</span>] <span class="string">"numeric"</span> <span class="string">"vector"</span> </span><br><span class="line">&gt; <span class="keyword">is</span>(final_data$height)</span><br><span class="line">[<span class="meta">1</span>] <span class="string">"numeric"</span> <span class="string">"vector"</span> </span><br><span class="line">&gt; <span class="keyword">is</span>(final_data$weight)</span><br><span class="line">[<span class="meta">1</span>] <span class="string">"numeric"</span> <span class="string">"vector"</span> </span><br><span class="line">&gt; <span class="keyword">is</span>(final_data$X.smoke.)</span><br><span class="line">[<span class="meta">1</span>] <span class="string">"factor"</span>              <span class="string">"integer"</span>            </span><br><span class="line">[<span class="meta">3</span>] <span class="string">"oldClass"</span>            <span class="string">"numeric"</span>            </span><br><span class="line">[<span class="meta">5</span>] <span class="string">"vector"</span>              <span class="string">"data.frameRowLabels"</span></span><br><span class="line"></span><br><span class="line">age/height/weight是连续型</span><br><span class="line">smoke是离散型</span><br></pre></td></tr></table></figure></li><li><p>描述性统计<br>连续型变量（height）:<br>数据大小和差异</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;summary(final_data$height)</span><br><span class="line">   Min. <span class="number">1</span>st Qu.  Median    Mean <span class="number">3</span>rd Qu.    Max. </span><br><span class="line">  <span class="number">1.512</span>   <span class="number">1.653</span>   <span class="number">1.680</span>   <span class="number">1.681</span>   <span class="number">1.713</span>   <span class="number">1.794</span> </span><br><span class="line">&gt; sd(final_data$height)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.04622406</span></span><br><span class="line">&gt; var(final_data$height)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.002136664</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></li></ul><p>数据分布情况<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hist</span><span class="params">(final_data<span class="variable">$height</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(final_data<span class="variable">$height</span>)</span></span></span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6d8d328f50d73c34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-9c578a3437f8be1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>离散型变量：<br>吸烟情况<br>列表<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; table(final_data$X.smoke.)</span><br><span class="line"></span><br><span class="line">  <span class="number">0</span>   <span class="number">1</span> </span><br><span class="line"><span class="number">500</span> <span class="number">500</span></span><br></pre></td></tr></table></figure></p><p>饼图<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; prop1=sum(<span class="name">final_data</span>$X.smoke.==1)/length(<span class="name">final_data</span>$X.smoke.)</span><br><span class="line">&gt; prop0=sum(<span class="name">final_data</span>$X.smoke.==0)/length(<span class="name">final_data</span>$X.smoke.)</span><br><span class="line">&gt; pie(<span class="name">c</span>(<span class="name">prop0</span>,prop1),labels=c(<span class="string">"non-smk"</span>,<span class="string">"smk"</span>))</span><br></pre></td></tr></table></figure></p><p> 两个变量之间的关系<br>两个连续变量（身高体重）：<br>散点图<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">plot</span>(height,weight)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-62bf256be52828e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>一个离散一个连续：<br>吸烟和身高<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(final_data<span class="variable">$height</span>~final_data<span class="variable">$X</span>.smoke.)</span></span></span><br></pre></td></tr></table></figure></p><ul><li>检查数据质量<br>检查确实数据<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; is.na.data.frame(final_data)</span><br><span class="line">        age X.smoke. height weight</span><br><span class="line">   [<span class="number">1</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line">   [<span class="number">2</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line">   [<span class="number">3</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line">   [<span class="number">4</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line">   [<span class="number">5</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line">   [<span class="number">6</span>,] <span class="literal">FALSE</span>    <span class="literal">FALSE</span>  <span class="literal">FALSE</span>  <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line">&gt; sum(is.na(final_data))</span><br><span class="line">[<span class="number">1</span>] <span class="number">0</span></span><br></pre></td></tr></table></figure></li></ul><p>检查异常值<br><img src="https://upload-images.jianshu.io/upload_images/6732709-27521aed0cc09c81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><ul><li>《实用生物统计》第二版，李松岗</li><li>实用生物统计课程 – Ying Shan</li></ul><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ffd9e5b5502a93b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;生物统计学是生物数学中最早形成的一大分支，它是在用统计学的原理和方法研究生物学的客观现象及问题的过程中形成的，生物学
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>eLIFE-单细胞转录组学揭示果蝇中脑的细胞多样性</title>
    <link href="http://liuyang0681.github.io/2019/05/28/eLIFE-%E5%8D%95%E7%BB%86%E8%83%9E%E8%BD%AC%E5%BD%95%E7%BB%84%E5%AD%A6%E6%8F%AD%E7%A4%BA%E6%9E%9C%E8%9D%87%E4%B8%AD%E8%84%91%E7%9A%84%E7%BB%86%E8%83%9E%E5%A4%9A%E6%A0%B7%E6%80%A7/"/>
    <id>http://liuyang0681.github.io/2019/05/28/eLIFE-单细胞转录组学揭示果蝇中脑的细胞多样性/</id>
    <published>2019-05-28T09:05:14.000Z</published>
    <updated>2019-05-28T09:06:26.095Z</updated>
    
    <content type="html"><![CDATA[<h4 id="文章信息"><a href="#文章信息" class="headerlink" title="文章信息"></a>文章信息</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题：Cellular diversity <span class="keyword">in</span> <span class="keyword">the</span> Drosophila midbrain revealed <span class="keyword">by</span> single-cell transcriptomics</span><br><span class="line">期刊：eLife</span><br><span class="line">日期：<span class="number">19</span> April <span class="number">2018</span></span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-61e1ff34864718ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h4 id="通讯作者介绍"><a href="#通讯作者介绍" class="headerlink" title="通讯作者介绍"></a>通讯作者介绍</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-bc6a21d8d313b2ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>Scott是Wellcome Trust基础生物医学科学研究院首席研究员，神经生物学教授，EMBO成员，并获得2014年Liliane Bettencourt生命科学奖，多年从事果蝇神经通路研究。</p><h4 id="样本及测序简介"><a href="#样本及测序简介" class="headerlink" title="样本及测序简介"></a>样本及测序简介</h4><p><img src="https://upload-images.jianshu.io/upload_images/6732709-717144602607990e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>研究样本为80-100个雌雄比例1:1果蝇中脑组织，消化成单细胞，利用Drop-seq技术（10X公司技术基础），完成单细胞建库及后续生成矩阵，降维聚类等分析。同时也做了斜纹夜蛾1：1混养建库测试双胞比率情况。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5428edf2e69eab33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-7677b25edab9932c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>数据合并了八个独立的文库，共获得19,260个单细胞，通过过滤垫UMI低于800的细胞，最后获得10286个高质量的单细胞数据。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-c375537203b153b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>此外还评估了drop-out rate，策略为选择一个在雄性中特异性表达的非编码RNA，评估UMI比率，来预测整体的drop-out比率。</p><h4 id="数据分析策略"><a href="#数据分析策略" class="headerlink" title="数据分析策略"></a>数据分析策略</h4><p>通过对高质量的细胞进行聚类，共获得28个亚群，其中最大的一群为7000多个细胞，作者标注为未注释状态。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-38e71832aa7d4bdf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>通过和之前的群体RNA的数据做比较，来验证本次试验的准确性。<br>后续做了蘑菇体Kenyon细胞的鉴定、嗅觉神经元的识别、胶质细胞和星形胶质细胞识别、分配速效神经递质、神经肽表达分析、单胺能神经元的分配和细分、多巴胺受体、多巴胺代谢、烟碱型神经递质受体的分布、活性调节基因的共表达等个性化分析。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-188b8ec2525a4a50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-d9cb9e48c87f3bf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-5cbca504dac03f62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h4 id="临床意义及借鉴点"><a href="#临床意义及借鉴点" class="headerlink" title="临床意义及借鉴点"></a>临床意义及借鉴点</h4><p>单细胞在昆虫里的研究为单细胞技术在组织大小和细胞数量问题提供解决方案。蝇是具有组织的复杂生物，其具有与许多哺乳动物器官类似的功能。而且，与它们的哺乳动物等同物相比，这些苍蝇组织中的每一个都包含少量细胞。在研究大脑时，这技术实现上可能是最明显的，作为脑细胞图谱的模型具有明显优势。</p><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5927767/" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5927767/</a></p><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-260feca2b4b63c8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;文章信息&quot;&gt;&lt;a href=&quot;#文章信息&quot; class=&quot;headerlink&quot; title=&quot;文章信息&quot;&gt;&lt;/a&gt;文章信息&lt;/h4&gt;&lt;figure class=&quot;highlight livecodeserver&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
    
  </entry>
  
  <entry>
    <title>2019年人类细胞图谱计划（HCA）日本会议</title>
    <link href="http://liuyang0681.github.io/2019/05/23/2019%E5%B9%B4%E4%BA%BA%E7%B1%BB%E7%BB%86%E8%83%9E%E5%9B%BE%E8%B0%B1%E8%AE%A1%E5%88%92%EF%BC%88HCA%EF%BC%89%E6%97%A5%E6%9C%AC%E4%BC%9A%E8%AE%AE/"/>
    <id>http://liuyang0681.github.io/2019/05/23/2019年人类细胞图谱计划（HCA）日本会议/</id>
    <published>2019-05-23T12:32:33.000Z</published>
    <updated>2019-05-23T12:35:42.834Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/6732709-de1852556ee92651.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>&emsp;&emsp;2019年HCA会议于五月23日，24日在日本举行，届时领域内知名科学家共聚一堂，探讨单细胞技术的发展，遇到的挑战及解决方案，是单细胞领域的一场盛宴。油管网站提供全程直播及后续录播服务，点击下方Video可直达视频地址（需科/学/上/网）。</p><h3 id="Day-1-Main-Hall"><a href="#Day-1-Main-Hall" class="headerlink" title="Day 1, Main Hall"></a>Day 1, Main Hall</h3><h4 id="Video"><a href="#Video" class="headerlink" title="Video"></a><a href="https://www.youtube.com/watch?v=mURmRcTloNg" target="_blank" rel="noopener">Video</a></h4><ul><li>8:30 am Welcome</li><li>8:45 am State of HCA</li><li>9:05 am Session 1: State of the Working Groups</li><li>11:30 am Session 2: Cross Collaboration</li><li>4:45 pm Round Table Summaries<h3 id="Day-2-Main-Hall"><a href="#Day-2-Main-Hall" class="headerlink" title="Day 2, Main Hall"></a>Day 2, Main Hall</h3></li></ul><h4 id="Video-1"><a href="#Video-1" class="headerlink" title="Video"></a><a href="https://www.youtube.com/watch?v=_ofrHLjV1tk" target="_blank" rel="noopener">Video</a></h4><ul><li>9:00 am Data standardization, normalization and integration Breakout Session<br>Breakout Session Leaders:<br>Daniel Gilchrist<br>Peter Kharchenko<br>Caroline Uhler</li><li>11 am Breakout Report Back</li><li>11:30 am Discussion: Integration of experiments, data and assembly</li><li>12:30 pm Meeting Summary<h3 id="Day-2-Room-A"><a href="#Day-2-Room-A" class="headerlink" title="Day 2, Room A"></a>Day 2, Room A</h3></li></ul><h4 id="Video-2"><a href="#Video-2" class="headerlink" title="Video"></a><a href="https://www.youtube.com/watch?v=QwVLNLi0-AQ" target="_blank" rel="noopener">Video</a></h4><ul><li>9:00 am Experimental design and methods Breakout Session<br>Breakout Session Leaders:<br>Kristin Ardlie<br>Jimmie Ye<br>Holger Heyn<br>Orit Rosen<br>Guoji Guo</li></ul><h3 id="Day-2-Room-B"><a href="#Day-2-Room-B" class="headerlink" title="Day 2, Room B"></a>Day 2, Room B</h3><h4 id="Video-3"><a href="#Video-3" class="headerlink" title="Video"></a><a href="https://www.youtube.com/watch?v=10U0fXWCCTs" target="_blank" rel="noopener">Video</a></h4><p>9:00 am Common Coordinate Framework Breakout Session<br>Breakout Session Leaders:<br>Rahul Satija<br>Ajay Pillai</p><p>以下为第一天部分精彩影像材料<br><img src="https://upload-images.jianshu.io/upload_images/6732709-8387853880ca158f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-be597010d276e659.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-5c50f933cc7de24e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-c8baf6cc32d9539d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-9699f0f0d206bfb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-c11bf2bea0582079.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-2b0befb3979062c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-fe3645c6699fb95e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-afe9ee7d58113f7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-a923f5221944fedd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-a27aef9b12d152fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-64d78023947be457.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-c02626e571b7a3bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-0fd1c71a4c743b77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-6d82acaaa8b905a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-a3c72cc18bf4f1a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-93bc12cfe4cc6691.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-484df36a1eb3fc40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-590118f50c7b2b03.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-3a3054813b12ac24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><img src="https://upload-images.jianshu.io/upload_images/6732709-24cddc9e608e77d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-cf6844dd4c73fa2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/6732709-de1852556ee92651.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>换个姿势标准化单细胞数据</title>
    <link href="http://liuyang0681.github.io/2019/05/22/%E6%8D%A2%E4%B8%AA%E5%A7%BF%E5%8A%BF%E6%A0%87%E5%87%86%E5%8C%96%E5%8D%95%E7%BB%86%E8%83%9E%E6%95%B0%E6%8D%AE/"/>
    <id>http://liuyang0681.github.io/2019/05/22/换个姿势标准化单细胞数据/</id>
    <published>2019-05-22T15:27:22.000Z</published>
    <updated>2019-05-22T15:28:25.683Z</updated>
    
    <content type="html"><![CDATA[<h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>&emsp;&emsp;由于单细胞数据的高维度，基因长度差异，覆盖度差异及实验过程中的偏好性等因素，对前期数据进行有质量的标准化，对后续分析结果解读至关重要。标准化的分析比较多，对于常规的群体RNA分析而言，各种软件包也有相应的标准化方式，基因的定量也有RPKM ，TPM等标准化指标，单细胞数据对标准化的要求更高，本篇文章主要介绍新的标准化方法<code>sctransform</code>，他可以应用到Seurat中替换其原有的标准化函数。<a href="https://www.jianshu.com/p/152e19e70646" target="_blank" rel="noopener">seuratV3简介及实操</a>有对其相应的介绍。</p><h5 id="安装R包及数据导入创建对象"><a href="#安装R包及数据导入创建对象" class="headerlink" title="安装R包及数据导入创建对象"></a>安装R包及数据导入创建对象</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#打开R环境直接安装</span><br><span class="line">devtools::install_github(repo = <span class="string">'ChristophH/sctransform'</span>, ref = <span class="string">'develop'</span>)</span><br><span class="line">devtools::install_github(repo = <span class="string">'satijalab/seurat'</span>, ref = <span class="string">'release/3.0'</span>)</span><br><span class="line">#也可以直接安装SeuratV3包</span><br><span class="line">install.packages(<span class="string">"seurat"</span>)</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(Seurat)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(sctransform)</span></span></span><br><span class="line">#测试数据在<span class="number">10</span>X官网下载</span><br><span class="line">pbmc_data &lt;- Read10X(data<span class="selector-class">.dir</span> = <span class="string">"pbmc3k/filtered_gene_bc_matrices/hg19/"</span>)</span><br><span class="line">pbmc &lt;- CreateSeuratObject(counts = pbmc_data)</span><br></pre></td></tr></table></figure><h5 id="细节介绍"><a href="#细节介绍" class="headerlink" title="细节介绍"></a>细节介绍</h5><p>为什么在使用sctransform时可以选择更多的PC？<br>答：</p><ul><li>在<a href="https://satijalab.org/seurat/pbmc3k_tutorial.html" target="_blank" rel="noopener">标准的Seurat工作流程中，</a>我们专注于此数据集的10PC，但我们强调结果与此参数的更高设置相似。有趣的是，我们发现在使用sctransform时，我们通常会将此参数推得更高。我们相信这是因为sctransform工作流程执行更有效的规范化，强烈消除了数据的技术效果。</li><li>即使在标准对数归一化之后，测序深度的变化仍然是一个混淆因素（<a href="https://www.biorxiv.org/content/biorxiv/early/2019/03/18/576827.full.pdf" target="_blank" rel="noopener">见图1</a>），这种影响可以巧妙地影响更高的PC。在sctransform中，这种影响大大减轻了（<a href="https://www.biorxiv.org/content/biorxiv/early/2019/03/18/576827.full.pdf" target="_blank" rel="noopener">见图3</a>）。这意味着更高的PC更有可能代表微妙的，但与生物学相关的异质性来源 - 因此包括它们可能会改善下游分析。</li><li>此外，sctransform默认返回3,000个变量功能，而不是2,000。基本原理类似，额外的变量特征不太可能由细胞间的技术差异驱动，而是可能代表更微妙的生物波动。一般来说，我们发现用sctransform产生的结果较少依赖于这些参数（实际上，当在转录组中使用所有基因时，我们获得了几乎相同的结果，尽管这确实降低了计算效率）。这可以帮助用户生成更强大的结果，此外，还可以应用具有相同参数设置的标准anlaysis管道，这些参数设置可以快速应用于新数据集：</li></ul><p>例如，以下代码在单个命令中复制完整的端到端工作流：<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pbmc &lt;- CreateSeuratObject(pbmc_data) %&gt;% PercentageFeatureSet(pattern = <span class="string">"^MT-"</span>, col.name = <span class="string">"percent.mt"</span>) %&gt;% </span><br><span class="line">    SCTransform(vars.to.regress = <span class="string">"percent.mt"</span>) %&gt;% RunPCA() %&gt;% FindNeighbors(dims = <span class="number">1</span>:<span class="number">30</span>) %&gt;% </span><br><span class="line">    RunUMAP(dims = <span class="number">1</span>:<span class="number">30</span>) %&gt;% FindClusters()</span><br></pre></td></tr></table></figure></p><p>sctransform存储的归一化值在哪里？<br>答：<br> 如的<a href="https://www.biorxiv.org/content/biorxiv/early/2019/03/18/576827.full.pdf" target="_blank" rel="noopener">预印本中所述</a>，sctransform使用“正则化负二项式回归”计算scRNA-seq数据中的技术噪声模型。该模型的残差是标准化值，可以是正数或负数。给定基因中给定基因的阳性残基表明，鉴于基因在群体和细胞测序深度中的平均表达，观察到比预期更多的UMI，而负残差表明相反。<br>sctransfrom的结果存储在“SCT”测定中。您可以在<a href="http://satijalab01.nygenome.org/seurat/v3.0/multimodal_vignette.html" target="_blank" rel="noopener">插图</a>，<a href="http://satijalab01.nygenome.org/seurat/essential_commands.html#multi-assay-features" target="_blank" rel="noopener">命令备忘单</a>或<a href="https://github.com/satijalab/seurat/wiki/Assay" target="_blank" rel="noopener">开发者指南中</a>了解有关Seurat中多种化验数据和命令的更多信息。</p><ul><li><code>pbmc[[&quot;SCT&quot;]]@scale.data</code>包含残差（标准化值），并直接用作PCA的输入。请注意，这个矩阵是非稀疏的，因此如果为所有基因存储，则会占用大量内存。为了节省内存，我们通过在<code>SCTransform</code>函数调用中默认设置return.only.var.genes = TRUE来仅为变量基因存储这些值。</li><li>协助可视化和解释。我们还将Pearson残差转换回’更正’的UMI计数。您可以将这些解释为我们希望观察到的所有细胞都被测序到相同深度的UMI计数。如果您想确切了解我们如何做到这一点，请在<a href="https://github.com/ChristophH/sctransform/blob/master/R/denoise.R" target="_blank" rel="noopener">此处</a>查看正确的功能。</li><li>“更正的”UMI计数存储在<code>pbmc[[&quot;SCT&quot;]]@counts</code>。我们存储这些校正计数的日志标准化版本，这<code>pbmc[[&quot;SCT&quot;]]@data</code>对可视化非常有用。</li><li>您可以使用更正的对数标准化计数进行差异表达和积分。然而，原则上，直接对残差（存储在<code>scale.data</code>槽中）本身执行这些计算是最佳的。Seurat v3目前不支持此功能，但很快就会支持。<h5 id="两种标准化方式比较"><a href="#两种标准化方式比较" class="headerlink" title="两种标准化方式比较"></a>两种标准化方式比较</h5>作为参考，首先应用标准的Seurat工作流程，并使用对数标准化<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pbmc_logtransform &lt;- pbmc</span><br><span class="line">pbmc_logtransform &lt;- NormalizeData(<span class="name">pbmc_logtransform</span>, verbose = FALSE)</span><br><span class="line">pbmc_logtransform &lt;- FindVariableFeatures(<span class="name">pbmc_logtransform</span>, verbose = FALSE) </span><br><span class="line">pbmc_logtransform &lt;- ScaleData(<span class="name">pbmc_logtransform</span>, verbose = FALSE) </span><br><span class="line">pbmc_logtransform &lt;- RunPCA(<span class="name">pbmc_logtransform</span>, verbose = FALSE) </span><br><span class="line">pbmc_logtransform &lt;- RunUMAP(<span class="name">pbmc_logtransform</span>,dims = <span class="number">1</span>:<span class="number">20</span>, verbose = FALSE)</span><br></pre></td></tr></table></figure></li></ul><p>为了比较，现在应用sctransform规范化<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Note that <span class="keyword">this</span> single command replaces NormalizeData, ScaleData, and FindVariableFeatures.</span><br><span class="line"># Transformed <span class="keyword">data</span> will be available <span class="keyword">in</span> the SCT assay, which <span class="keyword">is</span> <span class="keyword">set</span> <span class="keyword">as</span> the <span class="keyword">default</span> after running sctransform</span><br><span class="line">pbmc &lt;- SCTransform(<span class="keyword">object</span> = pbmc, verbose = FALSE)</span><br></pre></td></tr></table></figure></p><p>通过PCA和UMAP嵌入执行降维<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># These are now standard steps in the Seurat workflow for visualization and clustering</span></span><br><span class="line">pbmc &lt;- RunPCA<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">verbose</span> = FALSE)</span></span><br><span class="line">pbmc &lt;- RunUMAP<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">dims</span> = 1:20, <span class="attr">verbose</span> = FALSE)</span></span><br><span class="line">pbmc &lt;- FindNeighbors<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">dims</span> = 1:20, <span class="attr">verbose</span> = FALSE)</span></span><br><span class="line">pbmc &lt;- FindClusters<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">verbose</span> = FALSE)</span></span><br></pre></td></tr></table></figure></p><p>在sctransform和log-normalized嵌入上可视化聚类结果。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pbmc_logtransform<span class="variable">$clusterID</span> &lt;- Idents(pbmc)</span><br><span class="line"><span class="function"><span class="title">Idents</span><span class="params">(pbmc_logtransform)</span></span> &lt;- <span class="string">'clusterID'</span></span><br><span class="line">plot1 &lt;- DimPlot(<span class="selector-tag">object</span> = pbmc, <span class="selector-tag">label</span> = TRUE) + NoLegend() + ggtitle(<span class="string">'sctransform'</span>) </span><br><span class="line">plot2 &lt;- DimPlot(<span class="selector-tag">object</span> = pbmc_logtransform, <span class="selector-tag">label</span> = TRUE)</span><br><span class="line">plot2 &lt;- plot2 + NoLegend() + ggtitle(<span class="string">'Log-normalization'</span>) </span><br><span class="line"><span class="function"><span class="title">CombinePlots</span><span class="params">(list(plot1,plot2)</span></span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-80bee295f1189e9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>用户可以基于规范标记单独注释群集。然而，与对数归一化分析相比，sctransform归一化显示出更明显的生物学区别。例如，注意在对数归一化分析中如何将簇0,1,9和11（所有不同的T细胞簇）混合在一起。sctransform分析显示：</p><ul><li>基于CD8A，GZMK，CCL5，GZMK表达，清楚分离三个CD8 T细胞簇（幼稚，记忆，效应器）</li><li>基于S100A4，CCR7，IL32和ISG15清楚分离三个CD4 T细胞簇（幼稚，记忆，IFN激活）</li><li>B细胞群中的附加发育子结构，基于TCL1A，FCER2</li><li>基于XCL1和FCGR3A的NK细胞簇内的额外亚结构（CD56dim对比亮）<br>将规范标记基因可视化为小提琴图。<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># These are now standard steps in the Seurat workflow for visualization and clustering Visualize</span></span><br><span class="line"><span class="comment"># canonical marker genes as violin plots.</span></span><br><span class="line">VlnPlot(pbmc, <span class="attr">features</span> = c(<span class="string">"CD8A"</span>, <span class="string">"GZMK"</span>, <span class="string">"CCL5"</span>, <span class="string">"S100A4"</span>, <span class="string">"ANXA1"</span>, <span class="string">"CCR7"</span>, <span class="string">"ISG15"</span>, <span class="string">"CD3D"</span>), </span><br><span class="line">    pt.<span class="attr">size</span> = <span class="number">0.2</span>, <span class="attr">ncol</span> = <span class="number">4</span>)</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/6732709-ca1b2046c9ffe51e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>在sctransform嵌入上可视化规范标记基因。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">FeaturePlot</span><span class="params">(object = pbmc, features = c(<span class="string">"CD8A"</span>,<span class="string">"GZMK"</span>,<span class="string">"CCL5"</span>,<span class="string">"S100A4"</span>,<span class="string">"S100A4"</span>,<span class="string">"CCR7"</span>)</span></span>, pt<span class="selector-class">.size</span> = <span class="number">0.2</span>,ncol = <span class="number">3</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-33251aefad3a2792.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">FeaturePlot</span><span class="params">(object = pbmc, features = c(<span class="string">"CD3D"</span>,<span class="string">"ISG15"</span>,<span class="string">"TCL1A"</span>,<span class="string">"FCER2"</span>,<span class="string">"XCL1"</span>,<span class="string">"FCGR3A"</span>)</span></span>, pt<span class="selector-class">.size</span> = <span class="number">0.2</span>,ncol = <span class="number">3</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1103c3155b4994e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="参考材料"><a href="#参考材料" class="headerlink" title="参考材料:"></a>参考材料:</h5><p><a href="https://rawgit.com/ChristophH/sctransform/master/inst/doc/seurat.html" target="_blank" rel="noopener">https://rawgit.com/ChristophH/sctransform/master/inst/doc/seurat.html</a><br><a href="https://satijalab.org/seurat/v3.0/sctransform_vignette.html" target="_blank" rel="noopener">https://satijalab.org/seurat/v3.0/sctransform_vignette.html</a></p><p>关注微信公众号，第一时间获取更新<br><img src="https://upload-images.jianshu.io/upload_images/6732709-dd95f9cefa2e060e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;由于单细胞数据的高维度，基因长度差异，覆盖度差异及实验过程中的偏好性等因素，对前期数据进行有质量的标准化，对后续分析
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>单细胞数据整合分析哪家强?</title>
    <link href="http://liuyang0681.github.io/2019/05/21/%E5%8D%95%E7%BB%86%E8%83%9E%E6%95%B0%E6%8D%AE%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90%E5%93%AA%E5%AE%B6%E5%BC%BA/"/>
    <id>http://liuyang0681.github.io/2019/05/21/单细胞数据整合分析哪家强/</id>
    <published>2019-05-21T12:43:06.000Z</published>
    <updated>2019-05-21T12:44:00.746Z</updated>
    
    <content type="html"><![CDATA[<h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>&emsp;&emsp;目前单细胞数据分析有不少的挑战，比如稀疏矩阵，超高维度数据降维，批次效应校正，聚类算法的选择，多组学数据整合等挑战。有需求就需要造轮子，当前也有了部分工具可以处理部分挑战，但准确性还需要具体评估，本篇文章介绍实操整合多个批次数据工具SeuratV3中嵌合的整合算法处理官网实示例PBMC刺激及对照实验组数据，<a href="https://www.jianshu.com/p/152e19e70646" target="_blank" rel="noopener">SeuratV3简介及实操</a>一文中有对该工具的具体介绍及常规实操。</p><h5 id="整合目标"><a href="#整合目标" class="headerlink" title="整合目标"></a>整合目标</h5><p>概述使用Seurat集成过程可能实现的复杂细胞类型的比较分析。</p><ul><li>识别两个数据集中存在的单元格类型</li><li>获得在对照和受刺激细胞中都保守的细胞类型标记</li><li>比较数据集以找到刺激的细胞类型特异性反应</li></ul><h5 id="生成Seurat对象"><a href="#生成Seurat对象" class="headerlink" title="生成Seurat对象"></a>生成Seurat对象</h5><p>&emsp;&emsp;基因表达矩阵可以在<a href="https://www.dropbox.com/s/79q6dttg8yl20zg/immune_alignment_expression_matrices.zip?dl=1" target="_blank" rel="noopener">官网提供路径</a>找到。首先读入两个计数矩阵并设置Seurat对象。<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">library(Seurat)</span><br><span class="line">library(cowplot)</span><br><span class="line">ctrl.data &lt;- read.table(<span class="attr">file</span> = <span class="string">"../data/immune_control_expression_matrix.txt.gz"</span>, <span class="attr">sep</span> = <span class="string">"\t"</span>)</span><br><span class="line">stim.data &lt;- read.table(<span class="attr">file</span> = <span class="string">"../data/immune_stimulated_expression_matrix.txt.gz"</span>, <span class="attr">sep</span> = <span class="string">"\t"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up control object</span></span><br><span class="line">ctrl &lt;- CreateSeuratObject(<span class="attr">counts</span> = ctrl.data, <span class="attr">project</span> = <span class="string">"IMMUNE_CTRL"</span>, min.<span class="attr">cells</span> = <span class="number">5</span>)</span><br><span class="line">ctrl$stim &lt;- <span class="string">"CTRL"</span></span><br><span class="line">ctrl &lt;- subset(ctrl, <span class="attr">subset</span> = nFeature_RNA &gt; <span class="number">500</span>)</span><br><span class="line">ctrl &lt;- NormalizeData(ctrl, <span class="attr">verbose</span> = FALSE)</span><br><span class="line">ctrl &lt;- FindVariableFeatures(ctrl, selection.<span class="attr">method</span> = <span class="string">"vst"</span>, <span class="attr">nfeatures</span> = <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up stimulated object</span></span><br><span class="line">stim &lt;- CreateSeuratObject(<span class="attr">counts</span> = stim.data, <span class="attr">project</span> = <span class="string">"IMMUNE_STIM"</span>, min.<span class="attr">cells</span> = <span class="number">5</span>)</span><br><span class="line">stim$stim &lt;- <span class="string">"STIM"</span></span><br><span class="line">stim &lt;- subset(stim, <span class="attr">subset</span> = nFeature_RNA &gt; <span class="number">500</span>)</span><br><span class="line">stim &lt;- NormalizeData(stim, <span class="attr">verbose</span> = FALSE)</span><br><span class="line">stim &lt;- FindVariableFeatures(stim, selection.<span class="attr">method</span> = <span class="string">"vst"</span>, <span class="attr">nfeatures</span> = <span class="number">2000</span>)</span><br></pre></td></tr></table></figure></p><h5 id="运行集成工具"><a href="#运行集成工具" class="headerlink" title="运行集成工具"></a>运行集成工具</h5><p>&emsp;&emsp;然后使用FindIntegrationAnchors函数识别锚点，该函数将Seurat对象列表作为输入，并使用这些锚点将两个数据集集成在一起IntegrateData。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">immune<span class="selector-class">.anchors</span> &lt;- FindIntegrationAnchors(<span class="selector-tag">object</span><span class="selector-class">.list</span> = list(ctrl, stim), dims = <span class="number">1</span>:<span class="number">20</span>)</span><br><span class="line">immune<span class="selector-class">.combined</span> &lt;- IntegrateData(anchorset = immune<span class="selector-class">.anchors</span>, dims = <span class="number">1</span>:<span class="number">20</span>)</span><br></pre></td></tr></table></figure></p><h5 id="综合分析"><a href="#综合分析" class="headerlink" title="综合分析"></a>综合分析</h5><p>&emsp;&emsp;现在可以对所有细胞进行单一的综合分析！<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DefaultAssay(immune.combined) &lt;- <span class="string">"integrated"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Run the standard workflow for visualization and clustering</span></span><br><span class="line">immune.combined &lt;- ScaleData(immune.combined, <span class="attr">verbose</span> = FALSE)</span><br><span class="line">immune.combined &lt;- RunPCA(immune.combined, <span class="attr">npcs</span> = <span class="number">30</span>, <span class="attr">verbose</span> = FALSE)</span><br><span class="line"><span class="comment"># t-SNE and Clustering</span></span><br><span class="line">immune.combined &lt;- RunUMAP(immune.combined, <span class="attr">reduction</span> = <span class="string">"pca"</span>, <span class="attr">dims</span> = <span class="number">1</span>:<span class="number">20</span>)</span><br><span class="line">immune.combined &lt;- FindNeighbors(immune.combined, <span class="attr">reduction</span> = <span class="string">"pca"</span>, <span class="attr">dims</span> = <span class="number">1</span>:<span class="number">20</span>)</span><br><span class="line">immune.combined &lt;- FindClusters(immune.combined, <span class="attr">resolution</span> = <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Visualization</span></span><br><span class="line">p1 &lt;- DimPlot(immune.combined, <span class="attr">reduction</span> = <span class="string">"umap"</span>, group.<span class="attr">by</span> = <span class="string">"stim"</span>)</span><br><span class="line">p2 &lt;- DimPlot(immune.combined, <span class="attr">reduction</span> = <span class="string">"umap"</span>, <span class="attr">label</span> = TRUE)</span><br><span class="line">plot_grid(p1, p2)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6e4539230454d286.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>&emsp;&emsp;为了并排显示这两个条件，可以使用split.by参数来显示由簇着色的每个条件。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">DimPlot</span><span class="params">(immune.combined, reduction = <span class="string">"umap"</span>, split.by = <span class="string">"stim"</span>)</span></span></span><br></pre></td></tr></table></figure></p><h5 id="识别保守的细胞类型标记"><a href="#识别保守的细胞类型标记" class="headerlink" title="识别保守的细胞类型标记"></a>识别保守的细胞类型标记</h5><p>&emsp;&emsp;为了鉴定在条件下保守的经典细胞类型标记基因，提供了该FindConservedMarkers功能。该功能对每个数据集/组执行差异基因表达测试，并使用MetaDE R包中的元分析方法组合p值。例如，可以计算保守标记的基因，而不考虑簇6（NK细胞）中的刺激条件。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">DefaultAssay</span><span class="params">(immune.combined)</span></span> &lt;- <span class="string">"RNA"</span></span><br><span class="line">nk<span class="selector-class">.markers</span> &lt;- FindConservedMarkers(immune<span class="selector-class">.combined</span>, ident.<span class="number">1</span> = <span class="number">7</span>, grouping<span class="selector-class">.var</span> = <span class="string">"stim"</span>, verbose = FALSE)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(nk.markers)</span></span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;可以探索每个簇的这些标记基因，并使用它们来注释我们的簇作为特定的细胞类型。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FeaturePlot(immune<span class="selector-class">.combined</span>, features = c(<span class="string">"CD3D"</span>, <span class="string">"SELL"</span>, <span class="string">"CREM"</span>, <span class="string">"CD8A"</span>, <span class="string">"GNLY"</span>, <span class="string">"CD79A"</span>, <span class="string">"FCGR3A"</span>, </span><br><span class="line">    <span class="string">"CCL2"</span>, <span class="string">"PPBP"</span>), min<span class="selector-class">.cutoff</span> = <span class="string">"q9"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-bf1da1bb7c0f1eb1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">immune.combined &lt;- RenameIdents(immune.combined, `0` = <span class="string">"CD14 Mono"</span>, `1` = <span class="string">"CD4 Naive T"</span>, `2` = <span class="string">"CD4 Memory T"</span>, </span><br><span class="line">    `3` = <span class="string">"CD16 Mono"</span>, `4` = <span class="string">"B"</span>, `5` = <span class="string">"CD8 T"</span>, `6` = <span class="string">"T activated"</span>, `7` = <span class="string">"NK"</span>, `8` = <span class="string">"DC"</span>, `9` = <span class="string">"B Activated"</span>, </span><br><span class="line">    `10` = <span class="string">"Mk"</span>, `11` = <span class="string">"pDC"</span>, `12` = <span class="string">"Eryth"</span>, `13` = <span class="string">"Mono/Mk Doublets"</span>)</span><br><span class="line"></span><br><span class="line">DimPlot(immune.combined, label = <span class="literal">TRUE</span>)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-f4b11fd7096695f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>&emsp;&emsp;DotPlot具有该split.by参数的功能可用于跨条件查看保守细胞类型标记，显示表达水平和表达任何给定基因的簇中细胞的百分比。在这里为13个簇中的每一个绘制2-3个强标记基因。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">Idents</span><span class="params">(immune.combined)</span></span> &lt;- factor(Idents(immune.combined), levels = c(<span class="string">"Mono/Mk Doublets"</span>, <span class="string">"pDC"</span>, </span><br><span class="line">    <span class="string">"Eryth"</span>, <span class="string">"Mk"</span>, <span class="string">"DC"</span>, <span class="string">"CD14 Mono"</span>, <span class="string">"CD16 Mono"</span>, <span class="string">"B Activated"</span>, <span class="string">"B"</span>, <span class="string">"CD8 T"</span>, <span class="string">"NK"</span>, <span class="string">"T activated"</span>, </span><br><span class="line">    <span class="string">"CD4 Naive T"</span>, <span class="string">"CD4 Memory T"</span>))</span><br><span class="line">markers<span class="selector-class">.to</span><span class="selector-class">.plot</span> &lt;- c(<span class="string">"CD3D"</span>, <span class="string">"CREM"</span>, <span class="string">"HSPH1"</span>, <span class="string">"SELL"</span>, <span class="string">"GIMAP5"</span>, <span class="string">"CACYBP"</span>, <span class="string">"GNLY"</span>, <span class="string">"NKG7"</span>, <span class="string">"CCL5"</span>, </span><br><span class="line">    <span class="string">"CD8A"</span>, <span class="string">"MS4A1"</span>, <span class="string">"CD79A"</span>, <span class="string">"MIR155HG"</span>, <span class="string">"NME1"</span>, <span class="string">"FCGR3A"</span>, <span class="string">"VMO1"</span>, <span class="string">"CCL2"</span>, <span class="string">"S100A9"</span>, <span class="string">"HLA-DQA1"</span>, </span><br><span class="line">    <span class="string">"GPR183"</span>, <span class="string">"PPBP"</span>, <span class="string">"GNG11"</span>, <span class="string">"HBA2"</span>, <span class="string">"HBB"</span>, <span class="string">"TSPAN13"</span>, <span class="string">"IL3RA"</span>, <span class="string">"IGJ"</span>)</span><br><span class="line"><span class="function"><span class="title">DotPlot</span><span class="params">(immune.combined, features = rev(markers.to.plot)</span></span>, cols = c(<span class="string">"blue"</span>, <span class="string">"red"</span>), dot<span class="selector-class">.scale</span> = <span class="number">8</span>, </span><br><span class="line">    split<span class="selector-class">.by</span> = <span class="string">"stim"</span>) + RotatedAxis()</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1fd5f2b962abebfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="确定跨条件的差异表达基因"><a href="#确定跨条件的差异表达基因" class="headerlink" title="确定跨条件的差异表达基因"></a>确定跨条件的差异表达基因</h5><p>&emsp;&emsp;现在已经对受刺激细胞和对照细胞进行了比对，可以开始进行比较分析并观察刺激引起的差异。广泛观察这些变化的一种方法是绘制受刺激细胞和对照细胞的平均表达，并在散点图上寻找视觉异常值的基因。在这里，采用受刺激和对照幼稚T细胞和CD14单核细胞群的平均表达并产生散点图，突出表现出对干扰素刺激的显着反应的基因。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">t<span class="selector-class">.cells</span> &lt;- subset(immune<span class="selector-class">.combined</span>, idents = <span class="string">"CD4 Naive T"</span>)</span><br><span class="line"><span class="function"><span class="title">Idents</span><span class="params">(t.cells)</span></span> &lt;- <span class="string">"stim"</span></span><br><span class="line">avg<span class="selector-class">.t</span><span class="selector-class">.cells</span> &lt;- log1p(AverageExpression(t<span class="selector-class">.cells</span>, verbose = FALSE)<span class="variable">$RNA</span>)</span><br><span class="line">avg<span class="selector-class">.t</span><span class="selector-class">.cells</span><span class="variable">$gene</span> &lt;- rownames(avg<span class="selector-class">.t</span><span class="selector-class">.cells</span>)</span><br><span class="line"></span><br><span class="line">cd14<span class="selector-class">.mono</span> &lt;- subset(immune<span class="selector-class">.combined</span>, idents = <span class="string">"CD14 Mono"</span>)</span><br><span class="line"><span class="function"><span class="title">Idents</span><span class="params">(cd14.mono)</span></span> &lt;- <span class="string">"stim"</span></span><br><span class="line">avg<span class="selector-class">.cd14</span><span class="selector-class">.mono</span> &lt;- log1p(AverageExpression(cd14<span class="selector-class">.mono</span>, verbose = FALSE)<span class="variable">$RNA</span>)</span><br><span class="line">avg<span class="selector-class">.cd14</span><span class="selector-class">.mono</span><span class="variable">$gene</span> &lt;- rownames(avg<span class="selector-class">.cd14</span><span class="selector-class">.mono</span>)</span><br><span class="line"></span><br><span class="line">genes<span class="selector-class">.to</span><span class="selector-class">.label</span> = c(<span class="string">"ISG15"</span>, <span class="string">"LY6E"</span>, <span class="string">"IFI6"</span>, <span class="string">"ISG20"</span>, <span class="string">"MX1"</span>, <span class="string">"IFIT2"</span>, <span class="string">"IFIT1"</span>, <span class="string">"CXCL10"</span>, <span class="string">"CCL8"</span>)</span><br><span class="line">p1 &lt;- ggplot(avg<span class="selector-class">.t</span><span class="selector-class">.cells</span>, aes(CTRL, STIM)) + geom_point() + ggtitle(<span class="string">"CD4 Naive T Cells"</span>)</span><br><span class="line">p1 &lt;- LabelPoints(plot = p1, points = genes<span class="selector-class">.to</span><span class="selector-class">.label</span>, repel = TRUE)</span><br><span class="line">p2 &lt;- ggplot(avg<span class="selector-class">.cd14</span><span class="selector-class">.mono</span>, aes(CTRL, STIM)) + geom_point() + ggtitle(<span class="string">"CD14 Monocytes"</span>)</span><br><span class="line">p2 &lt;- LabelPoints(plot = p2, points = genes<span class="selector-class">.to</span><span class="selector-class">.label</span>, repel = TRUE)</span><br><span class="line"><span class="function"><span class="title">plot_grid</span><span class="params">(p1, p2)</span></span></span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-e629fae75a37ab36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>&emsp;&emsp;许多相同的基因在这两种细胞类型中都被上调，并且可能代表一种保守的干扰素应答途径。<br>因为我们有信心在整个条件下鉴定出共同的细胞类型，可以询问在相同类型的细胞的不同条件下哪些基因会发生变化。首先在meta.data插槽中创建一个列，以保存单元格类型和刺激信息，并将当前标识切换到该列。然后FindMarkers用来找到刺激和对照B细胞之间不同的基因。请注意，此处显示的许多顶级基因与我们之前作为核心干扰素应答基因绘制的基因相同。此外，看到的像CXCL10这样的基因对单核细胞和B细胞干扰素反应具有特异性，在该列表中也显示出非常重要的基因。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">immune.combined<span class="variable">$celltype</span><span class="selector-class">.stim</span> &lt;- paste(Idents(immune.combined), immune.combined<span class="variable">$stim</span>, sep = <span class="string">"_"</span>)</span><br><span class="line">immune.combined<span class="variable">$celltype</span> &lt;- Idents(immune.combined)</span><br><span class="line"><span class="function"><span class="title">Idents</span><span class="params">(immune.combined)</span></span> &lt;- <span class="string">"celltype.stim"</span></span><br><span class="line"><span class="selector-tag">b</span><span class="selector-class">.interferon</span><span class="selector-class">.response</span> &lt;- FindMarkers(immune<span class="selector-class">.combined</span>, ident.<span class="number">1</span> = <span class="string">"B_STIM"</span>, ident.<span class="number">2</span> = <span class="string">"B_CTRL"</span>, verbose = FALSE)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(b.interferon.response, n = <span class="number">15</span>)</span></span></span><br></pre></td></tr></table></figure></p><p>&emsp;&emsp;另一种可视化基因表达变化的有用方法是split.by选择FeaturePlot或VlnPlot功能。这将显示给定基因列表的FeaturePlots，由分组变量（这里的刺激条件）分开。诸如CD3D和GNLY的基因是规范细胞类型标记（对于T细胞和NK / CD8T细胞），其实际上不受干扰素刺激的影响并且在对照和刺激组中显示相似的基因表达模式。另一方面，IFI6和ISG15是核心干扰素应答基因，并且在所有细胞类型中相应地上调。最后，CD14和CXCL10是显示细胞类型特异性干扰素应答的基因。CD14单核细胞刺激后CD14表达降低，这可能导致监督分析框架中的错误分类，强调综合分析的价值。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">FeaturePlot</span><span class="params">(immune.combined, features = c(<span class="string">"CD3D"</span>, <span class="string">"GNLY"</span>, <span class="string">"IFI6"</span>)</span></span>, split<span class="selector-class">.by</span> = <span class="string">"stim"</span>, max<span class="selector-class">.cutoff</span> = <span class="number">3</span>, </span><br><span class="line">    cols = c(<span class="string">"grey"</span>, <span class="string">"red"</span>))</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-21d8648736861471.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plots &lt;- VlnPlot(immune<span class="selector-class">.combined</span>, features = c(<span class="string">"LYZ"</span>, <span class="string">"ISG15"</span>, <span class="string">"CXCL10"</span>), split<span class="selector-class">.by</span> = <span class="string">"stim"</span>, group<span class="selector-class">.by</span> = <span class="string">"celltype"</span>, </span><br><span class="line">    pt<span class="selector-class">.size</span> = <span class="number">0</span>, combine = FALSE)</span><br><span class="line"><span class="function"><span class="title">CombinePlots</span><span class="params">(plots = plots, ncol = <span class="number">1</span>)</span></span></span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-136f5d79488520e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>参考材料：<br><a href="https://satijalab.org/seurat/v3.0/immune_alignment.html" target="_blank" rel="noopener">https://satijalab.org/seurat/v3.0/immune_alignment.html</a></p><p>&emsp;&emsp;关注微信公众号，第一时间获取更新</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c23c58a787207a24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;目前单细胞数据分析有不少的挑战，比如稀疏矩阵，超高维度数据降维，批次效应校正，聚类算法的选择，多组学数据整合等挑战。
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>单细胞分析利器-SeuratV3简介及实操</title>
    <link href="http://liuyang0681.github.io/2019/05/17/%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E5%88%A9%E5%99%A8-SeuratV3%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%9E%E6%93%8D/"/>
    <id>http://liuyang0681.github.io/2019/05/17/单细胞分析利器-SeuratV3简介及实操/</id>
    <published>2019-05-17T15:31:13.000Z</published>
    <updated>2019-05-17T15:36:08.246Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Seurat简介"><a href="#Seurat简介" class="headerlink" title="Seurat简介"></a>Seurat简介</h4><p>&emsp;&emsp;<a href="https://satijalab.org/seurat/" target="_blank" rel="noopener">Seurat</a>—几乎是当前单细胞RNA-seq分析领域的不可或缺的工具，特别是基于10X公司的cellrange流程得出的结果，可以方便的对接到Seurat工具中进行后续处理，简直是带给迷茫在单细胞数据荒漠中小白的一眼清泉，相对全面的功能，简洁的操作命令，如丝般顺滑。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-064defa79c5a01a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="seurat官网界面"></p><h4 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h4><p>&emsp;&emsp;Seurat目前最新版为V3，第一版是为处理空间转录组而设计，第二版针对基因droplet的单细胞技术而开发的用于单细胞质控，降维，聚类，鉴定细胞类型marker等多重功能，目前更新的第三版可以整合多组学，多批次，多实验方法的数据，把握了后续数据分析需要多组学整合的热点策略，符合下一步分析思路更全面，生物学解释更透彻的科研需求。<br>以下为Seurat更新的记录：<br><strong>2019年4月16日</strong>发布3.0版<br><strong>2018年11月2日</strong>版本3.0 alpha发布</p><ul><li>发布的预印本描述了在单细胞数据集中识别“锚点”的新方法<br><strong>2018年3月23日</strong> 2.3版本发布</li><li>提高速度和内存效率</li><li>用于分析来自Microwell-seq Mouse Cell Atlas数据集的~250,000个细胞的新视图<br><strong>2018年1月10日：</strong> 2.2版本发布</li><li>支持多数据集对齐</li><li>评估对齐性能的新方法<br><strong>2017年10月16日：</strong> 2.1版发布</li><li>支持多模式单细胞数据</li><li>支持用于差异表达式测试的MAST和DESeq2包<br><strong>2017年7月26日：</strong> 2.0版本发布</li><li>发布预印本用于scRNA-seq数据集的综合分析</li><li>数据集集成，可视化和探索的新方法</li><li>对代码库进行重大重组，以强调清晰度和清晰的文档<br><strong>2016年10月4日：</strong> 1.4版本发布</li><li>为UMI计数数据添加了负二项回归和差分表达式测试的方法</li><li>合并和下采样Seurat对象的新方法<br><strong>2016年8月22日：</strong> 1.3版本发布</li><li>改进的聚类方法 - 有关详细信息，请参阅FAQ</li><li>所有函数都支持稀疏矩阵</li><li>消除不需要的变异来源的方法</li><li>一致的函数名称</li><li>更新的可视化<br><strong>2015年5月21日：</strong> <a href="http://www.cell.com/cell/abstract/S0092-8674(15" target="_blank" rel="noopener">Drop-Seq手稿</a>00549-8)发布。版本1.2发布</li><li>增加了对光谱t-SNE（非线性降维）和密度聚类的支持</li><li>新的可视化 - 包括pcHeatmap，dot.plot和feature.plot</li><li>扩展包文档，减少导入包负担</li><li>Seurat代码现在托管在GitHub上，可以通过devtools包轻松安装</li><li>小错误修复<br><strong>2015年4月13日：</strong> <a href="http://www.nature.com/nbt/journal/vaop/ncurrent/full/nbt.3192.html" target="_blank" rel="noopener">空间映射手稿</a>发布。版本1.1发布<h4 id="Seurat安装"><a href="#Seurat安装" class="headerlink" title="Seurat安装"></a>Seurat安装</h4>直接在CRAN加载安装<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Enter commands <span class="keyword">in</span> R (<span class="keyword">or</span> R studio, <span class="keyword">if</span> installed)</span><br><span class="line">install.packages(<span class="string">'Seurat'</span>)</span><br><span class="line"><span class="keyword">library</span>(Seurat)</span><br></pre></td></tr></table></figure></li></ul><p>同时SeuratV3支持使用UMAP算法进行降维聚类可视化，需要配置对应的pythonUMAP环境，方可执行UMAP对应功能。</p><h4 id="Seurat分析单细胞RNA-seq数据"><a href="#Seurat分析单细胞RNA-seq数据" class="headerlink" title="Seurat分析单细胞RNA-seq数据"></a>Seurat分析单细胞RNA-seq数据</h4><p>官网提供了基于10X公司的PBMC样本的数据作为示范；<br>首先读入实例数据，利用Read10X函数读取<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger" target="_blank" rel="noopener">cellranger</a>流程的输出文件，返回唯一的分子识别（UMI）计数矩阵。该矩阵中的值表示在每个细胞（列）中检测到的每个特征（即基因;行）的分子数。然后使用计数矩阵来创建一个<code>Seurat</code>对象。该对象充当容器，其包含单细胞数据集的数据（如计数矩阵）和分析（如PCA或聚类结果）<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(dplyr)</span><br><span class="line">library(<span class="type">Seurat</span>)</span><br><span class="line">setwd(<span class="string">"/Users/liuyang/Downloads/03project/02scRNA/10X_Seurat"</span>)</span><br><span class="line">rm(list = ls())</span><br><span class="line"></span><br><span class="line"># <span class="type">Load</span> the <span class="type">PBMC</span> dataset</span><br><span class="line">pbmc.data &lt;- <span class="type">Read10X</span>(data.dir = <span class="string">"/Users/liuyang/Downloads/03project/02scRNA/10X_Seurat/filtered_gene_bc_matrices/hg19/"</span>)</span><br><span class="line"># <span class="type">Initialize</span> the <span class="type">Seurat</span> <span class="class"><span class="keyword">object</span> <span class="keyword">with</span> <span class="title">the</span> <span class="title">raw</span> (<span class="params">non-normalized data</span>).</span></span><br><span class="line"><span class="class"><span class="title">pbmc</span> <span class="title">&lt;-</span> <span class="title">CreateSeuratObject</span>(<span class="params">counts = pbmc.data, project = "pbmc3k", min.cells = 3, min.features = 200</span>)</span></span><br><span class="line"><span class="class"><span class="title">pbmc</span></span></span><br></pre></td></tr></table></figure></p><p> 标准的预处理工作流程基于QC指标，数据标准化和缩放以及高度可变特征的检测来选择和过滤细胞。  </p><h6 id="QC并选择细胞进行进一步分析"><a href="#QC并选择细胞进行进一步分析" class="headerlink" title="QC并选择细胞进行进一步分析"></a>QC并选择细胞进行进一步分析</h6><p>Seurat允许用户根据自己定义的标准轻松探索QC指标和过滤单元格。<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4758103/" target="_blank" rel="noopener">常用</a>的一些QC指标包括</p><ul><li>在每个细胞中检测到的独特基因的数量。</li><li>低质量细胞或空液滴通常只有很少的基因</li><li>细胞双峰或多重峰可能表现出异常高的基因计数</li><li>同样，细胞内检测到的分子总数（与独特基因强烈相关）</li><li>映射到线粒体基因组的读数百分比（对于已经组装到染色体水平或有线粒体基因组的样本）</li><li>低质量/垂死细胞通常表现出广泛的线粒体污染</li><li>我们使用<code>PercentageFeatureSet</code>函数计算线粒体QC指标，该函数计算源自一组特征的计数百分比</li><li>我们使用所有基因<code>MT-</code>集作为一组线粒体基因<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pbmc[[<span class="string">"percent.mt"</span>]] &lt;- PercentageFeatureSet(<span class="attr">object</span> = pbmc, <span class="attr">pattern</span> = <span class="string">"^MT-"</span>)</span><br><span class="line">VlnPlot(<span class="attr">object</span> = pbmc, <span class="attr">features</span> = c(<span class="string">"nFeature_RNA"</span>, <span class="string">"nCount_RNA"</span>, <span class="string">"percent.mt"</span>), <span class="attr">ncol</span> = <span class="number">3</span>)</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/6732709-69e47ddfed80a2c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="质控"><br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FeatureScatter is typically used to visualize feature-feature relationships, but can be used for anything calculated by</span></span><br><span class="line"><span class="comment"># the object, i.e. columns in object metadata, PC scores etc.</span></span><br><span class="line"></span><br><span class="line">plot1 &lt;- FeatureScatter(<span class="attr">object</span> = pbmc, <span class="attr">feature1</span> = <span class="string">"nCount_RNA"</span>, <span class="attr">feature2</span> = <span class="string">"percent.mt"</span>)</span><br><span class="line">plot2 &lt;- FeatureScatter(<span class="attr">object</span> = pbmc, <span class="attr">feature1</span> = <span class="string">"nCount_RNA"</span>, <span class="attr">feature2</span> = <span class="string">"nFeature_RNA"</span>)</span><br><span class="line">CombinePlots(<span class="attr">plots</span> = list(plot1, plot2))</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-3107dd9f6805fa2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="feature-feature relationships"></p><h6 id="标准化数据"><a href="#标准化数据" class="headerlink" title="标准化数据"></a>标准化数据</h6><p>从数据集中删除不需要的单元格后，下一步是标准化数据。默认情况下，采用全局缩放规范化方法<code>LogNormalize</code>，通过总表达式对每个单元格的要素表达式度量进行标准化，将其乘以比例因子（默认为10,000），并对结果进行对数转换。归一化值存储在pbmc[[“RNA”]]@data。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbmc &lt;- NormalizeData(<span class="selector-tag">object</span> = pbmc, normalization<span class="selector-class">.method</span> = <span class="string">"LogNormalize"</span>, scale<span class="selector-class">.factor</span> = <span class="number">10000</span>)</span><br></pre></td></tr></table></figure></p><h6 id="识别高度可变的特征（特征选择）"><a href="#识别高度可变的特征（特征选择）" class="headerlink" title="识别高度可变的特征（特征选择）"></a>识别高度可变的特征（特征选择）</h6><p>然后计算在数据集中表现出高细胞间差异的特征子集（即，它们在一些细胞中高度表达，而在其他细胞中低表达）。作者和<a href="https://www.nature.com/articles/nmeth.2645" target="_blank" rel="noopener">其他人研究者</a>发现，在下游分析中关注这些基因有助于突出单细胞数据集中的生物信号。</p><p><a href="https://www.biorxiv.org/content/early/2018/11/02/460147.full.pdf" target="_blank" rel="noopener">这里</a>详细描述了SeuratV3中的程序，并通过直接建模单细胞数据中固有的均值 - 方差关系对先前版本进行了改进，并在<code>FindVariableFeatures</code>函数中实现。默认情况下，为每个数据集返回2,000个要素。这些将用于下游分析，如PCA。</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pbmc &lt;- FindVariableFeatures(<span class="name">object</span> = pbmc, selection.method = <span class="string">"vst"</span>, nfeatures = <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line"># Identify the <span class="number">10</span> most highly variable genes</span><br><span class="line">top10 &lt;- head(<span class="name">x</span> = VariableFeatures(<span class="name">object</span> = pbmc), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"># plot variable features with and without labels</span><br><span class="line">plot1 &lt;- VariableFeaturePlot(<span class="name">object</span> = pbmc)</span><br><span class="line">plot2 &lt;- LabelPoints(<span class="name">plot</span> = plot1, points = top10, repel = TRUE)</span><br><span class="line">CombinePlots(<span class="name">plots</span> = list(<span class="name">plot1</span>, plot2))</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c7818cf94b25d522.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="特征选择"></p><h6 id="缩放数据"><a href="#缩放数据" class="headerlink" title="缩放数据"></a>缩放数据</h6><p>接下来，应用线性变换（’缩放’），这是在PCA等降维技术之前的标准预处理步骤。该ScaleData函数：<br>改变每个基因的表达，使得跨细胞的平均表达为0<br>缩放每个基因的表达，以便跨细胞的方差为1<br>该步骤在下游分析中给予相同的权重，因此高表达的基因不占优势结果存储在 pbmc[[“RNA”]]@scale.data</p><h6 id="执行线性降维聚类"><a href="#执行线性降维聚类" class="headerlink" title="执行线性降维聚类"></a>执行线性降维聚类</h6><p>对缩放数据执行PCA。默认情况下，只有先前确定的变量要素用作输入，但features如果要选择其他子集，则可以使用参数定义。<br>瑟拉提供定义可视化细胞和功能的几种有用的方式PCA，包括VizDimReduction，DimPlot，和DimHeatmap</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">VizDimLoadings</span><span class="params">(object = pbmc, dims = <span class="number">1</span>:<span class="number">2</span>, reduction = <span class="string">"pca"</span>)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DimPlot</span><span class="params">(object = pbmc, reduction = <span class="string">"pca"</span>)</span></span></span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/6732709-90db5c2803cde678.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PC"><br>特别是DimHeatmap允许容易地探索数据集中的异质性的主要来源，并且在试图决定包括哪些PC以用于进一步的下游分析时可以是有用的。细胞和特征都根据其PCA分数排序。设置cells为数字可以绘制光谱两端的“极端”单元格，从而大大加快了大型数据集的绘图速度。虽然显然是一种监督分析，但我们发现这是探索相关特征集的有用工具。<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DimHeatmap<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">dims</span> = 1, <span class="attr">cells</span> = 500, <span class="attr">balanced</span> = TRUE)</span></span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-9a3d81a11131517e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PC热图"></p><h6 id="确定数据集的“维度”"><a href="#确定数据集的“维度”" class="headerlink" title="确定数据集的“维度”"></a>确定数据集的“维度”</h6><p>为了克服scRNA-seq数据的任何单一特征中的广泛技术噪声，Seurat基于其PCA分数对细胞进行聚类，每个PC基本上代表在相关特征集中组合信息的“元特征”。因此，顶部主要组件表示数据集的强大压缩。但是，我们应该选择包含多少个组件？10？20？100？在<a href="http://www.cell.com/abstract/S0092-8674(15" target="_blank" rel="noopener">Macosko <em>等</em></a>00549-8)人中，实施了一项受JackStraw程序启发的重采样测试。我们随机置换数据的子集（默认为1％）并重新运行PCA，构建特征分数的“空分布”，并重复此过程。我们将“重要”PC识别为具有低p值特征的强大丰富的PC。<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> This process can take a long time for big datasets, comment out for expediency. More approximate techniques such</span></span><br><span class="line"><span class="comment"># as those implemented in ElbowPlot() can be used to reduce computation time</span></span><br><span class="line">pbmc &lt;- JackStraw<span class="params">(<span class="attr">object</span> = pbmc, num.<span class="attr">replicate</span> = 100)</span></span><br><span class="line">pbmc &lt;- ScoreJackStraw<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">dims</span> = 1:20)</span></span><br></pre></td></tr></table></figure></p><p>该JackStrawPlot功能提供了一种可视化工具，用于比较每台PC的p值分布和均匀分布（虚线）。“重要的”PC将显示具有低p值的特征的强烈丰富（虚线上方的实线）。在这种情况下，看起来在前10-12PC之后，重要性急剧下降。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">JackStrawPlot</span><span class="params">(object = pbmc, dims = <span class="number">1</span>:<span class="number">15</span>)</span></span></span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-59f03bf39abda438.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="JackStrawPlot"><br>另一种启发式方法生成“肘图”：基于每个（ElbowPlot函数）解释的方差百分比对主成分进行排序。在这个例子中，我们可以观察PC9-10周围的“肘部”，这表明大多数真实信号都是在前10台PC中捕获的。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">ElbowPlot</span><span class="params">(object = pbmc)</span></span></span><br></pre></td></tr></table></figure></p><p>识别数据集的真实维度 - 对用户来说可能具有挑战性/不确定性。因此，我们建议考虑这三种方法。第一个是更多的监督，探索PC以确定异质性的相关来源，并且可以与GSEA一起使用。第二个实现基于随机空模型的统计测试，但对于大型数据集来说是耗时的，并且可能不会返回明确的PC截止。第三种是常用的启发式算法，可以立即计算。在这个例子中，所有三种方法产生了类似的结果，但我们可能有理由在PC 7-12之间选择任何作为截止值的东西。<br>我们在这里选择了10，但鼓励用户考虑以下内容：<br>树突细胞和NK爱好者可以认识到与PC12和13强烈相关的基因定义了罕见的免疫亚群（即MZB1是浆细胞样DC的标记）。然而，这些组是如此罕见，如果没有先验知识，很难将这种大小的数据集与背景噪声区分开来。<br>我们鼓励用户使用不同数量的PC（10,15甚至50！）重复下游分析。正如您将观察到的，结果通常没有显着差异。<br>在选择此参数时，我们建议用户在较高的一侧犯错。例如，仅使用5台PC进行下游分析确实会对结果造成严重影响。</p><h6 id="聚类细胞"><a href="#聚类细胞" class="headerlink" title="聚类细胞"></a>聚类细胞</h6><p>Seurat v3采用基于图形的聚类方法，建立在（<a href="http://www.cell.com/abstract/S0092-8674(15" target="_blank" rel="noopener">Macosko <em>等人</em></a>00549-8)）的初始策略<a href="http://www.cell.com/abstract/S0092-8674(15" target="_blank" rel="noopener">之上</a>00549-8)。重要的是，驱动聚类分析的<em>距离度量</em>（基于先前识别的PC）保持不变。然而，我们将细胞距离矩阵分成簇的方法已经大大改进。我们的方法受到最近手稿的启发，这些手稿将基于图形的聚类方法应用于scRNA-seq数据<a href="http://bioinformatics.oxfordjournals.org/content/early/2015/02/10/bioinformatics.btv088.abstract" target="_blank" rel="noopener">[SNN-Cliq，Xu和Su，Bioinformatics，2015]</a>和CyTOF数据<a href="http://www.ncbi.nlm.nih.gov/pubmed/26095251" target="_blank" rel="noopener">[PhenoGraph，Levine <em>等</em>，Cell，2015]</a>。简而言之，这些方法将单元格嵌入图形结构中 - 例如K-最近邻（KNN）图形，在具有相似特征表达模式的单元格之间绘制边缘，然后尝试将此图形划分为高度互连的“准集团”或“社区”。<br>与PhenoGraph一样，我们首先根据PCA空间中的欧氏距离构建KNN图，并根据其局部邻域中的共享重叠（Jaccard相似性）细化任意两个单元之间的边权重。使用该<code>FindNeighbors</code>函数执行该步骤，并将先前定义的数据集维度（前10个PC）作为输入。<br>为了聚类细胞，我们接下来应用模块化优化技术，例如Louvain算法（默认）或SLM <a href="http://dx.doi.org/10.1088/1742-5468/2008/10/P10008" target="_blank" rel="noopener">[SLM，Blondel <em>等</em>，Journal of Statistical Mechanics]</a>，将细胞迭代分组在一起，目的是优化标准模块化功能。该<code>FindClusters</code>函数实现此过程，并包含一个分辨率参数，用于设置下游群集的“粒度”，增加的值会导致更多的群集。我们发现将此参数设置在0.4-1.2之间通常会返回大约3K单元格的单细胞数据集的良好结果。较大的数据集通常会增加最佳分辨率。可以使用该<code>Idents</code>功能找到群集。<br><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">pbmc <span class="tag">&lt;<span class="name">-</span> <span class="attr">FindNeighbors</span>(<span class="attr">object</span> = <span class="string">pbmc,</span> <span class="attr">dims</span> = <span class="string">1:10)</span></span></span></span><br><span class="line"><span class="xml">pbmc <span class="tag">&lt;<span class="name">-</span> <span class="attr">FindClusters</span>(<span class="attr">object</span> = <span class="string">pbmc,</span> <span class="attr">resolution</span> = <span class="string">0.5)</span></span></span></span><br></pre></td></tr></table></figure></p><h6 id="运行非线性降维（UMAP-tSNE）"><a href="#运行非线性降维（UMAP-tSNE）" class="headerlink" title="运行非线性降维（UMAP / tSNE）"></a>运行非线性降维（UMAP / tSNE）</h6><p>Seurat提供了几种非线性降维技术，如tSNE和UMAP，可视化和探索这些数据集。这些算法的目标是学习数据的基础流形，以便在低维空间中将相似的单元放在一起。上面确定的基于图的聚类内的单元应该共同定位这些降维图。作为UMAP和tSNE的输入，我们建议使用相同的PC作为聚类分析的输入。<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># If you haven't installed UMAP, you can do so via reticulate::py_install(packages = 'umap-learn')</span></span><br><span class="line">pbmc &lt;- RunUMAP(<span class="attr">object</span> = pbmc, <span class="attr">dims</span> = <span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line"><span class="comment"># note that you can set `label = TRUE` or use the LabelClusters function to help label individual clusters</span></span><br><span class="line">DimPlot(<span class="attr">object</span> = pbmc, <span class="attr">reduction</span> = <span class="string">"umap"</span>)</span><br></pre></td></tr></table></figure></p><h6 id="寻找差异表达的特征（聚类生物标志物）"><a href="#寻找差异表达的特征（聚类生物标志物）" class="headerlink" title="寻找差异表达的特征（聚类生物标志物）"></a>寻找差异表达的特征（聚类生物标志物）</h6><p>Seurat可以帮助您找到通过差异表达定义聚类的标记。默认情况下，它标识单个群集（指定ident.1）的正负标记，与所有其他单元格进行比较。FindAllMarkers为所有群集自动执行此过程，但您也可以测试群集彼此之间或所有单元格。<br>该min.pct论证要求在两组单元中的任一组中以最小百分比检测特征，并且thresh.test参数要求在两组之间以一定量差异地表示（平均）特征。您可以将这两个设置为0，但时间会急剧增加 - 因为这将测试大量不太可能具有高度歧视性的功能。作为加速这些计算的另一种选择，max.cells.per.ident可以设置。这将对每个标识类进行下采样，使其不再具有比设置的更多的单元格。虽然通常会出现功率损失，但速度增加可能是显着的，并且最高度差异表达的功能可能仍然会升至顶部。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cluster1<span class="selector-class">.markers</span> &lt;- FindMarkers(<span class="selector-tag">object</span> = pbmc, ident.<span class="number">1</span> = <span class="number">1</span>, min<span class="selector-class">.pct</span> = <span class="number">0.25</span>)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(x = cluster1.markers, n = <span class="number">5</span>)</span></span></span><br></pre></td></tr></table></figure></p><p>Seurat有几个差分表达式测试，可以使用test.use参数设置<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cluster1<span class="selector-class">.markers</span> &lt;- FindMarkers(<span class="selector-tag">object</span> = pbmc, ident.<span class="number">1</span> = <span class="number">0</span>, logfc<span class="selector-class">.threshold</span> = <span class="number">0.25</span>, test<span class="selector-class">.use</span> = <span class="string">"roc"</span>, only<span class="selector-class">.pos</span> = TRUE)</span><br></pre></td></tr></table></figure></p><p>我们提供了几种用于可视化标记表达的工具。VlnPlot（显示跨群集的表达概率分布），以及FeaturePlot（在tSNE或PCA图上可视化特征表达）是我们最常用的可视化。我们还建议您探索RidgePlot，CellScatter以及DotPlot查看数据集的其他方法。<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VlnPlot(<span class="name">object</span> = pbmc, features = c(<span class="string">"MS4A1"</span>, <span class="string">"CD79A"</span>))</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-1e9de3d631af043c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="小提琴图"><br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FeaturePlot(<span class="name">object</span> = pbmc, features = c(<span class="string">"MS4A1"</span>, <span class="string">"GNLY"</span>, <span class="string">"CD3E"</span>, <span class="string">"CD14"</span>, <span class="string">"FCER1A"</span>, <span class="string">"FCGR3A"</span>, <span class="string">"LYZ"</span>, <span class="string">"PPBP"</span>, <span class="string">"CD8A"</span>))</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-7e6116c15df5c490.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="特征图"><br>DoHeatmap为给定的单元格和要素生成表达式热图。在这种情况下，我们正在为每个群集绘制前20个标记（或所有标记，如果小于20）。<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">top10 &lt;- pbmc.markers %&gt;% group_by<span class="params">(cluster)</span> %&gt;% top_n<span class="params">(<span class="attr">n</span> = 10, <span class="attr">wt</span> = avg_logFC)</span></span><br><span class="line">DoHeatmap<span class="params">(<span class="attr">object</span> = pbmc, <span class="attr">features</span> = top10$gene)</span> + NoLegend<span class="params">()</span></span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-d5764633333f1552.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="热图"></p><h6 id="将单元类型标识分配给集群"><a href="#将单元类型标识分配给集群" class="headerlink" title="将单元类型标识分配给集群"></a>将单元类型标识分配给集群</h6><p>根据每个类群中高表达的特异基因，我们可以利用已知细胞类型特定的标记基因，对每个类群确定细胞类型。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">new<span class="selector-class">.cluster</span><span class="selector-class">.ids</span> &lt;- c(<span class="string">"Memory CD4 T"</span>, <span class="string">"CD14+ Mono"</span>, <span class="string">"Naive CD4 T"</span>, <span class="string">"B"</span>, <span class="string">"CD8 T"</span>, <span class="string">"FCGR3A+ Mono"</span>, <span class="string">"NK"</span>, <span class="string">"DC"</span>, <span class="string">"Mk"</span>)</span><br><span class="line"><span class="function"><span class="title">names</span><span class="params">(x = new.cluster.ids)</span></span> &lt;- levels(x = pbmc)</span><br><span class="line">pbmc &lt;- RenameIdents(<span class="selector-tag">object</span> = pbmc, new<span class="selector-class">.cluster</span><span class="selector-class">.ids</span>)</span><br><span class="line"><span class="function"><span class="title">DimPlot</span><span class="params">(object = pbmc, reduction = <span class="string">"umap"</span>, label = TRUE, pt.size = <span class="number">0.5</span>)</span></span> + NoLegend()</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-326cb37f3fd9475a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="定细胞类型"></p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p><a href="https://satijalab.org/seurat/" target="_blank" rel="noopener">https://satijalab.org/seurat/</a></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-bb82ed2df2373dcd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公众号首发平台"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;Seurat简介&quot;&gt;&lt;a href=&quot;#Seurat简介&quot; class=&quot;headerlink&quot; title=&quot;Seurat简介&quot;&gt;&lt;/a&gt;Seurat简介&lt;/h4&gt;&lt;p&gt;&amp;emsp;&amp;emsp;&lt;a href=&quot;https://satijalab.org/seu
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>CR-单细胞水平研究人类睾丸细胞图谱</title>
    <link href="http://liuyang0681.github.io/2019/05/14/CR-%E5%8D%95%E7%BB%86%E8%83%9E%E6%B0%B4%E5%B9%B3%E7%A0%94%E7%A9%B6%E4%BA%BA%E7%B1%BB%E7%9D%BE%E4%B8%B8%E7%BB%86%E8%83%9E%E5%9B%BE%E8%B0%B1/"/>
    <id>http://liuyang0681.github.io/2019/05/14/CR-单细胞水平研究人类睾丸细胞图谱/</id>
    <published>2019-05-14T09:26:39.000Z</published>
    <updated>2019-05-14T09:28:05.652Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题：The Neonatal <span class="built_in">and</span> Adult Human Testis Defined at the Single-<span class="built_in">Cell</span> Level</span><br><span class="line">期刊：<span class="built_in">Cell</span> reports</span><br><span class="line">日期：FEBRUARY <span class="number">05</span>, <span class="number">2019</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这篇文章算是比较中规中矩的单细胞研究某一器官图谱的文章形式，文章的亮点主要包括1）通过scRNA-seq分析定义新生儿和成人睾丸细胞亚群；2）新生儿包含原始生殖细胞和SSC样细胞；3）定义了具有不同标记的许多成体精原细胞状态；4）定义了新生儿和成人睾丸“生态位”细胞和因子。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a691d8ecf4c69416.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文章框架"><br>&emsp;&emsp;文章通讯作者Miles Wilkinson, Ph.D.加利福尼亚大学圣地亚哥分校妇产科和生殖科学系教授，研究领域包括：</p><ul><li>RNA</li><li>Stem cell biology</li><li>Epigenetics</li><li>Reproductive biology</li><li>Developmental biology</li><li>Neurobiology </li><li>Cancer<br>等方向，集中在基因调控回路对正常发育和疾病的影响。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-14818d015f87375c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PI"></li></ul><p>&emsp;&emsp;文章使用10X公司scRNA-seq来分析成人新生儿睾丸中的所有细胞，来定义所有主要的精子和体细胞亚群。通过比较新生儿和成人睾丸细胞的基因表达变化情况，描述了精子发生的时间序列等，整体的结果描述了人类睾丸组织精子细胞及体细胞的细胞发育图谱。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-43a0e410083abf88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="单细胞分群"><br>文章分析很常规，原始数据利用10X公司提供的cellranger流程处理，得到matrix，后续分析采用Seurat包完成质控，降维聚类等分析，睾丸单细胞分群情况，共分为7群，其中比较大的SPG群，后续又对这个细胞群进行亚群分析，鉴定发现了一些新的细胞亚型。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-1ec4736bba5b2531.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="亚群"><br>对于分化发育等细胞，可以利用monocle包进行时间序列分析。根据基因表达情况推测细胞当前所处的每个分化阶段位置。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-4308e2c25560a0a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="时序分析"><br>鉴定描述新发现的SPG细胞亚型<br><img src="https://upload-images.jianshu.io/upload_images/6732709-e5953dd173fdf9a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="鉴定描述新发现的SPG细胞亚型"><br>鉴定描述新发现的SPG细胞标记<br><img src="https://upload-images.jianshu.io/upload_images/6732709-16365fbca6086fbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="鉴定描述新发现的SPG细胞标记"><br>人类睾丸中体细胞群的表征<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a45603798c2dfcd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="人类睾丸中体细胞群的表征"><br>人类睾丸中的受体 - 配体信号相互作用<br><img src="https://upload-images.jianshu.io/upload_images/6732709-8da565d7ab76fb32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="人类睾丸中的受体 - 配体信号相互作用"><br>人类雄性配子发生模型和新生儿信号<br><img src="https://upload-images.jianshu.io/upload_images/6732709-060e3a4a6386fef8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="人类雄性配子发生模型和新生儿信号"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight excel&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
    
  </entry>
  
  <entry>
    <title>R-按照行名或列名删除对应的行列</title>
    <link href="http://liuyang0681.github.io/2019/04/28/R-%E6%8C%89%E7%85%A7%E8%A1%8C%E5%90%8D%E6%88%96%E5%88%97%E5%90%8D%E5%88%A0%E9%99%A4%E5%AF%B9%E5%BA%94%E7%9A%84%E8%A1%8C%E5%88%97/"/>
    <id>http://liuyang0681.github.io/2019/04/28/R-按照行名或列名删除对应的行列/</id>
    <published>2019-04-28T15:02:18.000Z</published>
    <updated>2019-04-28T15:03:09.498Z</updated>
    
    <content type="html"><![CDATA[<h5 id="项目需求"><a href="#项目需求" class="headerlink" title="项目需求"></a>项目需求</h5><p>&emsp;&emsp;近期在处理单细胞项目数据，想对基因和read数构成的矩阵文件做进一步的处理，比如删除一些指定基因，删除一些指定细胞，查了一些材料并没发现合适的解决方案，所以有必要遂基于参考材料在具体描述一下这类数据处理方法。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#常规删除行列数据</span></span><br><span class="line">dataly&lt;- data.frame(<span class="attribute">a</span>=1:2, <span class="attribute">b</span>=2:3, <span class="attribute">c</span>=3:4, <span class="attribute">d</span>=4:5,e=5:6)</span><br><span class="line">rownames(dataly)&lt;- c(<span class="string">"m"</span>,<span class="string">"n"</span>)</span><br><span class="line">dataly</span><br><span class="line">a b c d e</span><br><span class="line">m 1 2 3 4 5</span><br><span class="line">n 2 3 4 5 6</span><br><span class="line"><span class="comment">#删除第一行</span></span><br><span class="line">dataly1&lt;- dataly[-1,]</span><br><span class="line"><span class="comment">#删除第三列</span></span><br><span class="line">dataly2&lt;- dataly[,-3]</span><br></pre></td></tr></table></figure></p><h5 id="积极实践"><a href="#积极实践" class="headerlink" title="积极实践"></a>积极实践</h5><p> &emsp;&emsp;这种对于小样本来说处理比较方便，但是对于单细胞海量数据，这种处理方式显然是行不通的。特别是删除指定的基因或者细胞，对于具体所处的行列也不明确。比较直接的方式是直接根据行或者列的名字，直接匹配删除。接下来介绍一些基于这种类型数据的处理方式。<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dataly</span><br><span class="line">a b c d e</span><br><span class="line">m <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line">n <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line">#删除b,d列的处理方式,-which 可以用！代替</span><br><span class="line">dataly[ , -which(colnames(dataly) %in% c(<span class="string">"b"</span>,<span class="string">"d"</span>))]</span><br><span class="line">  a c e</span><br><span class="line">m <span class="number">1</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line">n <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line">dataly[ , !colnames(dataly) %in% c(<span class="string">"b"</span>,<span class="string">"d"</span>)]</span><br><span class="line">#删除n行的处理方式</span><br><span class="line">dataly[!rownames(dataly) %in% c(<span class="string">"n"</span>) , ]</span><br><span class="line">  a b c d e</span><br><span class="line">m <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br></pre></td></tr></table></figure></p><h5 id="他山之石"><a href="#他山之石" class="headerlink" title="他山之石"></a>他山之石</h5><p>谷歌一下发现还有不少解决方案，个人比较喜欢这个。</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#数据生成</span><br><span class="line">X&lt;-data.frame(A=c(<span class="number">1</span>,<span class="number">2</span>),B=c(<span class="number">3</span>,<span class="number">4</span>),C=c(<span class="number">5</span>,<span class="number">6</span>))</span><br><span class="line">X</span><br><span class="line">  A B C</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line">#如果我想删除一个列，比如B，只需在colnames上使用grep来获取列索引，然后可以使用该索引来省略列。</span><br><span class="line">X[,-grep(<span class="string">"B"</span>,colnames(X))]</span><br><span class="line">  A C</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">6</span></span><br><span class="line">#grep的优点在于您可以指定与正则表达式匹配的多个列。如果我有五列X（A，B，C，D，E）：</span><br><span class="line">X&lt;-data.frame(A=c(<span class="number">1</span>,<span class="number">2</span>),B=c(<span class="number">3</span>,<span class="number">4</span>),C=c(<span class="number">5</span>,<span class="number">6</span>),D=c(<span class="number">7</span>,<span class="number">8</span>),E=c(<span class="number">9</span>,<span class="number">10</span>))</span><br><span class="line">X</span><br><span class="line">  A B C D  E</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span>  <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">10</span></span><br><span class="line">#取出B栏和D栏：</span><br><span class="line">X&lt;-X[,-grep(<span class="string">"B|D"</span>,colnames(X))]</span><br><span class="line">  A C  E</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">5</span>  <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">6</span> <span class="number">10</span></span><br><span class="line">#考虑到马修伦德伯格在下面的评论中的grepl建议：</span><br><span class="line">&gt; X&lt;-data.frame(A=c(<span class="number">1</span>,<span class="number">2</span>),B=c(<span class="number">3</span>,<span class="number">4</span>),C=c(<span class="number">5</span>,<span class="number">6</span>),D=c(<span class="number">7</span>,<span class="number">8</span>),E=c(<span class="number">9</span>,<span class="number">10</span>))</span><br><span class="line">&gt; X</span><br><span class="line">  A B C D  E</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span>  <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">10</span></span><br><span class="line">&gt; X&lt;-X[,!grepl(<span class="string">"B|D"</span>,colnames(X))]</span><br><span class="line">&gt; X</span><br><span class="line">  A C  E</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">5</span>  <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">6</span> <span class="number">10</span></span><br><span class="line">#如果我尝试删除一个不存在的列，则不会发生任何事情：</span><br><span class="line">&gt; X&lt;-X[,!grepl(<span class="string">"G"</span>,colnames(X))]</span><br><span class="line">&gt; X</span><br><span class="line">  A C  E</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">5</span>  <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">6</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p><a href="https://stackoverflow.com/questions/5234117/how-to-drop-columns-by-name-in-a-data-frame" target="_blank" rel="noopener">https://stackoverflow.com/questions/5234117/how-to-drop-columns-by-name-in-a-data-frame</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;项目需求&quot;&gt;&lt;a href=&quot;#项目需求&quot; class=&quot;headerlink&quot; title=&quot;项目需求&quot;&gt;&lt;/a&gt;项目需求&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;近期在处理单细胞项目数据，想对基因和read数构成的矩阵文件做进一步的处理，比如删除一些指定基因，删
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>bioRxiv-高通量单细胞染色质图谱研究人体免疫细胞发育和肿瘤内T细胞衰竭</title>
    <link href="http://liuyang0681.github.io/2019/04/26/bioRxiv-%E9%AB%98%E9%80%9A%E9%87%8F%E5%8D%95%E7%BB%86%E8%83%9E%E6%9F%93%E8%89%B2%E8%B4%A8%E5%9B%BE%E8%B0%B1%E7%A0%94%E7%A9%B6%E4%BA%BA%E4%BD%93%E5%85%8D%E7%96%AB%E7%BB%86%E8%83%9E%E5%8F%91%E8%82%B2%E5%92%8C%E8%82%BF%E7%98%A4%E5%86%85T%E7%BB%86%E8%83%9E%E8%A1%B0%E7%AB%AD/"/>
    <id>http://liuyang0681.github.io/2019/04/26/bioRxiv-高通量单细胞染色质图谱研究人体免疫细胞发育和肿瘤内T细胞衰竭/</id>
    <published>2019-04-26T14:19:07.000Z</published>
    <updated>2019-04-26T14:23:04.136Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题：Massively parallel single-<span class="built_in">cell</span> chromatin landscapes of human immune <span class="built_in">cell</span> development <span class="built_in">and</span> intratumoral <span class="built_in">T</span> <span class="built_in">cell</span> exhaustion</span><br><span class="line">期刊：biorxiv</span><br><span class="line">日期：April <span class="number">18</span>, <span class="number">2019</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;单细胞领域伴随着单细胞分离建库等技术的发展，不少优质实验室也产出了大量的高水平文章，对于新型的ATAC-seq技术（鉴定染色质可接近性的方法），目前也广泛应用在单细胞领域，对研究单细胞水平的调控抑制性具有重要的价值。之前的文章基于多重组合index的方式，pool-split 方法实现单细胞建库，10Xgenome公司基于droplet,液滴微流控的方法，将单细胞ATAC-seq实现了商业化，这篇预印版文章也是10XATAC-seq商业化以来联合业内大牛首篇文章，预期可以发表在CNS级别杂志上。<br>&emsp;&emsp;通讯作者为ATAC-seq发明人<strong>William J.Greenleaf</strong>和<strong>Howard Y .Chang</strong>以及10Xgenome公司的<strong>Grace X.Y.Zheng</strong><br><img src="https://upload-images.jianshu.io/upload_images/6732709-3fc76dbe5dfc74b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="作者情况"><br>&emsp;&emsp;文章利用10X公司微流控系统实现高通量单细胞ATAC-seq建库测序。微流控系统由标记特定barcode的磁柱，混有Tn5转座酶细胞核悬浮液，油滴通过微流控系统使每个细胞核，一个磁珠与油滴形成一个整体油胞体，实现单细胞分离建库，后续经过扩增破乳等过程完成上机测序前的步骤。10X同时提供端对端的数据分析流程，也提供建议操作的可视化操作软件，供没有生信背景的老师直观处理数据。文章又对数据做了多步质控，通过与群体ATAC-seq及merge多个单细胞数据信号图做比较，单细胞确实在相应的信号集中区域有read富集。这个图的做法我已经分享过<a href="https://liuyang0681.github.io/2019/04/12/paper0412/">生信类捕获信号peak图的美化进阶之路</a>。文章也做了在TSS区域富集的比例，相关性分析，通过利用GM2878和A20两种细胞做系统的双胞率评估。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-b3fe973f4724b285.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="技术路线质控"><br>&emsp;&emsp;文章基于William J.Greenleaf &amp;&amp; Howard Y .Chang实验室对骨髓造血细胞分化发育领域研究积淀，采用造血干细胞为研究对象，通过微流控建库测序通过质控，共获得<strong><em>61,806</em></strong>个高质量的单细胞数据。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-746dc2d757c1368d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="样本类型"><br>&emsp;&emsp;利用LSI方法将降维，SNN 聚类，UMAP可视化，共获得31个细胞群。基于三种方式分类，1）开放区域peak；2）基因活性值；3)转录因子情况。分别用这三种方式研究顺势调控原件与靶基因的关系。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-eee2d15310d77189.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="三种方法研究"><br>&emsp;&emsp;免疫细胞谱系调节轨迹研究。文章尝试利用ATAC-seq 数据去重构细胞发育谱系，利用B细胞作为例子测试，在聚类结果中显示了前体B细胞，记忆B细胞.接下来利用这种单细胞伪时间来识别阶段特异性活动 血浆B细胞分化过程中的顺式元件和反式因子。分析约10,000个在整个轨迹上具有动态可访问性模式的特定顺式调控元件及在B细胞发育的每个阶段的几个已知调节剂附近的动态调节元件。确定了16个子簇，并且将分类的scATAC-seq谱投影到从头定义的簇上，揭示了祖细胞之间的调节关系和标记定义的状态中的显着异质性。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-c6afc336b5b834ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="发育轨迹"><br>&emsp;&emsp;肿瘤内免疫单细胞染色质图谱。对来自5名患者的PD-1阻断前后的连续肿瘤活检组织（pembrolizumab）进行了scATAC-seq，另外还对2名患者进行了治疗后活组织检查（共7例患者; 14个时间点采样）。为了能够进行治疗前和治疗后的细胞比较, 对每个患者进行了活检, 并在可能的情况下, 在每个时间点以相同的方式对细胞进行采样，总共生成了<strong>37, 818</strong>个单细胞高质量的scATAC-seq 数据。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-430f1f251c603a27.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="BCC"><br>&emsp;&emsp;PD-1阻断后T细胞衰竭的表观遗传景象。文章专注于 CD8 + TEx 细胞, 之前的研究表明, 这一群体是丰富的克隆扩大肿瘤特异性 T 细胞。分析了 TEx 细胞中的顺式调节图谱： (1) 测量 TEx 细胞中染色质可及性的全局变化, (2) 提名可能调节 tex 特异性抑制受体表达的单个顺式元件。在所有 T 细胞状态中, 确定了 35, 147个只能在单个类群中开放的顺式元件。最后研究了 TEx 和 Tfh 细胞之间的表观遗传关系。文章结果绘制了人类体内 TEx 细胞的表观遗传景观图, 并表明慢性 TCR 信号在减少阻断后推动了 TEx 和 Tfh 细胞的共同调控机制。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-b1b764afde2e049b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="T细胞表观调节"></p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p><a href="https://www.biorxiv.org/content/10.1101/610550v1" target="_blank" rel="noopener">https://www.biorxiv.org/content/10.1101/610550v1</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight excel&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
    
  </entry>
  
  <entry>
    <title>seqkit-fa&amp;fq文件处理利器</title>
    <link href="http://liuyang0681.github.io/2019/04/25/seqkit-fa-fq%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E5%88%A9%E5%99%A8/"/>
    <id>http://liuyang0681.github.io/2019/04/25/seqkit-fa-fq文件处理利器/</id>
    <published>2019-04-25T07:55:23.000Z</published>
    <updated>2019-04-25T07:56:39.239Z</updated>
    
    <content type="html"><![CDATA[<p>作为生信入门训练，我们常用perl python等脚本语言实现对基因组文件的处理，练习常规的文本文件处理。最近再做单细胞方面的技术开发，需要自己手动合成一个嵌合两种物种的基因组，且要配套对应的gtf文件。用于评估单细胞技术的双胞率。<br>于是把seqkit这个由重庆第三军医大学Wei Shen 使用 go 语言开发用于处理 fa 和 fq 文件的利器拿出来温习一下，发现我的需求基本都可以满足。同等于处理bed文件的万能工具bedtools，感慨一套处理工具软件包可以取代一批生信工程师，这话确实如此。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-81e531050cc3dc60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="主要功能"></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br></pre></td><td class="code"><pre><span class="line">一、序列操作：</span><br><span class="line"></span><br><span class="line">1.取反向序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -r &gt; test_re.fa</span><br><span class="line"></span><br><span class="line">2.取互补序列</span><br><span class="line"></span><br><span class="line">seq <span class="keyword">test</span>.fa -p &gt; test_com.fa</span><br><span class="line"></span><br><span class="line">3.取反向互补序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -r -p &gt; test_re_com.fa</span><br><span class="line"></span><br><span class="line">4.DNA序列转换为RNA序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa --nda2rna &gt; test_rna.fa</span><br><span class="line"></span><br><span class="line">5.RNA序列转换为DNA序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa rna2dna &gt; test_dna.fa</span><br><span class="line"></span><br><span class="line">6.将序列以小写字母的形式输出</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -<span class="keyword">l</span> &gt; test_lower.fa</span><br><span class="line"></span><br><span class="line">7.将序列以大写字母的形式输出</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -<span class="keyword">u</span> &gt; test_upper.fa</span><br><span class="line"></span><br><span class="line">8.指定每行序列的输出长度(为0的话，代表为一整行，默认的输出 长度是60个碱基)</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -w 50 &gt; test_50.fa (指定序列的长度为50)</span><br><span class="line"></span><br><span class="line">9.将多行序列转换为一行序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -w 0 &gt; test_w.fa</span><br><span class="line"></span><br><span class="line">10.只输出序列</span><br><span class="line"></span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -s -w 0 &gt; test_seq.fa</span><br><span class="line"></span><br><span class="line">11.将只输出的序列的，指定每行输出的碱基数</span><br><span class="line"></span><br><span class="line">seqkit seq test_seq.fa -s -w 40 &gt; test_seq40.fa</span><br><span class="line"></span><br><span class="line">12输出参数-o</span><br><span class="line">seqkit seq <span class="keyword">test</span>.fa -s -w 20 -o test_20.fa</span><br><span class="line"></span><br><span class="line">二、Fasta/q之间以及与<span class="keyword">tab</span>格式互换</span><br><span class="line"></span><br><span class="line">1.将fataq文件转化为fasta格式.</span><br><span class="line"></span><br><span class="line">seqkit seq fq2fa <span class="keyword">test</span>.fq -o <span class="keyword">test</span>.fa</span><br><span class="line"></span><br><span class="line">2.将fasta格式转化为<span class="keyword">tab</span>格式</span><br><span class="line"></span><br><span class="line">seqkit fx2tab <span class="keyword">test</span>.fa &gt; test_tab.fa (没有seq参数)</span><br><span class="line"></span><br><span class="line">三、序列信息统计</span><br><span class="line"></span><br><span class="line">1.序列碱基含量</span><br><span class="line"></span><br><span class="line">seqkit fx2tab -<span class="keyword">l</span> -<span class="keyword">g</span> -<span class="keyword">n</span> -i -<span class="keyword">H</span> <span class="keyword">test</span>.fa (这些参数组合起来比较好看)</span><br><span class="line"></span><br><span class="line">2.序列长度的整体分布统计</span><br><span class="line"></span><br><span class="line">seqkit stat <span class="keyword">test</span>.fa</span><br><span class="line">seqkit grep [flags]    #这部分内容用的比较广泛</span><br><span class="line"></span><br><span class="line">参数：</span><br><span class="line"></span><br><span class="line">-<span class="keyword">n</span>, --<span class="keyword">by</span>-name</span><br><span class="line"></span><br><span class="line">匹配整个序列的名字，包含deion部分，而不是序列id。</span><br><span class="line"></span><br><span class="line">-s, --<span class="keyword">by</span>-seq</span><br><span class="line"></span><br><span class="line">匹配序列</span><br><span class="line"></span><br><span class="line">-<span class="keyword">d</span>, --degenerate</span><br><span class="line"></span><br><span class="line">pattern/motif 包含简并碱基</span><br><span class="line"></span><br><span class="line">-i, --ignore-case</span><br><span class="line"></span><br><span class="line">忽略大小写</span><br><span class="line"></span><br><span class="line">-v, --invert-<span class="built_in">match</span></span><br><span class="line"></span><br><span class="line">输出不匹配此模式的内容</span><br><span class="line"></span><br><span class="line">-p,</span><br><span class="line"></span><br><span class="line">匹配模式，支持连续写多个模式，匹配任一模式即输出。如-p ^ATG -p TAA$。注意该功能仅能正向匹配，不能实现对互补链匹配。</span><br><span class="line"></span><br><span class="line">-f, --pattern-<span class="keyword">file</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">支持匹配模式写到一个文件中，如要提取的序列ID。</span><br><span class="line"></span><br><span class="line">-R, --region <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">匹配位置选择。<span class="keyword">e</span>.<span class="keyword">g</span> 1:12 <span class="keyword">for</span> first 12 bases, -12:-1 <span class="keyword">for</span> last 12 bases</span><br><span class="line"></span><br><span class="line">-r, --<span class="keyword">use</span>-regexp</span><br><span class="line"></span><br><span class="line">使用正则表达式，必须加入此参数,如^匹配首端。同-p联合使用。</span><br><span class="line"></span><br><span class="line">举例：</span><br><span class="line"></span><br><span class="line">seqkit grep -s -r -i -p ^atg cds.fa＃选取有起始密码子的序列</span><br><span class="line"></span><br><span class="line">seqkit grep -f <span class="keyword">list</span> <span class="keyword">test</span>.fa &gt; new.fa＃根据ID提取序列</span><br><span class="line"></span><br><span class="line">seqkit grep -s -<span class="keyword">d</span> -i -p TTSAA＃简并碱基使用。S 代表C or <span class="keyword">G</span>.</span><br><span class="line"></span><br><span class="line">seqkit grep -s -R 1:30 -i -r -p GCTGG＃＃匹配限定到某区域</span><br><span class="line"></span><br><span class="line">五、motif定位</span><br><span class="line"></span><br><span class="line">对grep的拓展，可以正反链同时匹配，输出匹配的位置。</span><br><span class="line"></span><br><span class="line">seqkit locate [flags]</span><br><span class="line"></span><br><span class="line">参数：</span><br><span class="line"></span><br><span class="line">-<span class="keyword">d</span>, --degenerate</span><br><span class="line"></span><br><span class="line">pattern/motif contains degenerate base</span><br><span class="line"></span><br><span class="line">-i, --ignore-case</span><br><span class="line"></span><br><span class="line">ignore case</span><br><span class="line"></span><br><span class="line">-P, --only-positive-strand</span><br><span class="line"></span><br><span class="line">only <span class="keyword">search</span> at positive strand</span><br><span class="line"></span><br><span class="line">-p, --pattern value</span><br><span class="line"></span><br><span class="line"><span class="keyword">search</span> pattern/motif</span><br><span class="line"></span><br><span class="line">-f, --pattern-<span class="keyword">file</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">pattern/motif <span class="keyword">file</span> (FASTA <span class="keyword">format</span>)</span><br><span class="line"></span><br><span class="line">举例：</span><br><span class="line"></span><br><span class="line">seqkit locate -i -<span class="keyword">d</span> -p AUGGACUN <span class="keyword">test</span>.fa</span><br><span class="line"></span><br><span class="line">输出结果：</span><br><span class="line"></span><br><span class="line">seqID</span><br><span class="line"></span><br><span class="line">patternName</span><br><span class="line"></span><br><span class="line">pattern</span><br><span class="line"></span><br><span class="line">strand</span><br><span class="line"></span><br><span class="line">start</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">matched</span><br><span class="line"></span><br><span class="line">cel-mir-58a</span><br><span class="line"></span><br><span class="line">AUGGACUN</span><br><span class="line"></span><br><span class="line">AUGGACUN</span><br><span class="line"></span><br><span class="line">81</span><br><span class="line"></span><br><span class="line">88</span><br><span class="line"></span><br><span class="line">AUGGACUG</span><br><span class="line"></span><br><span class="line">ath-MIR163</span><br><span class="line"></span><br><span class="line">AUGGACUN</span><br><span class="line"></span><br><span class="line">AUGGACUN</span><br><span class="line"></span><br><span class="line">122</span><br><span class="line"></span><br><span class="line">129</span><br><span class="line"></span><br><span class="line">AUGGACUC</span><br><span class="line"></span><br><span class="line">六、多个序列文件比较寻找相同的序列或者ID相同的序列</span><br><span class="line"></span><br><span class="line">seqkit common [flags]</span><br><span class="line"></span><br><span class="line">参数:</span><br><span class="line"></span><br><span class="line">-<span class="keyword">n</span>, --<span class="keyword">by</span>-name</span><br><span class="line"></span><br><span class="line">匹配整个序列的名字，包含deion部分，而不是序列id</span><br><span class="line"></span><br><span class="line">-s, --<span class="keyword">by</span>-seq</span><br><span class="line"></span><br><span class="line">match <span class="keyword">by</span> sequence</span><br><span class="line"></span><br><span class="line">-i, --ignore-case</span><br><span class="line"></span><br><span class="line">ignore case</span><br><span class="line"></span><br><span class="line">-<span class="keyword">m</span>, --md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> MD5 reduce <span class="keyword">memory</span> usage</span><br><span class="line"></span><br><span class="line">举例:</span><br><span class="line"></span><br><span class="line">１、<span class="keyword">By</span> ID (default,&gt;后面，空格之前的名字)输出ID名字相同的。</span><br><span class="line"></span><br><span class="line">seqkit common test1.fa test2.fa -o common.fasta</span><br><span class="line"></span><br><span class="line">２、<span class="keyword">By</span> full name（整个序列的名字，包含deion部分）。输出序列名字相同的。</span><br><span class="line"></span><br><span class="line">seqkit common test1.fa test2.fa -<span class="keyword">n</span> -o common.fasta</span><br><span class="line"></span><br><span class="line">３、输出要比较的文件中序列相同的序列</span><br><span class="line"></span><br><span class="line">seqkit common test1.fa test2.fa -s -i -o common.fasta</span><br><span class="line"></span><br><span class="line">４、输出要比较的文件中序列相同的序列 (<span class="keyword">for</span> large sequences)</span><br><span class="line"></span><br><span class="line">seqkit common test1.fa test2.fa -s -i -o common.fasta --md5</span><br><span class="line"></span><br><span class="line">七、提取部分序列</span><br><span class="line"></span><br><span class="line">如随机抽取10000条FASTQ序列做NT污染评估。同时他也可以对FASTA序列提取</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">sample</span> [flags]</span><br><span class="line"></span><br><span class="line">参数:</span><br><span class="line"></span><br><span class="line">-<span class="keyword">n</span>, --number int</span><br><span class="line"></span><br><span class="line"><span class="keyword">sample</span> <span class="keyword">by</span> number (result may not exactly match)</span><br><span class="line"></span><br><span class="line">-p, --<span class="keyword">proportion</span> float</span><br><span class="line"></span><br><span class="line"><span class="keyword">sample</span> <span class="keyword">by</span> <span class="keyword">proportion</span>（按比例提）</span><br><span class="line"></span><br><span class="line">-s, --rand-seed int</span><br><span class="line"></span><br><span class="line">rand seed <span class="keyword">for</span> shuffle (default 11)</span><br><span class="line"></span><br><span class="line">-2, --<span class="keyword">two</span>-pass</span><br><span class="line"></span><br><span class="line">2-pass modelower <span class="keyword">memory</span></span><br><span class="line"></span><br><span class="line">举例：随机抽取序列</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">sample</span> -<span class="keyword">n</span> 10000 -s 11 test1_1.fq -o <span class="keyword">sample</span>.fq</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">sample</span> -p 0.1 -s 11 test1_1.fq -o <span class="keyword">sample</span>.fq</span><br><span class="line"></span><br><span class="line">八、排序输出命令</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">sort</span> [flags]</span><br><span class="line"></span><br><span class="line">参数：</span><br><span class="line"></span><br><span class="line">-<span class="keyword">l</span>, --<span class="keyword">by</span>-<span class="built_in">length</span></span><br><span class="line"></span><br><span class="line">按照序列长度排序</span><br><span class="line"></span><br><span class="line">-<span class="keyword">n</span>, --<span class="keyword">by</span>-name</span><br><span class="line"></span><br><span class="line"><span class="keyword">by</span> full name</span><br><span class="line"></span><br><span class="line">-s, --<span class="keyword">by</span>-seq</span><br><span class="line"></span><br><span class="line">按照序列排序</span><br><span class="line"></span><br><span class="line">-i, --ignore-case</span><br><span class="line"></span><br><span class="line">按序列排序时忽略大小写</span><br><span class="line"></span><br><span class="line">-r, --<span class="built_in">reverse</span></span><br><span class="line"></span><br><span class="line">反向排序</span><br><span class="line"></span><br><span class="line">-2, --<span class="keyword">two</span>-pass</span><br><span class="line"></span><br><span class="line">对于FASTA序列排序可以减少内存</span><br><span class="line"></span><br><span class="line">举例：</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">sort</span> -ltest.fa</span><br><span class="line"></span><br><span class="line">九、文件切割</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">split</span> [flags]</span><br><span class="line"></span><br><span class="line">参数：</span><br><span class="line"></span><br><span class="line">-i, --<span class="keyword">by</span>-id</span><br><span class="line"></span><br><span class="line"><span class="keyword">split</span> squences according to sequence ID</span><br><span class="line"></span><br><span class="line">-p, --<span class="keyword">by</span>-part int</span><br><span class="line"></span><br><span class="line">将一个文件分割成<span class="keyword">N</span> 份</span><br><span class="line"></span><br><span class="line">-s, --<span class="keyword">by</span>-size int</span><br><span class="line"></span><br><span class="line">将一个文件按照<span class="keyword">N</span> 条序列一个文件进行分割</span><br><span class="line"></span><br><span class="line">-O, --<span class="keyword">out</span>-<span class="keyword">dir</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">output directory (default value is <span class="keyword">infile</span>.<span class="keyword">split</span>)</span><br><span class="line"></span><br><span class="line">-2, --<span class="keyword">two</span>-pass</span><br><span class="line"></span><br><span class="line"><span class="keyword">two</span>-pass mode to lower <span class="keyword">memory</span> usage(only FAST)</span><br><span class="line"></span><br><span class="line">举例：</span><br><span class="line"></span><br><span class="line">seqkit <span class="keyword">split</span> hairpin.fa.gz -p 4</span><br></pre></td></tr></table></figure><h5 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h5><p>1.<a href="https://github.com/shenwei356/seqkit" target="_blank" rel="noopener">https://github.com/shenwei356/seqkit</a><br>2.<a href="https://www.cnblogs.com/huangyinger/p/10421805.html" target="_blank" rel="noopener">https://www.cnblogs.com/huangyinger/p/10421805.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;作为生信入门训练，我们常用perl python等脚本语言实现对基因组文件的处理，练习常规的文本文件处理。最近再做单细胞方面的技术开发，需要自己手动合成一个嵌合两种物种的基因组，且要配套对应的gtf文件。用于评估单细胞技术的双胞率。&lt;br&gt;于是把seqkit这个由重庆第三军
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>R语言生成word报告遇到的坑</title>
    <link href="http://liuyang0681.github.io/2019/04/19/R%E8%AF%AD%E8%A8%80%E7%94%9F%E6%88%90word%E6%8A%A5%E5%91%8A%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/"/>
    <id>http://liuyang0681.github.io/2019/04/19/R语言生成word报告遇到的坑/</id>
    <published>2019-04-19T14:10:31.000Z</published>
    <updated>2019-04-19T14:12:51.074Z</updated>
    
    <content type="html"><![CDATA[<h5 id="背景需求"><a href="#背景需求" class="headerlink" title="背景需求"></a>背景需求</h5><p>对于生信分析而言，对结果的展示如何做到更方便合理，更好的与合作者沟通交流项目结果。能够自动生成一些可视化报告，成了科研狗的刚需，R语言提供了多种解决方案，比较常见的是markdown格式，可以友好生成网页版报告，但是对于后续科研文章撰写还存在不友好的问题。比如将结果统计表写到word里，我之前的操作方案，是下载成xls复制到word上，再慢慢修改格式，比较耗时耗力，实际上R语言具备自动生成word的功能，本篇主要介绍如何配置R环境达到这样的目的。</p><h5 id="坑1"><a href="#坑1" class="headerlink" title="坑1"></a>坑1</h5><p>简单搜索发现R包<strong>ReporteRs</strong>可以实现.<br>于是着手安装install.packages(“ReporteRs”),可以目前已经下架了<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Warning in install.packages :</span><br><span class="line"><span class="keyword">package</span> ‘ReporteRs’ <span class="keyword">is</span> <span class="keyword">not</span> available (<span class="keyword">for</span> R <span class="keyword">version</span> <span class="number">3.5</span><span class="number">.1</span>)</span><br><span class="line"><span class="keyword">Error</span> <span class="keyword">in</span> <span class="keyword">library</span>(ReporteRs) : there <span class="keyword">is</span> <span class="keyword">no</span> <span class="keyword">package</span> called ‘ReporteRs’</span><br><span class="line"></span><br><span class="line"><span class="comment">#检索后</span></span><br><span class="line">You can <span class="keyword">not</span> solve that <span class="keyword">as</span> it has been removed <span class="keyword">from</span> CRAN </span><br><span class="line">(you can find details <span class="keyword">on</span> the github page https://github.com/davidgohel/ReporteRs).</span><br></pre></td></tr></table></figure></p><p>接着在 GitHub上安装</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">devtools::install_github(<span class="string">'davidgohel/ReporteRsjars'</span>)</span><br><span class="line">devtools::install_github(<span class="string">'davidgohel/ReporteRs'</span>)</span><br></pre></td></tr></table></figure><p>各种报错接踵而来，首先JAVA版本不对，需要6-8的版本，目前最新的Java版本不适用该包。<br>填坑开始安装8版本Java<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  [/Users] java -version</span><br><span class="line">java version <span class="string">"1.8.0_211"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_211-b12)</span><br><span class="line">Java HotSpot(TM) 64-Bit<span class="built_in"> Server </span>VM (build 25.211-b12, mixed mode)</span><br></pre></td></tr></table></figure></p><h5 id="坑2"><a href="#坑2" class="headerlink" title="坑2"></a>坑2</h5><p>填完这个发现并不管用，安装rJava后，载入失败。<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Error:</span> <span class="keyword">package</span> or namespace load failed <span class="keyword">for</span> ‘rJava’:</span><br><span class="line">loadNamespace()里算<span class="string">'rJava'</span>时.onLoad失败了，详细内容：</span><br><span class="line">调用: dyn.load(file, DLLpath = DLLpath, ...)</span><br><span class="line">错误: 无法载入共享目标对象‘<span class="regexp">/Library/</span>Frameworks<span class="regexp">/R.framework/</span>Versions<span class="regexp">/3.4/</span>Resources<span class="regexp">/library/</span>rJava<span class="regexp">/libs/</span>rJava.so’：:</span><br><span class="line">dlopen(<span class="regexp">/Library/</span>Frameworks<span class="regexp">/R.framework/</span>Versions<span class="regexp">/3.4/</span>Resources<span class="regexp">/library/</span>rJava<span class="regexp">/libs/</span>rJava.so, <span class="number">6</span>): Library not <span class="string">loaded:</span> <span class="regexp">/Library/</span>Java<span class="regexp">/JavaVirtualMachines/</span>jdk<span class="number">-9.</span>jdk<span class="regexp">/Contents/</span>Home<span class="regexp">/lib/</span>server/libjvm.dylib</span><br><span class="line">Referenced <span class="string">from:</span> <span class="regexp">/Library/</span>Frameworks<span class="regexp">/R.framework/</span>Versions<span class="regexp">/3.4/</span>Resources<span class="regexp">/library/</span>rJava<span class="regexp">/libs/</span>rJava.so</span><br><span class="line"><span class="string">Reason:</span> image not found</span><br><span class="line">错误: 无法载入程辑包‘rJava’</span><br></pre></td></tr></table></figure></p><p>查了一下发现这是因为检索不到对应的动态库，给出解决方案<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -f -s $(<span class="regexp">/usr/libexec</span><span class="regexp">/java_home)/lib</span><span class="regexp">/server/libjvm</span>.dylib /usr/local/<span class="class"><span class="keyword">lib</span></span></span><br></pre></td></tr></table></figure></p><p>这波操作完成，rJava包载入正常了。</p><h5 id="坑3"><a href="#坑3" class="headerlink" title="坑3"></a>坑3</h5><p>于是鼓起勇气继续安装<strong>ReporteRs</strong><br>发现还是不行，真是日了狗了，有点放弃的年头，查了不少材料，让我安装gcc啥的，问题我的电脑自带gcc啊。<br>后来还是找到官方给出的问题解答博客，发现我的电脑缺少<strong>cairo</strong>工具<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">brew install cairo</span><br><span class="line"><span class="meta">#终端安装完成后</span></span><br><span class="line"><span class="meta">#在R环境中输入</span></span><br><span class="line"><span class="symbol">devtools:</span>:install_github(<span class="string">"davidgohel/gdtools"</span>) </span><br><span class="line"><span class="symbol">devtools:</span>:install_github(<span class="string">"davidgohel/rvg"</span>)</span><br><span class="line"><span class="symbol">devtools:</span>:install_github(<span class="string">"davidgohel/ReporteRs"</span>)</span><br></pre></td></tr></table></figure></p><p>终于可以顺利安装了。<br>测试一下发现效果确实不错，生成的work格式比较实用，后续可以深入研究美化图表。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a3d239cbf75ddc76.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="生成图"></p><p>填坑之路漫漫兮，吾将上下而求索。</p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p><a href="https://blog.csdn.net/leolotus/article/details/50978223" target="_blank" rel="noopener">https://blog.csdn.net/leolotus/article/details/50978223</a><br><a href="https://github.com/davidgohel/ReporteRs" target="_blank" rel="noopener">https://github.com/davidgohel/ReporteRs</a><br><a href="https://d.cosx.org/d/420035-mac-rjava" target="_blank" rel="noopener">https://d.cosx.org/d/420035-mac-rjava</a><br><a href="https://davidgohel.github.io/ReporteRs/articles/faq.html" target="_blank" rel="noopener">https://davidgohel.github.io/ReporteRs/articles/faq.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;背景需求&quot;&gt;&lt;a href=&quot;#背景需求&quot; class=&quot;headerlink&quot; title=&quot;背景需求&quot;&gt;&lt;/a&gt;背景需求&lt;/h5&gt;&lt;p&gt;对于生信分析而言，对结果的展示如何做到更方便合理，更好的与合作者沟通交流项目结果。能够自动生成一些可视化报告，成了科研狗的刚
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>知识改变命运的桥梁-能力</title>
    <link href="http://liuyang0681.github.io/2019/04/16/%E7%9F%A5%E8%AF%86%E6%94%B9%E5%8F%98%E5%91%BD%E8%BF%90%E7%9A%84%E6%A1%A5%E6%A2%81-%E8%83%BD%E5%8A%9B/"/>
    <id>http://liuyang0681.github.io/2019/04/16/知识改变命运的桥梁-能力/</id>
    <published>2019-04-16T11:38:51.000Z</published>
    <updated>2019-04-16T11:40:42.110Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;这两天坐车听到邻座交流知识改变命运的正解应该是知识转化为能力，能力才能改变命运，碰巧今天在知乎上看到<strong>“什么能力很重要，但大多数人却没有？”</strong>这个问题，看到点赞最多的回答感觉写的很不错，作为心路历程的一篇牛肉汤文收录在此，值得多次阅读。<br>&emsp;&emsp;开门见山，不卖关子，直接给出七种能力，后边在细细阅读。</p><ul><li><strong>用肉体操纵精神的能力</strong>——肉体先行，精神后置，让行动带动思想，让思想自动适应；</li><li><strong>弹性化自我监控的能力</strong>——在做创造性的工作、进入新领域的时候，要先放飞自我，再来修正，不要边工作边修正；</li><li><strong>训练感官的能力</strong>——分解你的感受，你的分析能力，会发生永久性的提升；</li><li><strong>定位风险的能力</strong>——生活中有不少事情，风险/代价很小，但收益巨大，抓住了就赶紧投资！</li><li><strong>突然变开心的能力</strong>——找到开心的阀门，让自己在最难搞的日子，也能笑出声来；</li><li><strong>制造冲突的能力</strong>——容忍冲突，制造冲突，形成反差，成为令人欲罢不能的神秘人；</li><li><strong>故意失败的能力</strong>——榨干失败的价值，甚至故意用失败来测试。<h5 id="序曲"><a href="#序曲" class="headerlink" title="序曲"></a>序曲</h5><img src="https://upload-images.jianshu.io/upload_images/6732709-aa047874dd1a9b62.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul><p>现代生活就像一条河。<br>你需要很努力，才能抵抗河水自然向下的流势；需要用力挣扎，才能划开水面，往上游移动分毫。<br>此之谓人生之难，不进则退。<br>但是，划着划着，你却惊讶地发现，竟然有少数人没有在游泳，而是开着船往上游飞驰！<br>你不由得想：为什么船这个东西这么重要，但大多数人却都没有呢？<br>拖延、失败、焦虑、胆怯……都是这条河的暗流，都是你、是芸芸众生，都要花大力气，才能摆脱的势能。<br>你也需要船。<br>本文，则是助你造船的文章。</p><h5 id="用肉体操纵精神的能力"><a href="#用肉体操纵精神的能力" class="headerlink" title="用肉体操纵精神的能力"></a>用肉体操纵精神的能力</h5><p>大多数人做事的逻辑，无非是：我先弄好一个目标，然后想清楚我有什么资源，然后该按照什么计划来搞，再加上一点自我监督，按结果给自己一点奖励和惩罚。</p><p>比如读书，我们今年的目标是50本，那么我们可以列出一个书单，和一个计划表，把一个月、一周、一天的哪些时间分配给读书，接着，一本本攻克！</p><p>比如减肥，我们可以定下一个减肥的最小目标，10公斤，然后办一张健身卡，每天控制饮食，然后记录自己的体重变化，设定每周的最小运动次数等等……</p><p>最后的结果是啥呢？很简单——大多数人都没能坚持下来。</p><p>为什么呢？也很简单，因为这些办法，本质上都是<strong>“用精神操控肉体”</strong>，注定是要失败的。</p><p>你必须要学会，用肉体操控精神。</p><p>比如读书，不管你多不愿意，有什么借口，你都可以选择让你的身体先坐下来，拿出书，翻开，然后开始读，读了一两分钟你会惊奇地发现，你竟然自己慢慢就读下去了！</p><p>比如锻炼，刮风下雨、公司加班、肚子不舒服……一大堆奇怪的理由会“阻挡”你锻炼，怎么办呢？很简单，强制自己的身体去锻炼的地方，以一种无意识的状态站在器材上，然后开始练，然后，你也会惊奇地发现——卧槽，其实锻炼起来很easy的嘛！</p><p>究竟是咋回事儿呢？</p><p>这里面其实是一个生物学与心理学原理，就是人的身体和精神之间，往往存在很深入的“互相牵引”，而我们自己却很难意识到。</p><p>在我们潜在的观念里，我们总是认为“自己”是独立的、精神和肉体是二元的、肉体是惰性的需要精神来拉动……最后的结果当然是——根本带不动啊！</p><p>其实——精神是有着很强的“自我适应能力”的。</p><p>你把你的身体，放到一个场景中，你的精神怎么办呢？嘿嘿，它会自然而然地接受这个场景，并且顺势地“继续下去”，甚至还会将做这件事的“痛苦”化为“快乐”。</p><p>也有朋友说，你这个说法有问题啊！你“强制”自己坐到书桌前、“强制”自己到健身设备上，不也是先用“精神”操纵“肉体”嘛？</p><p>这话是有道理，如果真要解释，可能得绕到哲学上去。</p><p>但是你可以简单地这么来理解：做任何事，在最开始，必然都是以观念的形态存在于脑中——你可以把这个念头当成一个“火苗”，然后呢，你应该迅速把行动交给你的肉体，把它牵引过去，从而让这把火烧起来！</p><p>我们不妨想一想，为什么读书、减肥这样的好事做不起来？为什么我们有着各种拖延症？其实就是做事的观念刚刚作为“火苗”点燃的时候，就被精神的各种“假想”——“啊这个事儿好难啊”、“再等等吧我一会儿就去”、“做这个事儿真的一点乐趣都没有”——给浇灭了！</p><p>曾获得诺贝尔经济学奖的心理学家丹尼尔·卡尼曼在他的代表作——《不确定状况下的判断》里面就提到，人们对于未来的各种判断，往往存在着歪曲，比如，对于本来很简单的事儿，总是习惯于高估了其难度，低估了自己的忍耐度。</p><p>所以，别在精神上自己吓唬自己了，让肉体带动你吧！</p><h5 id="弹性化自我监控的能力"><a href="#弹性化自我监控的能力" class="headerlink" title="弹性化自我监控的能力"></a>弹性化自我监控的能力</h5><p>有个很有名的问题，叫做：为什么我知道很多道理，但仍然过不好这一生？</p><p>比如说，我有一个朋友，也是写文章的，他学了好几门写作课，知道了不少道理，但到写的时候，才发现出问题了——他写起来很慢很慢，总觉得哪里需要调整、修改，结果写得非常困难，以至于根本就写不下去了……</p><p>“邯郸学步”的故事大家都知道，那个想要学别人走路的燕国人，最后连自己怎么走路都忘了……</p><p>究竟是为什么呢？</p><p>其实，这里面的原因很简单，就是脑子里面太想运用新知识了，从而造成了很强的自我监控，总想着自己这一分一秒的工作，能不能达到“好工作”的标准、能不能恰当地运用新知识。</p><p>我管这个叫“知识的悖论”——知道的越多，做的越差。</p><p>推而广之，初入职场的人，脑子里面也有很多从书本里面学到的“知识”、“规则”、“套路”，但在真的用的时候，却总是束手束脚，最后的结果就是：明明特别不想出错，却偏偏要出一堆错误。</p><p>怎么办？</p><p>简单来说，你应该放开自己，把你知道的东西，当成“过滤器”，而不是做事的“引擎”。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-0a746468452ffaa6.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>比如说，写文章这件事，你完全可以凭着本性去写，一直写完，写的时候完全不要考虑什么“法则”、“套路”，直到写完之后，再把这些东西拿出来，作为“检验标准”，来分析你的文章达标了没有。</p><p>比如工作上要做什么东西，一个功能、一个图样，你都应该先放手做出一个Demo，然后再按照要求，一点一点改进、调整。</p><p>这种做事的方法的内核，本质上就是“弹性化自我监控”——在恰当的时机放飞自我，专注生产，而后再来检验。</p><p>如果你的工作是有创造性的，或者你想做出创造性的东西，再或者是你正在进入一个全新的领域开展工作，那你必须得相信自己，先干一票，回头再改。</p><p>其实吧，这世界上大部分的事情，都是“优化”出来的。</p><p>一边干一边自我审查，等于作茧自缚——这也是为什么“听了很多大道理，也过不好这一生”的原因。</p><h5 id="训练感官的能力"><a href="#训练感官的能力" class="headerlink" title="训练感官的能力"></a>训练感官的能力</h5><p>问你几个很奇怪的问题。</p><p>你有没有刻意训练过自己耳朵，让它能够听得更细、更清？</p><p>你有没有训练过自己的舌头，让它能分别出食物的用料、味道的层次？</p><p>你有没有训练过自己的眼睛，让它可以对画面、场景的颜色进行区分，对排列的结构进行拆分组合？</p><p>我想大部分人都没有。</p><p>你可能也觉得，这有啥用啊？好像一点用都没有哇！</p><p>当然不是。如果你长期坚持一下，训练下某种感官，你会发现，那些好像八杆子打不着的——专注力、分析力，竟然自动就提升了！</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-95e1044cb755e3bf.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>为什么呢？因为人的大脑，总是倾向于以一个“整体的意向”来感觉、评价事物，包括听、吃、看。</p><p>而因为事物是整体的，所以很多时候我们的思维方式就定在给它“下整体评论”上，比如“好-坏”、“高-低”、“善-恶”、“远-近”、“美-丑”……</p><p>长此以往，我们自然就很难抛开这些“整体观感”，而深入到事物的细节、构造里面去。</p><p>比如说，一道菜很好吃，一个“美味”就能概括吗？它究竟唤起了怎样的口感、怎样的味觉层次，是什么味道的组合才变得好吃的呢？</p><p>比如说，一个人很好看，究竟是怎么个好看法呢？是眼睛的形状，还是脸部的对称，或者是五官的距离与排列造成的呢？</p><p>比如说，一篇文章写得好，究竟是怎么个“好”呢？它的开头是怎么引出来的？它的论证是怎么推进的？它举了什么例子？它的切入点是什么？</p><p>还比如说，一个游戏好玩儿，究竟为什么好玩儿呢？它的哪些元素是核心的？哪些元素特别给人成就感与满足感？我在游戏里面听到了什么看到了什么？这些东西是怎么通过组合起来唤起我的各种舒服的感受的？</p><p>在还是猿猴的时代，感官最重要最基础的能力，当然是分辨“可以吃的”（好的东西），和“有危险的”（坏的东西），这是本性。</p><p><strong>但在互联网时代，我们又重新变成了“猿猴”，被“整体观感”推着走</strong>——特别是流水线式的、无尽的内容，让我们指头轻轻一划，在短短的一两秒之内，就决定是否要点开。</p><p>还有就是很多使人沉迷的游戏，明明就是一堆很简单的、使人成瘾的视听元素组合，但是，整体上却显得非常吸引人。</p><p>那么，问题来了，究竟如何训练自己的感官呢？</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-ee56e253fb902984.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>其实你只要做好一件事就可以了，那就是——分解。</p><p>亚里士多德曾经写过一篇文章，叫做《范畴篇》，从最基础的层面讨论事物该怎么分类。在文中，他提出了十大范畴，包括实体、数量、性质、关系、场所、时间、姿势、状态、动作、承受。</p><p>我们感官所感受的，也是具体的事物，这个事物自然也有自己的范畴。</p><p>最简单的，是大小、远近、状态、数量；稍微复杂点的，则是它呈现出来的模式；最复杂的，你可以站在生产者的视角，来思考这个东西是怎么做出来的。</p><p>简单的观察，可以直接依靠感官，也不用任何参考，就像此刻远处传来的声响，你静静聆听它的细节，并猜测是什么发出来，这就已经是“分解”的开始了。</p><p>复杂的分析，我觉得最好的办法是看几篇和这个事物相关的文章、听听相关人士对这个东西的分析。</p><p>人，其实是很奇妙的。</p><p>一旦你知道很多与事物相关的信息，比如狗狗的几种姿势背后的含义、佛跳墙的做法、一首歌曲的和弦-编织-套路、一款游戏的设计思路、一个普通人的心理惯性……你会发现，你再也不能像以前那样，整体地、无关地去看待它了。</p><p>你的观察，更有“深度”了。</p><h5 id="定位风险的能力"><a href="#定位风险的能力" class="headerlink" title="定位风险的能力"></a>定位风险的能力</h5><p>有些人，一旦错过就不再。</p><p>如果给你一台时光机，你想不想再次回到当初，对你暗恋的那个他/她，说出你的心里话，对他/她表白？</p><p>若你是一个非常理性的人，你的答案应该是：愿意。</p><p>为啥呢？因为从金融学最基本的原理——“风险-收益”模型来讲，对一个人表白，永远都是“稳赚不赔”——冒很小的风险，就能获得巨大收益的买卖啊！</p><p>你初听可能有点疑惑，但你仔细想想，表白这件事，可能成功也可能失败，如果成功了，变成情侣，对你——特别是少年时代的人，会带来极大的精神狂喜；如果失败了，又能损失什么呢？</p><p>你可能会说，一旦失败了就特别不好意思啦、见面也很尴尬啦之类的。</p><p>那请你仔细想一想，在你喜欢的人面前，暗恋状态的你，以前的表现就自然了？而一旦你的男神/女神跟别人在一块了，这种头上带绿的悔恨感，是不是天天都感觉是活在冰窖里面？</p><p>甚至就算真的失败了，你脸皮厚一点，人家也不会真的尴尬的，还可能会特别在意你、多观察你。一来二去，他/她自己很可能就默默说服自己，也喜欢上你了。</p><p>真的，这样的例子不少见，很多被追的人，最后因为追他/她的人“好像不太喜欢自己了”，竟然还会反追那个告白者……只能说，人啊人……</p><p>仔细想想，后悔不？你本来可以的得到的！</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a44a1050ffb38786.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>其实，生活中有很多事情，从理性的角度讲，都属于“风险/成本很小，但是收益很大”、“稳赚不赔”的买卖，但是因为咱们脑子里面有着各种不切实际的猜测，从而提前阻吓了自己的行动。</p><p>比如说，定期的身体检查，一年一次，大医院几百块钱，能省很多麻烦，但很多人就是不愿意，情愿旅游出行，或者买化妆品、请朋友吃饭，花大几千买即时的快乐；</p><p>比如说，每天花费很少的时间整理一下今天的工作心得、看到的资料，是很简单的，但是积少成多，一两年以后，你会惊讶地发现你对自己、自己的工作乃至于某个特定领域的理解，都比平常人要高出不少；</p><p>还比如说，向那些比你牛逼的人当面请教问题、尝试使用一些上手之初有点难的软件（比如印象笔记、书籍阅读软件Marginnote、脑图软件等等）、尝试学几道家常菜代替天天点外卖……</p><p>总之，就是在做决定的时候，稍微理性地想一下，做这件事的风险与收益，很多事情风险其实很小的，失败了损失也不大，但收益却是巨大的。</p><h5 id="突然变开心的能力"><a href="#突然变开心的能力" class="headerlink" title="突然变开心的能力"></a>突然变开心的能力</h5><p>大多数人的心态，往往是因为一件偶然发生的小事，就突然崩毁的。</p><p>然后像滚雪球一样，觉得这也不顺利，那也不如意，再然后呢则是失眠、喝酒、哭泣，觉得日子也太丧了。</p><p>而一旦丧起来，那完了，什么都提不起兴趣，啥也不想干了。</p><p>什么“好能力”、什么“读书”、“减肥”，都去特么的吧，我没心情！</p><p>但你有没有想过，如果心情可以“突然坏起来”，那能不能“突然好起来”呢？</p><p>当然能！</p><p>比如我们看看这只微笑的柴犬：</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-de9a5118a9f1d1ea.gif?imageMogr2/auto-orient/strip" alt></p><p>比如我看了之后笑了半天的一张动图：</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-8efe05123c99ca63.gif?imageMogr2/auto-orient/strip" alt></p><p>我不清楚你看了之后能不能突然开心一下。反正我心里面往上扬了一个弧度。</p><p>除此之外，还会让我突然开心起来的事儿，包括：刷一会儿煎蛋网的无聊图；逗一会儿小狗或者摸一会儿小猫；看一部喜剧片或者恐怖片；回顾自己以前写的某一篇感性的“好文章”（比如<a href="http://mp.weixin.qq.com/s?__biz=MzI1NDQ2MTk5NA==&amp;mid=2247483866&amp;idx=1&amp;sn=4036c4c60eedf848bdc29f3adb1ac6ca&amp;chksm=e9c5909fdeb21989b2fe202c15ffefc14d00c3b4d0ed407b6d17b38e45eab98e81feed4b2d32&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">嘿！抓住那条鱼撒！</a>，是的，自恋其实挺爽的……）；和喜欢的人聊会儿天……</p><p>当然，你、我、他，每个人是不一样的。</p><p>你需要做的是，回想一下能让你开心的、非常具体的事儿——一开始可能并没有那么容易，但是，你只要想，就一定可以找到让你可以开心一下的小事儿。</p><p>比较通用的，还是养点东西，花花草草、猫猫狗狗，都成；或者培养一个具体的爱好，烦心了就沉到这个爱好里面一会儿。</p><p>另外，还有研究表明，以下几件事，也会让人突然开心起来：</p><p>1.专注地洗碗，心无旁骛；（来源于心理学期刊《Mindfulness》，2014年）</p><p>2.整理房屋，让它变整洁；（来源于心理学期刊《Journal of Personality and Social Psychology》，2010年）</p><p>3.让所有人都听到你在唱歌；（德雷塞尔大学，2016年，心理学实验与研究）</p><p>你不妨一试~</p><p>人为什么非常需要“突然开心一下”？</p><p>不仅是心态建设的问题，更重要的是，很多研究已经表明，焦虑、伤心往往会“锁死”一个人的工作与创造，让人陷入——越焦虑、越干不好、然后更焦虑更干不好——的死循环里面。</p><p>让自己开心起来，很多事情都迎刃而解啦！</p><h5 id="制造冲突的能力"><a href="#制造冲突的能力" class="headerlink" title="制造冲突的能力"></a>制造冲突的能力</h5><p>在《语言学的邀请》这本书里面，作者介绍了一种非常有意思的描写事物、人的方法，叫做“两边偏倚法”，经典得让人拍案叫绝！</p><p>这个写法很简单，就是“在描写的时候同时向好坏两个方向偏倚，并力求做到双方平衡”。</p><p>举个书里面的例子，来看看怎么把一个人描述得鲜活：</p><blockquote><p>他的牙齿很白，但却不平；他的眼睛是蓝色的，他的头发是黄色的，很密。他很少直对着人看。他衬衫得袖子虽然已经磨破，但却很干净。他经常帮太太洗盘子，可也打破了不少。社会上对他的看法很不一致。他常去光顾的商店老板说他每次付账总要拖欠几天，不过他教区里的牧师却很称许他。</p></blockquote><p>你仔细看看这个人——这个身上充满了冲突的人，是不是觉得这个角色十分立体，很有吸引力，让你非常想要继续深入了解他？</p><p>这是什么？这，就是魅力！</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-4aec9a2fa3896bf8.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><strong>一个人身上互相冲突的地方越多，谜团就越多，像是一坛老酒，让你忍不住想要尝一尝</strong>。</p><p>简单的人活得绝对，善就是善，恶就是恶，好就是好，坏就是坏。一眼就被看透了，一点故事都没有。</p><p>真的，太没意思啦！</p><p>当然，人类的天性本来如此，从来就很难把两个互相冲突的观念，一起放在脑子里，因为实在是难受，一不小心就在脑子里打起来。</p><p>所以，有魅力的人，自然只是少数。</p><p>从今天开始，不妨尝试一下：允许互相冲突的特质同时存在，既圆滑世故，又天真无邪；既意志坚定，又满不在乎；既锋芒毕露，又人畜无害。</p><h5 id="故意失败的能力"><a href="#故意失败的能力" class="headerlink" title="故意失败的能力"></a>故意失败的能力</h5><p>学习、工作、生活，最怕失败。</p><p>一旦事情不顺，哪怕是大晴天，心里面也早就湿透了，阳光是别人的，你什么都没有。</p><p>失败次数多了，逐渐地，对自己也开始怀疑了——“我究竟适不适合干这个？”“为什么别人很简单就搞定，我做起来却这么难？”“那些人和我同龄，为什么成就却远远超过了我，是我太蠢了吗？”</p><p>于是，人生螺旋向下，越丧越颓，越颓越丧，毫无起色。</p><p>在这种情况下，怎么还会有人喜欢失败呢？甚至还要“故意失败”？</p><p>为了解释这个问题，我有必要给你重新阐释一下“爱迪生发明灯泡”地故事——这个故事，可不仅仅只是没用的鸡汤。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-ad1792b86087ed93.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>其内容想必你早就听腻了，它可能是小学生作文里出现频率最高的励志故事。故事里的爱迪生，为了研究出能用的灯丝，尝试了6000多种材料，做了7000多次的实验，最后才终于找到了能坚持45个小时的灯丝。</p><p>感动不？所以，不管你经历多少失败，都要含笑继续加油？</p><p>错了。</p><p>这个故事真正的要义在于：要学会科学地做事！</p><p>啥叫“科学地做事”？很简单，就是要利用每一次“失败”透露出来的信息，甚至说，榨干“失败”带给你的价值，以及，故意制造失败！</p><p>爱迪生曾用马毛、人发、胡子来制造灯丝，最后当然失败了，但是，在科学档案里面，这些失败都透露出了有用的信息——那就是这些路子都不行，作为研究者，我们是不是还可以根据这些失败做一个抽象的推论，那就是动物毛发可能都不行？</p><p>你看，表面上是失败了，但其实是成功地运用了排除法！</p><p>想想你的人生，有些选项是不是你自己也不知道能不能成？与其坐着观望，不如鼓起勇气尝试一下。假如说真的失败了，你也能从失败里面得到很多重要信息——甚至可以说，这些信息是如此宝贵，以至于你不失败几次，你永远就得不到！</p><p>其实，把失败当排除法，是一种很厉害的工程思想，我们整个现代化的工业，都是建立在这种思想上的。</p><p>这种思想的学名，叫做：控制论。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-6cde9672be53b2a5.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>控制论的具体应用，其实是有点复杂的，在数学上的解释，也要有一定基础了，才能看得懂。</p><p>但它的核心思想，却很简单，那就是：从失败中获取信息并利用其接近目标。</p><p>要怎么应用呢？</p><p>你可以想象你在玩儿一个射靶游戏，一开始你可能不太熟练，扔到墙上去了；然后，你调整力道，扔到了靶垫上；再然后，你根据上次的经验，再调整方向，又向靶子的中心靠近了一些；接着，你继续微调……周而复始，随着时间的推移，你越来越接近……终于，你射中了！</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-93d9a835036c285c.gif?imageMogr2/auto-orient/strip" alt></p><p>在你真正射中靶子之前，你的所有尝试，都在失败。但每一次失败，都给你下次投掷提供了修正信息，让你知道哪些投掷方法是错误的。</p><p>这在控制论领域，就叫做“反馈过程”。</p><p>这个过程虽然思想很简单，但是，对它的研究又建立了更高层面的“反馈过程”——不管改进控制理论、扩展应用范围，最后，以其为基础，构建起了各种牛逼的自动控制系统，以及整个现代自动化工业系统。</p><p>机器人先进不？如果要细究它最底层最底层的设计思想，其实就是“控制论”！</p><p>所以啊，如果失败仅仅只是失败，那失败真的毫无意义；但如果你能学会榨取失败的价值，甚至故意用失败来测试，那你的失败，也是成功！</p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p>引自知乎问题：<a href="https://www.zhihu.com/question/305507128" target="_blank" rel="noopener">https://www.zhihu.com/question/305507128</a><br>公号：罗文益（ID：wenyidehua）<br>侵删。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;这两天坐车听到邻座交流知识改变命运的正解应该是知识转化为能力，能力才能改变命运，碰巧今天在知乎上看到&lt;strong&gt;“什么能力很重要，但大多数人却没有？”&lt;/strong&gt;这个问题，看到点赞最多的回答感觉写的很不错，作为心路历程的一篇牛肉汤文收录在此
      
    
    </summary>
    
      <category term="心路历程" scheme="http://liuyang0681.github.io/categories/%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>二次启用Endnote工具应对文献增量管理</title>
    <link href="http://liuyang0681.github.io/2019/04/15/paper0415/"/>
    <id>http://liuyang0681.github.io/2019/04/15/paper0415/</id>
    <published>2019-04-15T14:28:14.000Z</published>
    <updated>2019-04-15T14:31:43.861Z</updated>
    
    <content type="html"><![CDATA[<h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>&emsp;&emsp;工欲善其事必先利其器，老祖宗留下的话大多数都是经典。之前看文献不多，手动整理文献已经满足条件。上次系统利用专门的文献管理软件endnote还是写本科毕业论文的时候，用来插入参考文献。其实endnote的更强大的功能是文献管理，插入文献只是其中的一小部分。随着阅读文献的越来越多，手动管理渐渐无法满足条件，重新捡起老工具利用新功能管理文献，并作常用的功能介绍。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5ba170d0314b39f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="endnote9"><br>&emsp;&emsp;我选用的是MAC版本的Endnote9，傻瓜式安装完成开始使用，构建自己的library库。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5356c999a584b6cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="endnote界面"></p><h5 id="数据库下载"><a href="#数据库下载" class="headerlink" title="数据库下载"></a>数据库下载</h5><p>&emsp;&emsp;在数据库中下载文献索引，并导入endnote。比如在NCBI中查找single cell ATAC-seq关键词，检索到多个相关文献。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-1efbb1d41dbded63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="NCBI检索界面"><br>&emsp;&emsp;点击界面中的Send to，在弹出的菜单中点击File，之后在Format菜单中点击MEDLINE，再点击Create File。这样PubMed就会自动下载一个文本文件到本地电脑，文件默认名字是pubmed_results.txt。这里需要注意的是，在Format中一定要选择Medline，千万不要选其它格式。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-4e1f17de2bc3fe25.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导出格式选择"><br>&emsp;&emsp;先点击File Import 后面那个options，选中刚才从PubMed中下载下来的txt文件。记住在Import Option中一定要选择PubMed (NLM)，有时这个地方默认的不是PubMed(NLM)，则需要在下拉菜单中找到Other Filters，之后再在众多的选项中找到PubMed(NLM)<br><img src="https://upload-images.jianshu.io/upload_images/6732709-88de65d02599e9a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导入选项配置"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-c3f54af604c7b4ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导入格式选择"><br>&emsp;&emsp;导入后全选所有信息，然后右键点击find full text，他就可以自动获取全文，比较耗时，可以吃个零食，喝杯咖啡，静候完成。当然对于非开放阅读期刊文章可能会获取不到，需要手动在scihub上获取然后手动添加到索引中。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-9b2bead5faf3e632.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="自动获取原文"><br>&emsp;&emsp;Encode另一个的优点是对中文文献的友好支持，在中国知网可以下载到endnote对应的格式信息，方便后续插入文献。</p><h5 id="PDF文献导入"><a href="#PDF文献导入" class="headerlink" title="PDF文献导入"></a>PDF文献导入</h5><p>&emsp;&emsp;也许你已经下载了很多的文献，这些可以直接导入到Endnote的，但是你或许会遇到一些文献导入不能自动识别引用信息，需要手动处理。<br>选中不能识别的文献，右键选择编辑参考材料。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-079ea41c1a9c9f35.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="输入网上查询到的DIO"><br>&emsp;&emsp;回到原来界面，然后更新参考材料即可.<br><img src="https://upload-images.jianshu.io/upload_images/6732709-7be3e2539df57081.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="更新界面"><br>&emsp;&emsp;还有一个比较实用的文献阅读管理技巧，可以根据个人情况标注文献的重要等级，以便后续重复阅读，方便查找。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-4d48b4fa1af32b14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="星标排序"></p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p><a href="http://blog.sciencenet.cn/blog-475824-877704.html" target="_blank" rel="noopener">http://blog.sciencenet.cn/blog-475824-877704.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h5&gt;&lt;p&gt;&amp;emsp;&amp;emsp;工欲善其事必先利其器，老祖宗留下的话大多数都是经典。之前看文献不多，手动整理文献已经满足条件。上次系统利用专门的文献
      
    
    </summary>
    
      <category term="他山之石" scheme="http://liuyang0681.github.io/categories/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/"/>
    
    
  </entry>
  
  <entry>
    <title>生信类捕获信号peak图的美化进阶之路</title>
    <link href="http://liuyang0681.github.io/2019/04/12/paper0412/"/>
    <id>http://liuyang0681.github.io/2019/04/12/paper0412/</id>
    <published>2019-04-12T12:49:57.000Z</published>
    <updated>2019-04-12T12:51:57.860Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;对于评估单细胞捕获率，通常需要结合群体细胞技术，在同一区域查看单细胞信号捕获情况，直接上图了解一下。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a7fe5c6892361db0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="准发表级图片"><br>&emsp;&emsp;对于这种图如何来做的呢？接下来将一步一步复现图片生成的过程。<br>&emsp;&emsp;首先需要选取合适的选区，比如在管家基因区域，或者你研究的这类细胞比较高开放或者高信号富集的区域。<br>&emsp;&emsp;选择好对应的区域，按照选择区域的宽度，设定合适的窗口大小对出图的视觉效果很重要，对于200kb的区域可以选择600-800bp窗口较适宜。<br>1、简单粗暴生成固定窗口的区域：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seq -w <span class="number">600000</span> <span class="number">600</span> <span class="number">800000</span> |awk '&#123;print <span class="string">"chr1"</span><span class="string">"<span class="subst">\t</span>"</span>$<span class="number">1</span><span class="string">"<span class="subst">\t</span>"</span>$<span class="number">1</span>+<span class="number">559</span><span class="string">"<span class="subst">\t</span>"</span><span class="string">"bin_"</span>NR<span class="string">"<span class="subst">\t</span>"</span><span class="string">"600"</span>&#125;' &gt; region_bin.bed</span><br></pre></td></tr></table></figure></p><p>2、利用bedrolls 工具可以对区域窗口检索多少reads覆盖在这个区域。<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bedtools intersect -a region_bin.bed -b read1sample.bed -c -bed |awk '&#123;print <span class="symbol">\$</span>4<span class="symbol">\"</span><span class="symbol">\\</span><span class="symbol">\t</span><span class="symbol">\"</span><span class="symbol">\$</span>5<span class="symbol">\"</span><span class="symbol">\\</span><span class="symbol">\t</span><span class="symbol">\"</span><span class="symbol">\$</span>6&#125;' &gt; read1sample_count.bed</span><br></pre></td></tr></table></figure></p><p>3、将每个cell对应的区域count情况合并成一个矩阵<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">paste</span> 工具或者perl 脚本可以轻松实现，针对相同列索引，多行合并</span><br></pre></td></tr></table></figure></p><p>4、利用Rpheatmap包可以轻松产生信号图，但默认情况图片较差，需要进一步的调整，下边为个性化R代码实现<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library(pheatmap)</span><br><span class="line"><span class="built_in">region</span>&lt;- <span class="built_in">read</span>.table(file = <span class="string">"count.xls"</span>,header = T)</span><br><span class="line"><span class="built_in">region</span>&lt;- <span class="built_in">region</span>[order(<span class="built_in">region</span>[,<span class="number">1</span>]),]</span><br><span class="line">rownames(<span class="built_in">region</span>)&lt;- <span class="built_in">region</span>[,<span class="number">1</span>]</span><br><span class="line"><span class="built_in">region</span>&lt;-<span class="built_in">region</span>[,-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">region</span>&lt;-<span class="built_in">region</span>[,-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">region</span>&lt;- t(<span class="built_in">region</span>)</span><br><span class="line"><span class="built_in">region</span>[<span class="built_in">region</span>&gt;<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line">bk &lt;-seq(<span class="number">0</span>,<span class="number">3</span>,by=<span class="number">1</span>)</span><br><span class="line">pheatmap(<span class="built_in">region</span>,cluster_cols = FALSE,cluster_rows = FALSE,</span><br><span class="line">         <span class="built_in">scale</span> = <span class="string">"none"</span>,</span><br><span class="line">         <span class="built_in">color</span> = colorRampPalette(colors = c(<span class="string">"white"</span>,<span class="string">"red"</span>))(<span class="built_in">length</span>(bk)),</span><br><span class="line">         legend_breaks=seq(<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>),</span><br><span class="line">         breaks=bk)</span><br></pre></td></tr></table></figure></p><p>运行完这个就可以生成此类草图，这是真实的reads在信号区域的富集情况。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-e8091700602e1ea5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="信号草图"></p><p>其次在IGV上调取个性化区域，并将该区域保存为svg格式，便于后序在AI上编辑合并。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-405d7f180c62af01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IGV截图"><br>AI编辑中：<br><img src="https://upload-images.jianshu.io/upload_images/6732709-2cb85d18f19c6fd7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AI 编辑中"><br>两部分初步合并：<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ca8f276ef127d305.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="初步合并"><br>逐步规范化：<br><img src="https://upload-images.jianshu.io/upload_images/6732709-63c46538a6669760.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="逐步规范化"><br>收尾完工：<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a15e6d11812d7206.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="逐步收尾完工"><br>AI对于后续的图片处理至关重要，图片规整美化是一个细致性的工作，没有最好，只有更好。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;对于评估单细胞捕获率，通常需要结合群体细胞技术，在同一区域查看单细胞信号捕获情况，直接上图了解一下。&lt;br&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/6732709-a7fe5c
      
    
    </summary>
    
      <category term="生信分析" scheme="http://liuyang0681.github.io/categories/%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/"/>
    
    
  </entry>
  
  <entry>
    <title>机器学习入门概述</title>
    <link href="http://liuyang0681.github.io/2019/04/09/paper0408/"/>
    <id>http://liuyang0681.github.io/2019/04/09/paper0408/</id>
    <published>2019-04-09T15:21:14.000Z</published>
    <updated>2019-04-09T15:23:45.358Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1、什么是机器学习"><a href="#1、什么是机器学习" class="headerlink" title="1、什么是机器学习"></a>1、什么是机器学习</h4><p>&emsp;&emsp;机器学习是人工智能的一个分支，它是一门研究机器获取新知识和新技能，并识别现有知识的学问。机器学习已广泛应用于数据挖掘、计算机视觉、自然语言处理、生物特征识别、搜索引擎、医学诊断、检测信用卡欺诈、证券市场分析、DNA 序列测序、语音和手写识别、战略游戏和机器人等领域。</p><h4 id="2、主要算法"><a href="#2、主要算法" class="headerlink" title="2、主要算法"></a>2、主要算法</h4><h6 id="按学习的方式来划分，机器学习主要包括："><a href="#按学习的方式来划分，机器学习主要包括：" class="headerlink" title="按学习的方式来划分，机器学习主要包括："></a>按学习的方式来划分，机器学习主要包括：</h6><ul><li><strong>监督学习</strong>：<br>输入数据带有标签。监督学习建立一个学习过程，将预测结果与 “训练数据”（即输入数据）的实际结果进行比较，不断的调整预测模型，直到模型的预测结果达到一个预期的准确率，比如分类和回归问题等。常用算法包括决策树、贝叶斯分类、最小二乘回归、逻辑回归、支持向量机、神经网络等。</li><li><strong>非监督学习</strong>：<br>输入数据没有标签，而是通过算法来推断数据的内在联系，比如聚类和关联规则学习等。常用算法包括独立成分分析、K-Means 和 Apriori 算法等。</li><li><strong>半监督学习</strong>：<br>输入数据部分标签，是监督学习的延伸，常用于分类和回归。常用算法包括图论推理算法、拉普拉斯支持向量机等。</li><li><strong>强化学习</strong>：<br>输入数据作为对模型的反馈，强调如何基于环境而行动，以取得最大化的预期利益。与监督式学习之间的区别在于，它并不需要出现正确的输入 / 输出对，也不需要精确校正次优化的行为。强化学习更加专注于在线规划，需要在探索（在未知的领域）和遵从（现有知识）之间找到平衡。<h6 id="按照功能来划分，机器学习主要包括："><a href="#按照功能来划分，机器学习主要包括：" class="headerlink" title="按照功能来划分，机器学习主要包括："></a>按照功能来划分，机器学习主要包括：</h6></li><li><strong>回归算法</strong>：<ul><li>线性回归</li><li>逻辑回归</li><li>多元自适应回归（MARS）</li><li>本地散点平滑估计（LOESS）</li></ul></li><li><strong>基于实例的学习算法</strong>：<ul><li>K - 邻近算法（kNN）</li><li>学习矢量化（LVQ）</li><li>自组织映射算法（SOM）</li><li>局部加权学习算法（LWL）</li></ul></li><li><strong>正则化算法</strong>：<ul><li>岭回归（Ridge Regression）</li><li>LASSO（Least Absolute Shrinkage and Selection Operator）</li><li>Elastic Net</li><li>最小角回归（LARS）</li></ul></li><li><strong>决策树算法</strong>：<ul><li>分类和回归树（CART）</li><li>ID3 算法 (Iterative Dichotomiser 3)</li><li>C4.5 和 C5.0</li><li>CHAID（Chi-squared Automatic Interaction Detection(）</li><li>随机森林（Random Forest）</li><li>多元自适应回归样条（MARS）</li><li>梯度推进机（Gradient Boosting Machine， GBM）</li></ul></li><li><strong>贝叶斯算法</strong>：<ul><li>朴素贝叶斯</li><li>高斯朴素贝叶斯</li><li>多项式朴素贝叶斯</li><li>AODE（Averaged One-Dependence Estimators）</li><li>贝叶斯网络（Bayesian Belief Network）</li></ul></li><li><strong>基于核的算法</strong>：<ul><li>支持向量机（SVM）</li><li>径向基函数（Radial Basis Function ，RBF)</li><li>线性判别分析（Linear Discriminate Analysis ，LDA)</li></ul></li><li><strong>聚类算法</strong>：<ul><li>K - 均值</li><li>K - 中位数</li><li>EM 算法</li><li>分层聚类</li></ul></li><li><strong>关联规则学习</strong>：<ul><li>Apriori 算法</li><li>Eclat 算法</li></ul></li><li><strong>神经网络</strong>：<ul><li>感知器</li><li>反向传播算法（BP）</li><li>Hopfield 网络</li><li>径向基函数网络（RBFN）</li></ul></li><li><strong>深度学习</strong>：<ul><li>深度玻尔兹曼机（DBM）</li><li>卷积神经网络（CNN）</li><li>递归神经网络（RNN、LSTM）</li><li>栈式自编码算法（Stacked Auto-Encoder）</li></ul></li><li><strong>降维算法</strong>：<ul><li>主成分分析法（PCA）</li><li>主成分回归（PCR）</li><li>偏最小二乘回归（PLSR）</li><li>萨蒙映射</li><li>多维尺度分析法（MDS）</li><li>投影寻踪法（PP）</li><li>线性判别分析法（LDA）</li><li>混合判别分析法（MDA）</li><li>二次判别分析法（QDA）</li><li>灵活判别分析法（Flexible Discriminant Analysis，FDA</li></ul></li><li><strong>集成算法</strong>：<ul><li>Boosting</li><li>Bagging</li><li>AdaBoost</li><li>堆叠泛化（混合）</li><li>GBM 算法</li><li>GBRT 算法</li><li>随机森林</li></ul></li><li><strong>其他算法</strong>：<ul><li>特征选择算法</li><li>性能评估算法</li><li>自然语言处理</li><li>计算机视觉</li><li>推荐系统</li><li>强化学习</li><li>迁移学习<h4 id="3、参考材料："><a href="#3、参考材料：" class="headerlink" title="3、参考材料："></a>3、参考材料：</h4><a href="https://feisky.xyz/machine-learning/" title="机器学习笔记" target="_blank" rel="noopener">机器学习笔记</a><br><a href="http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/" target="_blank" rel="noopener">http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;1、什么是机器学习&quot;&gt;&lt;a href=&quot;#1、什么是机器学习&quot; class=&quot;headerlink&quot; title=&quot;1、什么是机器学习&quot;&gt;&lt;/a&gt;1、什么是机器学习&lt;/h4&gt;&lt;p&gt;&amp;emsp;&amp;emsp;机器学习是人工智能的一个分支，它是一门研究机器获取新知识和新
      
    
    </summary>
    
      <category term="机器学习" scheme="http://liuyang0681.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>CR-单细胞转录组揭示乳腺癌治疗敏感性</title>
    <link href="http://liuyang0681.github.io/2019/04/09/paper0409/"/>
    <id>http://liuyang0681.github.io/2019/04/09/paper0409/</id>
    <published>2019-04-09T15:18:52.000Z</published>
    <updated>2019-04-09T15:20:51.926Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;筛选对EGFR抑制剂吉非替尼作用敏感的PDX个体，根据10x Genomics得到的单细胞转录组数据对细胞进行分群，细胞分为6个亚群，定位EGFR高表达的间叶细胞/干细胞分群，BRCA1突变的细胞系的间叶细胞/干细胞数值(M/S)较高。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-d7780249b71297c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文章作者"><br>&emsp;&emsp;论文的通讯作者Ioannis Ragoussis Ph.D担任基因组科学负责人。负责MUGQIC基因组加拿大基因组创新节点中的基因组平台开发和加拿大CFI资助的Genomics Enterprize。负责监督基因组平台操作和新技术评估与整合。实验室致力于技术开发，包括MUGQIC和突变检测技术的单细胞基因组学实验室，重点是单细胞的基因组和转录组学分析。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-da387419a709d124.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Ioannis Ragoussis Ph.D."><br><img src="https://upload-images.jianshu.io/upload_images/6732709-3ea2d34084945726.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PDX模型"></p><ul><li>a mesenchymal/stem (M/S) cluster ，表现为 EGFR 和mesenchymal相关基因高表达</li><li>the nuclear/mitochondrial cluster，表现为 nuclear 和 mitochondrial基因定位</li><li>a proliferative cluster，表现为细胞周期相关基因高表达</li><li>the antigen presentationcluster，表现为抗原呈递相关基因高表达。</li><li>the basal cluster ，包括 (<em>KRT6A/B</em>, <em>KRT17</em>, <em>KRT14</em>, and <em>KRT5</em>) 等markers</li><li>A transitional cluster ，差异基因太少<br><img src="https://upload-images.jianshu.io/upload_images/6732709-10b3be99adcdabaa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分六个亚群"><br>&emsp;&emsp;用t-SNE 进行聚类后，对于每个cluster寻找 marker 基因。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-e2acb7e117349552.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Monocle trajectory "></li></ul><h4 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h4><p><a href="https://zhuanlan.zhihu.com/p/44909322" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/44909322</a><br><a href="http://www.sohu.com/a/236810998_307557" target="_blank" rel="noopener">http://www.sohu.com/a/236810998_307557</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;筛选对EGFR抑制剂吉非替尼作用敏感的PDX个体，根据10x Genomics得到的单细胞转录组数据对细胞进行分群，细胞分为6个亚群，定位EGFR高表达的间叶细胞/干细胞分群，BRCA1突变的细胞系的间叶细胞/干细胞数值(M/S)较高。&lt;br&gt;&lt;im
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>NM-第一篇单细胞高通量测序文章</title>
    <link href="http://liuyang0681.github.io/2019/04/07/paper0407/"/>
    <id>http://liuyang0681.github.io/2019/04/07/paper0407/</id>
    <published>2019-04-07T13:05:23.000Z</published>
    <updated>2019-04-07T13:08:46.992Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;细胞异质性是生物组织的普遍特征。常规转录组测序(RNA-Seq)技术需要上万个细胞，所测结果实际上是一群细胞基因表达的平均值，所以难以鉴别细胞之间基因表达的异质性。单细胞RNA-Seq技术的分辨率精确至单个细胞，为辨别异质性群体中各种细胞类型的转录组特征提供了有力的工具。近年来单细胞RNA-Seq技术发展迅速，在方法学上包括cDNA扩增方法的多样化、对灵敏度和技术噪声的定量分析、浅覆盖高通量单细胞RNA-Seq方法和原位RNA-Seq技术等；在技术应用方面应用范围从早期胚胎发育扩大到组织器官发育、免疫和肿瘤等多个领域。<br>&emsp;&emsp;这篇文章是汤老师以第一作者于2009年发表在nature method上的第一篇单细胞转录组测序文章。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-b107c01640a6f366.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="首篇单细胞文章"><br>&emsp;&emsp;这篇论文的通讯作者为英国剑桥大学（University of Cambridge）的发育生物学家Azim Surani，也是当年汤老师博士后阶段的导师。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-652d2c7bf3cf8112.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="通讯作者"><br>&emsp;&emsp;汤老师2010年开始陆续担任北京大学教授，<a href="https://baike.baidu.com/item/%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%89%A9%E5%8A%A8%E6%80%81%E5%85%89%E5%AD%A6%E6%88%90%E5%83%8F%E4%B8%AD%E5%BF%83/6163142" target="_blank" rel="noopener">北京大学生物动态光学成像中心</a> (BIOPIC中心) 研究员、<a href="https://baike.baidu.com/item/%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6-%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%91%BD%E7%A7%91%E5%AD%A6%E8%81%94%E5%90%88%E4%B8%AD%E5%BF%83" target="_blank" rel="noopener">清华大学-北京大学生命科学联合中心</a>研究员、北京大学未来基因诊断高精尖创新中心研究员。<br>&emsp;&emsp;汤老师主要研究方向主要研究方向为人类早期胚胎发育过程中基因表达网络的表观遗传学调控。系统发展了单细胞功能基因组学研究体系，建立了单细胞RNA-Seq转录组高通量测序技术、单细胞DNA甲基化组高通量测序技术，并利用这一技术体系对人类早期胚胎进行了深入、系统的分析，发现了人类早期胚胎中基因表达网络的重要表观遗传学调控机理。在国际上首次对人类卵细胞进行了单细胞高通量基因组测序，阐明了人类卵细胞减数分裂的关键生物学特征，实现了利用单细胞高通量基因组测序技术进行植入前遗传学诊断、以大幅度提高试管婴儿成功率。在此基础上阐明了人类早期胚胎发育以及胚胎干细胞建系过程中的基因表达网络的动态变化，发现在早期胚胎以及胚胎干细胞建系过程中多能性细胞内可变剪接、细胞代谢等方面的模式转变。在国际上首次实现了对人类早期胚胎发育过程中DNA甲基化组的系统研究，揭示了人类早期胚胎DNA去甲基化过程的异质性以及其他关键特征，为人们提供了一个全面分析人类早期胚胎DNA甲基化调控网络的研究框架。在国际上首次发现小鼠早期胚胎中母源和父源基因组在单细胞的受精卵阶段均会发生大规模的DNA主动和被动去甲基化，并且DNA双加氧酶Tet3介导了主动去甲基化的发生，而糖苷酶TDG并不参与这一过程，暗示在Tet3介导的甲基化胞嘧啶氧化途径的下游存在着其它蛋白负责完成甲基化胞嘧啶氧化产物的清除，实现DNA的主动去甲基化。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5b29f321b4156902.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第一作者"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-a60747f99f0780dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验框架"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-de989603ece4d3ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="正负链相关性"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-f827413537042788.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="与芯片数据比较"><br><img src="https://upload-images.jianshu.io/upload_images/6732709-498e76059f0817e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="覆盖度图谱"></p><p>随着方法及工具的研发，特别是10X公司推出的转录组产品，可以快速对样本进行RNA建库测序，单细胞RNA-Seq技术已经得到广泛的应用。包括如下几个方面：(1)对各种组织器官的发育过程进行单细胞转录组分析，发现新的细胞类型和标记基因；(2)对神经和免疫系统进行全面分析，揭示其细胞异质性；(3)分析各种类型的肿瘤，揭示其细胞异质性；(4)与迅速发展的基因组编辑技术结合，对复杂的转录调控网络进行单细胞分辨率分析。单细胞RNA-Seq技术将逐渐应用到医学临床实践之中，对人类早期胚胎细胞和循环肿瘤细胞的开创性工作已经指向了这种可能性。</p><h4 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h4><p><a href="https://www.gurdon.cam.ac.uk/research/surani" target="_blank" rel="noopener">https://www.gurdon.cam.ac.uk/research/surani</a><br><a href="http://cls.pku.edu.cn:8080/index.php?m=content&amp;c=index&amp;a=show&amp;catid=81&amp;id=80" target="_blank" rel="noopener">http://cls.pku.edu.cn:8080/index.php?m=content&amp;c=index&amp;a=show&amp;catid=81&amp;id=80</a><br>文路–单细胞转录组高通量测序分析新进展<br><a href="https://www.plob.org/article/12022.html" target="_blank" rel="noopener">https://www.plob.org/article/12022.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;细胞异质性是生物组织的普遍特征。常规转录组测序(RNA-Seq)技术需要上万个细胞，所测结果实际上是一群细胞基因表达的平均值，所以难以鉴别细胞之间基因表达的异质性。单细胞RNA-Seq技术的分辨率精确至单个细胞，为辨别异质性群体中各种细胞类型的转录组
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>清明自驾一日游</title>
    <link href="http://liuyang0681.github.io/2019/04/05/paper0405/"/>
    <id>http://liuyang0681.github.io/2019/04/05/paper0405/</id>
    <published>2019-04-05T15:13:43.000Z</published>
    <updated>2019-04-16T11:42:05.600Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;来深圳近四年了，驾照领了也仅四年了这是过的第三个清明节，突发奇想要自驾去游玩一些有趣的地方,趁着年轻，其实就算一时的想法，也要去行动。华大基因公寓喜提一辆连陈共享满电状态扯，打客服无果，扯下充电头即飘摇上路。二办临时修整，购入早餐，第一站为人去的较少的官湖海滩。高德地图定位一下得到大梅沙隧道拥堵严重，遂走底路绕开拥堵路段，在大梅沙收费站上高速，记录一下这是第一次以司机身份进入高速公路驾驶汽车，很快使用高速形势，在高科技的加持下得知土洋收费站畅通无阻，于是下高速行驶在山间小路，多次与叉车相遇。经过一段顺畅路程之后，不到十点就顺利到达官湖社区，这个停车场系统做的不错，停车场与村里空白宅基地不分你我，游客可以有多种选择停车地点，我们跟着导航直接来到海滩，并顺利找到车位，然后简单吃了早饭，换上拖鞋，开启沙滩漫步之旅。海水很清澈，沙滩面积不大，往两边走发现右手边沿着海岸礁石上布置了一根极具年代感的输水管道。我后来想起来不拆的原因可能是方面游客进入礁石区。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-279f5425e3675f28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="官湖海滩年代感的工业区残留"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-94ca33a01db3acf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="河豚"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-7be5379670031a2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Y的树枝"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-f7c09c9c2995b8d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="狗生如此"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c6b748c7b53e368e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="堵的一笔"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-e4826d096269cc0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="城墙外"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-beb7da50bc27997a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图像识别为猫"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-36dc13eb62ab481a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="光阴的故事"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-eaccbbf18ede4bf7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="大鹏所城导览"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;来深圳近四年了，驾照领了也仅四年了这是过的第三个清明节，突发奇想要自驾去游玩一些有趣的地方,趁着年轻，其实就算一时的想法，也要去行动。华大基因公寓喜提一辆连陈共享满电状态扯，打客服无果，扯下充电头即飘摇上路。二办临时修整，购入早餐，第一站为人去的较少
      
    
    </summary>
    
      <category term="心路历程" scheme="http://liuyang0681.github.io/categories/%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>成长路上相伴的优秀博主(持续更新)</title>
    <link href="http://liuyang0681.github.io/2019/04/04/paper0404/"/>
    <id>http://liuyang0681.github.io/2019/04/04/paper0404/</id>
    <published>2019-04-04T15:18:22.000Z</published>
    <updated>2019-04-16T11:43:18.512Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1、综合类博客："><a href="#1、综合类博客：" class="headerlink" title="1、综合类博客："></a>1、综合类博客：</h4><p>专注生物信息，专注转化医学– <a href="https://qinqianshan.com/" title="Sam&#39;s note" target="_blank" rel="noopener">SAM’S NOTE</a><br>交大博士在读–<a href="http://zhanghonglun.cn/blog/category/tech/front/" target="_blank" rel="noopener">在路上</a><br>关注生信–<a href="http://shemy.site/" target="_blank" rel="noopener">沈梦圆的博客</a><br>关注生信–<a href="http://www.zilhua.com/" title="生物日志|鸣一道" target="_blank" rel="noopener">生物日志|鸣一道</a><br>科学网–<a href="http://blog.sciencenet.cn/home.php?mod=space&amp;uid=3334560" target="_blank" rel="noopener">刘永鑫的博客</a><br>科学网–<a href="http://blog.sciencenet.cn/home.php?mod=space&amp;uid=285393" target="_blank" rel="noopener">薛良交的博客</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;1、综合类博客：&quot;&gt;&lt;a href=&quot;#1、综合类博客：&quot; class=&quot;headerlink&quot; title=&quot;1、综合类博客：&quot;&gt;&lt;/a&gt;1、综合类博客：&lt;/h4&gt;&lt;p&gt;专注生物信息，专注转化医学– &lt;a href=&quot;https://qinqianshan.co
      
    
    </summary>
    
      <category term="他山之石" scheme="http://liuyang0681.github.io/categories/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/"/>
    
    
  </entry>
  
  <entry>
    <title>Cell-单细胞ATAC-seq绘制哺乳动物单细胞染色质调控图谱</title>
    <link href="http://liuyang0681.github.io/2019/04/03/paper0403/"/>
    <id>http://liuyang0681.github.io/2019/04/03/paper0403/</id>
    <published>2019-04-03T15:44:47.000Z</published>
    <updated>2019-04-03T15:46:23.187Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;DNA就像缠绕在一起的绳索，包装好的DNA被称为染色质，其内部组织影响基因在每个细胞中如何发挥作用。核小体是由DNA与组蛋白形成的染色质基本结构单位，实际上通过移动开启或关闭可阅读的遗传信息，核小体随时处于动态变化，这种状态被称为“染色质的可及性”。上篇文献中简要描述过<a href="https://www.jianshu.com/p/0ef5c9ca7e3d" target="_blank" rel="noopener"><strong>Greenleaf</strong></a>实验室开发的ATAC-seq技术可以快速高效的绘制染色质开放性图谱。<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题：A Single-Cell Atlas of In Vivo Mammalian Chromatin Accessibility</span><br><span class="line">期刊：Cell</span><br><span class="line">时间：<span class="number">2018</span>/<span class="number">08</span>/<span class="number">02</span></span><br></pre></td></tr></table></figure></p><p>&emsp;&emsp;这篇文章展示了如何通过单细胞的染色质调控信息来研究转录调控。从13只雄性小鼠的骨髓、大肠、心脏、肾脏、肝脏、肺、小肠、脾脏、睾丸、胸腺、全脑、小脑和前额叶皮层等多组织中采集了十万个单细胞，sciATAC-seq技术，检测出了85种特异性染色质的可及性状态，并且其中大部分都能与特定细胞类型相匹。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-018fbe8dd28391c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图表概要"></p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-c803775d9aeb8b2c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="作者及单位"><br>&emsp;&emsp;这项开创性的工作由华盛顿大学的Jay Shendure教授（文章通讯作者）等合作团队完成，这个实验室主要开发和应用遗传学，基因组学和分子生物学的新技术和方法，研究发育生物学，功能基因组学，人类疾病的遗传基础等方向，发表了大量CNS等高水平文章。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-252dccf93a4fa321.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="团队部分成员"><br>&emsp;&emsp;目前高通量的单细胞ATAC-seq技术主要分两种，一是在96孔板中通过split-pool-split的方法标记单细胞，可以适用于大部分实验室但是数据质量还有待提高，另一种是通过实验仪器形成单个液体来包裹单细胞进行标记, 依赖仪器但是数据质量相对较好。总的来说，单细胞数据信号噪音较高，分析需要大量统计学手段，这篇文章的一个亮点就是探索了很多新的数据分析方法，来试图解析单细胞中转录调控的问题。这篇文章用到的是第一种混合编码方式sciATAC-seq，由Jay Shendure组2015年开发，分析上也提出了对单细胞ATAC-seq数据的质控标准。利用LSI聚类，对每个cluster检测特异peak，构建单细胞信号矩阵。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-599e704d3c0fe54b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验设计框架"><br>&emsp;&emsp;tSNE能够通过染色质信息将大部分不同组织来源的细胞区分开来。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-b636d4de83390e91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="细胞聚类"><br>&emsp;&emsp;分析单细胞ATAC-seq数据的一个难点是怎么确定细胞的种类，文章结合浙江大学郭国骥教授发表的小鼠单细胞RNA-seq数据，尝试了基因种类分析，基因相关性打分和转移标签等几种不同的分析方法来探索这个问题。并发现这些方法都各有优劣。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ab28e4ccf70bceab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="KNN label"><br>&emsp;&emsp;细胞类型特异的染色质开放区域信号与 Complex Sequence Grammar具有相关。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ed5367cec0bb8e8a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="细胞类型特异motif"><br>&emsp;&emsp;最后文章基于小鼠单细胞数据分析的结果推断部分人类遗传性疾病相关，受限于物种差异，以小鼠开放染色质的数据直接分析部分人类遗传性疾病可能带有一定局限性。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-357fdc94ad3f481c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="结合人类遗传疾病"><br>&emsp;&emsp;最后附上 <strong>颉伟</strong>（清华大学生命科学学院研究员，清华-北大生命科学联合中心PI，HHMI国际学者，国家“杰青”）专家在微信公众号“BioArt”上的精彩点评：</p><p>&emsp;&emsp;每个人体有几十万亿的细胞，而每个细胞在功能、形态等方面都是不同的。如何研究和阐明每个细胞的功能是生物学的基本核心问题之一。单细胞RNA-seq的迅速发展大大增加了我们对已有细胞的认识以及未知新的细胞类型的发现（国内像汤富酬、郭国骥等实验室在这方面做出了杰出的贡献）。然而RNA-seq信息中通常会缺失的一个重要信息是基因组调控序列。包括增强子、启动子、绝缘子等调控序列是促成组织和发育时空特异性基因表达的重要调节因子。基于染色质的一系列表观遗传调控方法的进步为研究这些问题提供了很多新的工具。其中ATAC-seq是近年来比较常用的一个检测染色质开放性的方法，这种技术是斯坦福大学的William Greenleaf和Howard Chang实验室于2013年开发的。通常调控序列的染色质会处于比较开放的状态，很适合比较广谱的研究顺式调控序列和基因表达调控。<br>&emsp;&emsp;华盛顿大学的Jay Shendure实验室前期开发了大量的单细胞研究工具，包括single cell ATAC-seq。在这个工作就是他们通过single cell ATAC-seq来研究小鼠多种组织单细胞水平的染色质状态和基因调控的研究做出的一个尝试。 在技术上，作者采用index组合的方法，进一步提高单细胞 ATAC-seq的通量。通过该方法，作者描绘了13个小鼠组织中大约100,000个单细胞的开放染色质图谱，并且成功区分了诸多组织中的大部分细胞类群，也为相关组织的研究提供了很好的参考和借鉴。另外，作者通过单细胞 ATAC-seq的数据，鉴定了许多组织特异性的转录因子。最后，基于人与鼠的开放染色质的保守性，作者揭示了部分人类遗传病与开放染色质间的潜在关系，拓展了该研究的意义。<br>&emsp;&emsp;一个有趣的问题是能否将大量不同组织的单细胞RNA-seq和单细胞ATAC-seq整合起来进行比较研究。由于这些数据是不同的单细胞实验获得的，而每个细胞的identity在实验中都是推测出来的，而并非完全明确的，因此在技术上整合两种数据具有很大的挑战性。作者采用了一种label-transfer的方法，整合RNA-seq和ATAC-seq数据对细胞进行聚类，并将每个single cell ATAC-seq中的细胞周围的single cell RNA-seq细胞的最常见的label赋予该细胞。值得一提的是在分析中用到的single cell RNA-seq数据之一就是郭国骥实验室今年在Cell 发表的小鼠组织single cell RNA-seq的数据。这种label-transfer的分析方法具有探索性，从结果来看有合理性的部分，同时也有明显的问题，比如还缺乏其他独立实验结果的验证等。<br>&emsp;&emsp;总之，在该项研究中，作者通过 sci-ATAC-seq以及相应分析和质控方法，获得了较好的多组织单细胞层面的开放染色质信息，为组织结构，发育和分化，各组织器官的调控网络的研究提供了丰富的参考。然而，目前相关技术仍然有一些缺陷，比如相比single cell RNA-seq，single cell ATAC-seq每个细胞的coverage比较低。另外，每种或每类细胞的identity如何验证？是否有方法能够有效的在单细胞水平同时检测转录组和染色质动态调控。最后，受限于物种差异，以小鼠开放染色质的数据直接分析部分人类遗传性疾病可能带有一定局限性。相信这项研究是探索基因如何在单细胞水平实现时空表达特异性调控这一激动人心的核心生物学问题的刚刚开始。</p><h4 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h4><p><a href="https://shendure-web.gs.washington.edu/current.html" target="_blank" rel="noopener">https://shendure-web.gs.washington.edu/current.html</a><br>Cusanovich, D. a et al. Epigenetics. Multiplex single-cell profiling of chromatin accessibility by combinatorial cellular indexing. Science 348, 910–4 (2015).<br>Buenrostro, J. D. et al. Single-cell chromatin accessibility reveals principles of regulatory variation. Nature 523, 486–490 (2015).</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;DNA就像缠绕在一起的绳索，包装好的DNA被称为染色质，其内部组织影响基因在每个细胞中如何发挥作用。核小体是由DNA与组蛋白形成的染色质基本结构单位，实际上通过移动开启或关闭可阅读的遗传信息，核小体随时处于动态变化，这种状态被称为“染色质的可及性”。
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>Cell-单细胞多组学分析造血分化过程中的转录调控机制</title>
    <link href="http://liuyang0681.github.io/2019/04/02/paper0402/"/>
    <id>http://liuyang0681.github.io/2019/04/02/paper0402/</id>
    <published>2019-04-02T15:32:39.000Z</published>
    <updated>2019-04-02T15:37:26.063Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;造血分化是从造血干细胞分化为具有不同功能的细胞过程，在成人中主要发生在骨髓，最终产生淋巴系细胞,髓系-粒系，红系等细胞类型，是研究干细胞分化、肿瘤免疫、血液疾病等的良好模型。造血分化过程是一个复杂、多阶段的，受多种因子调控的过程，单细胞多组学分析有助于解析造血干细胞转录和细胞命运异质性的顺式和反式调节机制。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-6a80db3695c2e37f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文章作者信息"><br>&emsp;&emsp;论文的通讯作者为斯坦福大学William J. Greenleaf 教授，他的课题组在2013年Nature Methods上发表第一篇ATAC-seq技术性文章(Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position)，这个技术具有操作简单，成本低，时效性快等特征，很快被科学界所接受，有关染色质开放程度及表观调控相关的研究逐渐流行起来。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-06aae5b4b21f3512.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="GreenLeaf PHD"><br>&emsp;&emsp;论文设计从健康人捐赠的骨髓中分选单个细胞进行scATAC-seq，经过细胞捕获，转座酶结合，PCR扩增和测序，得到造血系统10个细胞类型的染色质开放图谱，进行了常规的单细胞处理分析流程，获得了2034个高质量细胞数据，每个细胞fragments中位数为8268，比对到peaks的比率为76%。值得一提的是之前常规的motif分析流程，一般首先获取差异peak，然后用homer等软件预测motif，再结合TF 数据库，处理转录因子footprint等分析；这里使用的greenleaf 实验室自己开发的ChromVAR工具，这是专门用于分析chromatin accessibility 的一个具有多种功能的R包，其中之一就是鉴定不同细胞的TF motif。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-519f1826915ea0aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验设计"><br>&emsp;&emsp;然后用多种方法对鉴定出得TF motif聚类，TF Z scores 聚类和TF Z score 与t-SNE结合聚类的方法都存在缺点：前者不容易鉴定chromatin accessibility 与其他生物变量间的关系，如细胞周期，细胞间的信号依赖；后者对细胞间距离难以解释；因此文章中又采用了新的算法-reference guided approach，即基于bulk sample 的chromatin accessibility 和相关的调控元件。首先对bulk ATAC-seq sample进行主成分（PC）分析，然后对PC在单个细胞中比例进行打分，最后根据PCs标准化后的分值与其他细胞的相关系数进行聚类。这个方法对后续研究具有重要参考意义。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-6713a8ab18d518a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="聚类分析"><br>&emsp;&emsp;不知道细胞表面分子标记物，利用k-medoids clustering对PC分析中的前5种主要成分聚类。研究分析鉴定出14个亚群，其中CMPs细分为4个亚群，GMPs分为2个亚群，表明这类细胞存在一定的异质性。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-c096528cbfb7a1e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分子描述"><br>&emsp;&emsp;具体研究各谱系细胞分化连续轨迹，细胞层面揭示了血细胞分化过程。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-3b2c9999e0a6defe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分化轨迹"><br>&emsp;&emsp;对HSC,CMP,GMP进行单细胞RNA测序，同时使用他人关于monocyte scRNA-seq数据，基于 reference-guided 方法 配对 scATAC-seq 和 scRNAseq profiles 。根据这种方法，他们将髓系分化基因的动态表达映射到染色质的动态变化，并且发现了已知的髓系分化调节因子的预期表达模式。还将TF的表达与TF motif对比。这种方法对于多组学整合分析也提供了思路，既具有借鉴意义。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-a495a4146db5e43e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TF"><br>&emsp;&emsp;共发现了14,005个顺式调控元件，这些调控元件随着染色质开放状态的变化也呈现显著的异质性，研究远端调控元件（增强子）与基因表达的相关性，结合染色质构想捕获技术HiC证实形式环可以促进调控元件与基因的结合。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-72925afcae166aac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="基因表达与调控"></p><p>&emsp;&emsp;DNA的物理可接近是染色质高度动态过程，在建立和维持细胞特征方面发挥着重要作用。基因组可接近染色质的组织形式反映了可能的物理性相互作用网络。在这个网络中，增强子、启动子、绝缘体和染色质结合因子共同作用，调节基因表达。这种可及性情况会随着外部刺激和发育的变化而动态变化。新的证据表明，可及性的稳态维持本身是通过染色质结合因子和核小体之间的竞争相互作用来动态调节的。<br>&emsp;&emsp;和RNA-seq类似，通过对单分子和单细胞可及性的检测表明，对细胞群体的可及性检测代表不同分子状态的整体平均值。当观察一个潜在的、动态的、不同步的过程时，这种分子异质性自然会出现。例如，在转录位点，RNA聚合酶及其他TF一起，置换TSS上游的核小体，并移动启动子下游位置良好但不稳定的核小体。对单分子NOMe-seq数据的足迹分析揭示了这一过程，随着转录过程的展开，捕捉每个分子状态。尽管会受采样效率的影响，但是单细胞可及性检测与对整个基因组调节区域的预测得到相似的分子异质性结果。</p><h4 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h4><p><a href="http://greenleaf.stanford.edu/index.html" target="_blank" rel="noopener">http://greenleaf.stanford.edu/index.html</a><br><a href="http://geneskybiotech.com/sup/research/1344.html" target="_blank" rel="noopener">http://geneskybiotech.com/sup/research/1344.html</a><br><a href="https://www.jianshu.com/p/ae4fe0a4b208" target="_blank" rel="noopener">https://www.jianshu.com/p/ae4fe0a4b208</a><br><a href="http://www.biodiscover.com/news/research/733290.html" target="_blank" rel="noopener">http://www.biodiscover.com/news/research/733290.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;造血分化是从造血干细胞分化为具有不同功能的细胞过程，在成人中主要发生在骨髓，最终产生淋巴系细胞,髓系-粒系，红系等细胞类型，是研究干细胞分化、肿瘤免疫、血液疾病等的良好模型。造血分化过程是一个复杂、多阶段的，受多种因子调控的过程，单细胞多组学分析有助
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>NN-单细胞开放染色质定位技术运用鼠脑发育研究</title>
    <link href="http://liuyang0681.github.io/2019/04/01/paper0401/"/>
    <id>http://liuyang0681.github.io/2019/04/01/paper0401/</id>
    <published>2019-04-01T14:05:55.000Z</published>
    <updated>2019-04-01T14:19:04.123Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;ATAC-seq是近年来比较常用的一个检测染色质开放性的方法，增强子、启动子、绝缘子等调控序列是促成组织和发育时空特异性基因表达的重要调节因子，通常调控序列的染色质又会处于比较开放的状态，ATAC这种方法很适合比较广谱的研究顺式调控序列和基因表达调控。单细胞开放染色质定位技术（scATAC）运用小鼠脑部来研究神经系统发育中的转录调控问题，18年初发表在神经领域著名期刊Nature neuroscience。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-7683b99741846e47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nature neuroscience 文章"></p><p>&emsp;&emsp;论文通讯作者为任兵教授，加州大学圣地亚哥分校Ludwig癌症研究所基因调控实验室主任，实验室采用综合方法，结合基因组学和计算工具，研究正常和疾病状态下人体细胞的转录调控网络。主要从事哺乳动物细胞基因调控网络分析及细胞表观遗传学调控机制的研究。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-28d5e5fa3a3a168b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Bing Ren"><br>&emsp;&emsp;文章采用鼠脑胚胎时期6个时间点，以及出生时p0及成年后p56共八个时间点，利用组合编码方式实现单细胞核ATAC-seq建库，共获得15000个细胞核鉴定去20个分区细胞型。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ca217d062249765a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验框架"><br>&emsp;&emsp;分析上首先通过比对等常规分析，构建开放区域的矩阵文件，转换成二进制格式，通过数据降维，聚类，过虑cluster，特征选择，鉴定出每个cluster特定的peak，后续进行motif分析。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-4eca13518f6d3aa9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分析框架"><br>&emsp;&emsp;选取成年后P56时间点，鉴定细胞类型，绘制脑区细胞图谱。配合群体ATAC-seq数据，对每种细胞类型确定潜在的收腰调节因子。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-453f76cb143141ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="细胞聚类"><br>&emsp;&emsp;对出生前的每个阶段单核ATAC-seq数据分析，揭示了在前脑发育过程中神经形成及胶质形成的时间节点，前脑中的顺式调节元件和谱系特定的转录调节因子。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-91a48f0eee4403c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="阶段聚类"><br>&emsp;&emsp;文章提供了单细胞ATAC-seq常规的分析流程，对于细胞聚类，提取特征，鉴定出每个细胞群特定的开放区域，也开发了一些算法供其他研究者参考。</p><h6 id="参考材料："><a href="#参考材料：" class="headerlink" title="参考材料："></a>参考材料：</h6><p><a href="http://210.45.32.7/xiweb/ptfy/shownews.asp?id=566" target="_blank" rel="noopener">http://210.45.32.7/xiweb/ptfy/shownews.asp?id=566</a><br><a href="https://www.ludwigcancerresearch.org/location/san-diego-branch/bing-ren-lab" target="_blank" rel="noopener">https://www.ludwigcancerresearch.org/location/san-diego-branch/bing-ren-lab</a><br><a href="https://www.nature.com/articles/s41593-018-0079-3" target="_blank" rel="noopener">https://www.nature.com/articles/s41593-018-0079-3</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;ATAC-seq是近年来比较常用的一个检测染色质开放性的方法，增强子、启动子、绝缘子等调控序列是促成组织和发育时空特异性基因表达的重要调节因子，通常调控序列的染色质又会处于比较开放的状态，ATAC这种方法很适合比较广谱的研究顺式调控序列和基因表达调控
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>Cell-单细胞转录组研究果蝇脑细胞</title>
    <link href="http://liuyang0681.github.io/2019/03/31/paper0331-1/"/>
    <id>http://liuyang0681.github.io/2019/03/31/paper0331-1/</id>
    <published>2019-03-31T15:50:11.000Z</published>
    <updated>2019-03-31T15:51:51.149Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;测序领域新技术开发基本会首先应用于人或者小鼠等常规模式生物中，然后逐渐推广到其他生物。单细胞技术同样是这样，随着技术的成熟，现在越来越广泛的应用到果蝇，蝾螈以及一些植物等。这篇文章为18年发表在cell杂志上的研究果蝇大脑衰老过程中单细胞转录组图谱。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-2bd274c863e21380.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="果蝇单细胞转录组文章"></p><p>&emsp;&emsp;论文的通讯作者为比利时鲁汶大学弗兰德斯生物技术研究所Stein Aerts教授，主要研究方向是解码基因组调控元件，并了解基因组调控程序如何在正常和疾病过程中推动细胞状态的动态变化。在湿实验方面应用高通量技术来破译增强子逻辑和映射基因调控网络，例如RNA-seq用于转录组学和ATAC-seq以及ChIP-seq用于表观基因组分析。为了绘制可能的细胞状态的高分辨率景观，单细胞转录组学和单细胞表观基因组学。在干实验方面使用生物信息学机器学习方法进行调控网络推理和增强子的计算建模。开发提供的一些生物信息学方法包括TOUCAN，ENDEAVOR，iRegulon，i-cisTarget，mu-cisTarget和SCENIC。在新技术研发方面开发了微流体芯片，包括用于单细胞分析的液滴微流体，开发了微流体装置，以分析3D肿瘤（片上器官）和单细胞迁移，并结合无透镜成像，实验室团队综合实力很强。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-1706a8145be19a23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="通讯作者和第一作者"></p><p>&emsp;&emsp;果蝇大脑中大约有10万个不同种类的细胞，虽然它比人脑规模小得多，但不同类型神经元和细胞组成的复杂网络跟人脑很像,果蝇大脑具有不同的负责睡眠、记忆、嗅觉等功能的细胞。这些研究人员对80多种不同的细胞类型簇进行了分门别类，并且有趣的是，他们也发现并非所有脑细胞都以相同的方式衰老。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-7447223f4be24005.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="果蝇脑单细胞聚类"><br>&emsp;&emsp;对于初步分出来的细胞群，然后进一步细分出亚群，并对亚群细胞注释，发现新的稀有细胞亚型。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-f752c021f9e1bc49.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="稀有细胞类型"><br>&emsp;&emsp;利用SCENIC研究映射特定的细胞类型对应特定的调解网络。50个在SCENIC t-SNE中形成单独的细胞簇，表明这些细胞类型具有最特异的TF网络。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-75d9444bc4dc4997.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SCENIC聚类"></p><p>&emsp;&emsp;SCENIC以氧化磷酸化为指导揭示神经轴。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-607efc8edfbbe9eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="神经轴"></p><p>&emsp;&emsp;Scope基于云的单细胞地图集探索，这是一种基于HDF5的数据文件，其中包含具有t-SNE坐标但可包含的数据集的原始或标准化基因表达矩阵来自不同分析和工具的额外注释和特征。SCope提供了一个平台，可以轻松快速地探索大规模单细胞数据集，而无需研究人员获取和分析原始数据。此外，利用标准化文件格式，可以使用SCope轻松调查新数据集和分析，以及提供的容器使组和机构可以使用自己的服务器或云计算解决方案轻松部署此平台。</p><p><img src="https://upload-images.jianshu.io/upload_images/6732709-b22e1daf4627e693.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scope"></p><p>######参考材料：<br><a href="https://aertslab.org/#team" target="_blank" rel="noopener">https://aertslab.org/#team</a><br>Davie K, Janssens J, Koldere D, et al. A Single-Cell Transcriptome Atlas of the Aging Drosophila Brain. Cell. 2018;174(4):982-998.e20</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;测序领域新技术开发基本会首先应用于人或者小鼠等常规模式生物中，然后逐渐推广到其他生物。单细胞技术同样是这样，随着技术的成熟，现在越来越广泛的应用到果蝇，蝾螈以及一些植物等。这篇文章为18年发表在cell杂志上的研究果蝇大脑衰老过程中单细胞转录组图谱。
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>NBT-单细胞多组学研究成人脑部细胞</title>
    <link href="http://liuyang0681.github.io/2019/03/31/paper0331/"/>
    <id>http://liuyang0681.github.io/2019/03/31/paper0331/</id>
    <published>2019-03-31T10:24:10.000Z</published>
    <updated>2019-03-31T10:28:00.613Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;自2009年汤教授发表单细胞RNA定量测序，至今近10年间单细胞技术得到飞速发展，已发表多种组学的单细胞技术，让科研人员更具体了解每个单细胞的状态，特别对于肿瘤的发生发展，胚胎发育，复杂组织等领域研究更深入。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-7143c42a30e4773c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="NBT paper"></p><p>&emsp;&emsp;这篇文章是2017年底发表在国际顶级期刊NBT上，论文的通讯作者为加州大学圣地亚哥分校Jacobs工程学院生物工程学系华裔教授张鹍（音译）,主要开发一些单分子测序及单细胞扩增微量建库等新技术，并以此研究干细胞，人脑等器官。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-733c4387b30cf94c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kun Zhang,Ph.D"><br>&emsp;&emsp;文章采用两种改进的技术snDrop-seq，scTHS-seq分别对脑细胞转录组及表观组水平进行测序分析，获得来自人类成人视觉皮层，额叶皮层和小脑的&gt; 60,000个单细胞的核转录组和DNA可及性图谱。这些数据的整合揭示了不同类型细胞的调节元件和转录因子，为研究大脑中的复杂过程提供了基础，例如协调成人髓鞘再生的遗传程序。还将疾病相关风险变异与特定细胞群体相关联，从而为人脑中的正常和致病细胞过程提供了见解。这种整合的单细胞多组学方法对研究复杂器官和组织提供了新的视角。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-4dc450625de375de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="两种技术框架"><br>&emsp;&emsp;snDrop-seq基于液滴微流控技术，利用磁珠，有机油物在微流管道中结合单个细胞形成一个一个液滴，实现单细胞RNA-seq的建库，实现高通量测序。scTHS-seq技术是利用多重编码方式（pool-split）方式实现单细胞高通量测序，目前这两种方法在单细胞高通量领域用的较多。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-5475e8d9d5864a6a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="转录表观水平聚类"><br>&emsp;&emsp;单细胞数据处理一般经过质控，比对，统计定量每个单细胞基因表达水平，定量开放区水平，即产生高维度稀疏矩阵，经过降维聚类算法，对整体细胞分群，基于已知的marker基因可以定义每个类群的细胞类型。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-531ea3cad51ac95c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="marker gene"><br>&emsp;&emsp;基因基因表达数据对单细胞进行聚类分析，然后利用机器学习算法模型gradient-boosting model（GBM）整合两个组学数据，模型算法将在后续简书文章中介绍。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-ed33016265b4336a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="基因表达数据和染色质开放性整合"><br>&emsp;&emsp;然后论文又对特定细胞类型转录因子（TF）活性研究以解析髓鞘再生过程。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-cb41d77e6da0588a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="转录因子研究"><br>&emsp;&emsp;最后文章又搜集以报道的脑部疾病的GWAS数据信息，选择可信度最强的50个SNP与开放区信息进行关联分析，将其定位到特定的细胞类型中。<br><img src="https://upload-images.jianshu.io/upload_images/6732709-964c68fb1d468d51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="结合GWAS数据分析"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;自2009年汤教授发表单细胞RNA定量测序，至今近10年间单细胞技术得到飞速发展，已发表多种组学的单细胞技术，让科研人员更具体了解每个单细胞的状态，特别对于肿瘤的发生发展，胚胎发育，复杂组织等领域研究更深入。&lt;br&gt;&lt;img src=&quot;https:/
      
    
    </summary>
    
      <category term="文献追踪" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/"/>
    
      <category term="paper" scheme="http://liuyang0681.github.io/categories/%E6%96%87%E7%8C%AE%E8%BF%BD%E8%B8%AA/paper/"/>
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://liuyang0681.github.io/2019/03/31/hello-world/"/>
    <id>http://liuyang0681.github.io/2019/03/31/hello-world/</id>
    <published>2019-03-30T17:59:05.597Z</published>
    <updated>2019-03-30T17:59:05.597Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
